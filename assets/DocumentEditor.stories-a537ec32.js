var gi=Object.defineProperty;var an=(ae,C,de)=>C in ae?gi(ae,C,{enumerable:!0,configurable:!0,writable:!0,value:de}):ae[C]=de;var d=(ae,C)=>gi(ae,"name",{value:C,configurable:!0});var Ue=(ae,C,de)=>(an(ae,typeof C!="symbol"?C+"":C,de),de),Tt=(ae,C,de)=>{if(!C.has(ae))throw TypeError("Cannot "+de)};var u=(ae,C,de)=>(Tt(ae,C,"read from private field"),de?de.call(ae):C.get(ae)),Z=(ae,C,de)=>{if(C.has(ae))throw TypeError("Cannot add the same private member more than once");C instanceof WeakSet?C.add(ae):C.set(ae,de)},ve=(ae,C,de,x)=>(Tt(ae,C,"write to private field"),x?x.call(ae,de):C.set(ae,de),de),ht=(ae,C,de,x)=>({set _(B){ve(ae,C,B,de)},get _(){return u(ae,C,x)}}),ee=(ae,C,de)=>(Tt(ae,C,"access private method"),de);import{d as defineComponent,a as createElementBlock,b as createBaseVNode,n as normalizeClass,F as Fragment,r as renderList,o as openBlock,w as withModifiers,t as toDisplayString,e as createTextVNode,m as markRaw,f as toRaw,g as createBlock,i as createCommentVNode,j as resolveComponent}from"./vue.esm-bundler-398966a3.js";import{u as useI18n}from"./i18n-c4b3ca93.js";import{d as doRequest,_ as _export_sfc,c as client}from"./plugin-vueexport-helper-dbf55845.js";import{x as commonjsRequire,y as require$$5}from"./iframe-2faac45c.js";const _hoisted_1$4={class:"btn-group dropup annotation-dropdown"},_hoisted_2$4=createBaseVNode("button",{type:"button",class:"btn btn-default dropdown-toggle","data-toggle":"dropdown"},[createBaseVNode("span",{class:"caret"})],-1),_hoisted_3$4={class:"dropdown-menu"},_hoisted_4$4=["onClick"],_sfc_main$4=defineComponent({__name:"ToolbarAnnotation",props:{isActivated:{type:Boolean},color:null,classPrefix:null,icon:null,colors:null},emits:["onChange"],setup(ae){return(C,de)=>(openBlock(),createElementBlock("div",_hoisted_1$4,[createBaseVNode("button",{class:normalizeClass(["btn",ae.isActivated?"btn-primary":"btn-default"]),type:"button",onClick:de[0]||(de[0]=x=>C.$emit("onChange",ae.isActivated?"":ae.color||Object.values(ae.colors)[0]))},[createBaseVNode("span",{class:normalizeClass(["fas",ae.icon])},null,2)],2),_hoisted_2$4,createBaseVNode("ul",_hoisted_3$4,[(openBlock(!0),createElementBlock(Fragment,null,renderList(ae.colors,(x,B)=>(openBlock(),createElementBlock("li",{key:B,class:normalizeClass(`${ae.classPrefix}-${B}`)},[createBaseVNode("a",{href:"#",class:normalizeClass(`${ae.classPrefix}-${B}`),onClick:withModifiers(ue=>C.$emit("onChange",x),["prevent"])},toDisplayString(C.$t(`editor.colors.${B}`)),11,_hoisted_4$4)],2))),128))])]))}}),ToolbarAnnotation_vue_vue_type_style_index_0_lang="";_sfc_main$4.__docgenInfo={exportName:"default",displayName:"ToolbarAnnotation",description:"",tags:{},props:[{name:"isActivated",required:!0,type:{name:"boolean"}},{name:"color",required:!0,type:{name:"string"}},{name:"classPrefix",required:!0,type:{name:"string"}},{name:"icon",required:!0,type:{name:"string"}},{name:"colors",required:!0,type:{name:"Record",elements:[{name:"string"},{name:"string"}]}}],events:[{name:"onChange",type:{names:["string"]}}],sourceFiles:["/home/runner/work/osis-document/osis-document/frontend/components/ToolbarAnnotation.vue"]};const _hoisted_1$3={class:"btn-group"},_hoisted_2$3=createBaseVNode("span",{class:"fas fa-magnifying-glass-plus"},null,-1),_hoisted_3$3=[_hoisted_2$3],_hoisted_4$3={class:"btn-group dropup",role:"group"},_hoisted_5$3={type:"button",class:"btn btn-default dropdown-toggle","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},_hoisted_6$2=createBaseVNode("span",{class:"caret"},null,-1),_hoisted_7$1={class:"dropdown-menu"},_hoisted_8=["value"],_hoisted_9=["onClick"],_hoisted_10=createBaseVNode("span",{class:"fas fa-magnifying-glass-minus"},null,-1),_hoisted_11=[_hoisted_10],_sfc_main$3=defineComponent({__name:"ToolbarZoom",props:{currentZoom:null},emits:["onZoomIn","onZoomOut","onSetScale"],setup(ae){const{t:C}=useI18n(),de=["auto","page-actual","page-fit","page-width","0.5","0.75","1","1.25","1.5","2","3","4"];function x(B){return isNaN(parseFloat(B))?C(`editor.zoom.${B}`):`${Math.ceil(parseFloat(B)*100)}%`}return d(x,"zoomTitle"),(B,ue)=>(openBlock(),createElementBlock("div",_hoisted_1$3,[createBaseVNode("button",{class:"btn btn-default",type:"button",onClick:ue[0]||(ue[0]=G=>B.$emit("onZoomIn"))},_hoisted_3$3),createBaseVNode("div",_hoisted_4$3,[createBaseVNode("button",_hoisted_5$3,[createTextVNode(toDisplayString(x(ae.currentZoom))+" ",1),_hoisted_6$2]),createBaseVNode("ul",_hoisted_7$1,[(openBlock(),createElementBlock(Fragment,null,renderList(de,G=>createBaseVNode("li",{key:G,value:G,class:normalizeClass(ae.currentZoom==G?"active":"")},[createBaseVNode("a",{href:"#",onClick:withModifiers(L=>B.$emit("onSetScale",G),["prevent"])},toDisplayString(x(G)),9,_hoisted_9)],10,_hoisted_8)),64))])]),createBaseVNode("button",{class:"btn btn-default",type:"button",onClick:ue[1]||(ue[1]=G=>B.$emit("onZoomOut"))},_hoisted_11)]))}});_sfc_main$3.__docgenInfo={exportName:"default",displayName:"ToolbarZoom",description:"",tags:{},props:[{name:"currentZoom",required:!0,type:{name:"string"}}],events:[{name:"onZoomIn"},{name:"onSetScale",type:{names:["string"]}},{name:"onZoomOut"}],sourceFiles:["/home/runner/work/osis-document/osis-document/frontend/components/ToolbarZoom.vue"]};const _hoisted_1$2={class:"btn-group"},_hoisted_2$2=createBaseVNode("span",{class:"fas fa-rotate-left"},null,-1),_hoisted_3$2=[_hoisted_2$2],_hoisted_4$2=createBaseVNode("span",{class:"fas fa-rotate-right"},null,-1),_hoisted_5$2=[_hoisted_4$2],_sfc_main$2=defineComponent({__name:"ToolbarRotation",props:{currentRotation:null},emits:["onRotate"],setup(ae){return(C,de)=>(openBlock(),createElementBlock("div",_hoisted_1$2,[createBaseVNode("button",{type:"button",class:"btn btn-default",onClick:de[0]||(de[0]=x=>C.$emit("onRotate",(ae.currentRotation-90)%360))},_hoisted_3$2),createBaseVNode("button",{type:"button",class:"btn btn-default",onClick:de[1]||(de[1]=x=>C.$emit("onRotate",(ae.currentRotation+90)%360))},_hoisted_5$2)]))}});_sfc_main$2.__docgenInfo={exportName:"default",displayName:"ToolbarRotation",description:"",tags:{},props:[{name:"currentRotation",required:!0,type:{name:"number"}}],events:[{name:"onRotate",type:{names:["number"]}}],sourceFiles:["/home/runner/work/osis-document/osis-document/frontend/components/ToolbarRotation.vue"]};const _hoisted_1$1={class:"btn-group"},_hoisted_2$1=createBaseVNode("span",{class:"fas fa-angle-up"},null,-1),_hoisted_3$1=[_hoisted_2$1],_hoisted_4$1={class:"btn btn-default disabled",role:"button"},_hoisted_5$1=createBaseVNode("span",{class:"fas fa-angle-down"},null,-1),_hoisted_6$1=[_hoisted_5$1],_sfc_main$1=defineComponent({__name:"ToolbarPagination",props:{currentPage:null,pages:null},emits:["onChangeCurrentPage"],setup(ae){return(C,de)=>(openBlock(),createElementBlock("div",_hoisted_1$1,[createBaseVNode("button",{class:normalizeClass(["btn btn-default",{disabled:ae.currentPage==1}]),type:"button",onClick:de[0]||(de[0]=x=>ae.currentPage!=1&&C.$emit("onChangeCurrentPage",ae.currentPage-1))},_hoisted_3$1,2),createBaseVNode("a",_hoisted_4$1,toDisplayString(C.$t("editor.pagination",{currentPage:ae.currentPage,pages:ae.pages})),1),createBaseVNode("button",{class:normalizeClass(["btn btn-default",{disabled:ae.currentPage==ae.pages}]),type:"button",onClick:de[1]||(de[1]=x=>ae.currentPage!=ae.pages&&C.$emit("onChangeCurrentPage",ae.currentPage+1))},_hoisted_6$1,2)]))}});_sfc_main$1.__docgenInfo={exportName:"default",displayName:"ToolbarPagination",description:"",tags:{},props:[{name:"currentPage",required:!0,type:{name:"number"}},{name:"pages",required:!0,type:{name:"number"}}],events:[{name:"onChangeCurrentPage",type:{names:["number"]}}],sourceFiles:["/home/runner/work/osis-document/osis-document/frontend/components/ToolbarPagination.vue"]};var pdfExports={},pdf={get exports(){return pdfExports},set exports(ae){pdfExports=ae}};(function(module,exports){d(function(C,de){module.exports=de()},"webpackUniversalModuleDefinition")(globalThis,()=>(()=>{var __webpack_modules__=[,(ae,C)=>{Object.defineProperty(C,"__esModule",{value:!0}),C.VerbosityLevel=C.Util=C.UnknownErrorException=C.UnexpectedResponseException=C.TextRenderingMode=C.RenderingIntentFlag=C.PermissionFlag=C.PasswordResponses=C.PasswordException=C.PageActionEventType=C.OPS=C.MissingPDFException=C.MAX_IMAGE_SIZE_TO_CACHE=C.LINE_FACTOR=C.LINE_DESCENT_FACTOR=C.InvalidPDFException=C.ImageKind=C.IDENTITY_MATRIX=C.FormatError=C.FeatureTest=C.FONT_IDENTITY_MATRIX=C.DocumentActionEventType=C.CMapCompressionType=C.BaseException=C.BASELINE_FACTOR=C.AnnotationType=C.AnnotationStateModelType=C.AnnotationReviewState=C.AnnotationReplyType=C.AnnotationMode=C.AnnotationMarkedState=C.AnnotationFlag=C.AnnotationFieldFlag=C.AnnotationEditorType=C.AnnotationEditorPrefix=C.AnnotationEditorParamsType=C.AnnotationBorderStyleType=C.AnnotationActionEventType=C.AbortException=void 0,C.assert=oe,C.bytesToString=N,C.createPromiseCapability=se,C.createValidAbsoluteUrl=A,C.getModificationDate=T,C.getVerbosityLevel=fe,C.info=K,C.isArrayBuffer=Pe,C.isArrayEqual=Re,C.objectFromMap=k,C.objectSize=y,C.setVerbosityLevel=re,C.shadow=v,C.string32=_,C.stringToBytes=a,C.stringToPDFString=ce,C.stringToUTF8String=_e,C.unreachable=Ee,C.utf8StringToString=Se,C.warn=me;const de=[1,0,0,1,0,0];C.IDENTITY_MATRIX=de;const x=[.001,0,0,.001,0,0];C.FONT_IDENTITY_MATRIX=x;const B=1e7;C.MAX_IMAGE_SIZE_TO_CACHE=B;const ue=1.35;C.LINE_FACTOR=ue;const G=.35;C.LINE_DESCENT_FACTOR=G;const L=G/ue;C.BASELINE_FACTOR=L;const I={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};C.RenderingIntentFlag=I;const f={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};C.AnnotationMode=f;const l="pdfjs_internal_editor_";C.AnnotationEditorPrefix=l;const w={DISABLE:-1,NONE:0,FREETEXT:3,INK:15};C.AnnotationEditorType=w;const S={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};C.AnnotationEditorParamsType=S;const g={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};C.PermissionFlag=g;const i={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};C.TextRenderingMode=i;const c={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};C.ImageKind=c;const n={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};C.AnnotationType=n;const o={MARKED:"Marked",REVIEW:"Review"};C.AnnotationStateModelType=o;const E={MARKED:"Marked",UNMARKED:"Unmarked"};C.AnnotationMarkedState=E;const b={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};C.AnnotationReviewState=b;const p={GROUP:"Group",REPLY:"R"};C.AnnotationReplyType=p;const e={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};C.AnnotationFlag=e;const t={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};C.AnnotationFieldFlag=t;const r={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};C.AnnotationBorderStyleType=r;const s={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};C.AnnotationActionEventType=s;const m={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};C.DocumentActionEventType=m;const P={O:"PageOpen",C:"PageClose"};C.PageActionEventType=P;const h={ERRORS:0,WARNINGS:1,INFOS:5};C.VerbosityLevel=h;const F={NONE:0,BINARY:1};C.CMapCompressionType=F;const J={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};C.OPS=J;const le={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};C.PasswordResponses=le;let q=h.WARNINGS;function re(M){Number.isInteger(M)&&(q=M)}d(re,"setVerbosityLevel");function fe(){return q}d(fe,"getVerbosityLevel");function K(M){q>=h.INFOS&&console.log(`Info: ${M}`)}d(K,"info");function me(M){q>=h.WARNINGS&&console.log(`Warning: ${M}`)}d(me,"warn");function Ee(M){throw new Error(M)}d(Ee,"unreachable");function oe(M,O){M||Ee(O)}d(oe,"assert");function W(M){if(!M)return!1;switch(M.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}d(W,"_isValidProtocol");function A(M,O=null,j=null){if(!M)return null;try{if(j&&typeof M=="string"){if(j.addDefaultProtocol&&M.startsWith("www.")){const Te=M.match(/\./g);Te&&Te.length>=2&&(M=`http://${M}`)}if(j.tryConvertEncoding)try{M=_e(M)}catch{}}const be=O?new URL(M,O):new URL(M);if(W(be))return be}catch{}return null}d(A,"createValidAbsoluteUrl");function v(M,O,j,be=!1){return Object.defineProperty(M,O,{value:j,enumerable:!be,configurable:!0,writable:!1}),j}d(v,"shadow");const R=d(function(){function O(j,be){this.constructor===O&&Ee("Cannot initialize BaseException."),this.message=j,this.name=be}return d(O,"BaseException"),O.prototype=new Error,O.constructor=O,O},"BaseExceptionClosure")();C.BaseException=R;class z extends R{constructor(O,j){super(O,"PasswordException"),this.code=j}}d(z,"PasswordException"),C.PasswordException=z;class H extends R{constructor(O,j){super(O,"UnknownErrorException"),this.details=j}}d(H,"UnknownErrorException"),C.UnknownErrorException=H;class ne extends R{constructor(O){super(O,"InvalidPDFException")}}d(ne,"InvalidPDFException"),C.InvalidPDFException=ne;class D extends R{constructor(O){super(O,"MissingPDFException")}}d(D,"MissingPDFException"),C.MissingPDFException=D;class Y extends R{constructor(O,j){super(O,"UnexpectedResponseException"),this.status=j}}d(Y,"UnexpectedResponseException"),C.UnexpectedResponseException=Y;class te extends R{constructor(O){super(O,"FormatError")}}d(te,"FormatError"),C.FormatError=te;class V extends R{constructor(O){super(O,"AbortException")}}d(V,"AbortException"),C.AbortException=V;function N(M){(typeof M!="object"||M===null||M.length===void 0)&&Ee("Invalid argument for bytesToString");const O=M.length,j=8192;if(O<j)return String.fromCharCode.apply(null,M);const be=[];for(let Te=0;Te<O;Te+=j){const ie=Math.min(Te+j,O),ye=M.subarray(Te,ie);be.push(String.fromCharCode.apply(null,ye))}return be.join("")}d(N,"bytesToString");function a(M){typeof M!="string"&&Ee("Invalid argument for stringToBytes");const O=M.length,j=new Uint8Array(O);for(let be=0;be<O;++be)j[be]=M.charCodeAt(be)&255;return j}d(a,"stringToBytes");function _(M){return String.fromCharCode(M>>24&255,M>>16&255,M>>8&255,M&255)}d(_,"string32");function y(M){return Object.keys(M).length}d(y,"objectSize");function k(M){const O=Object.create(null);for(const[j,be]of M)O[j]=be;return O}d(k,"objectFromMap");function U(){const M=new Uint8Array(4);return M[0]=1,new Uint32Array(M.buffer,0,1)[0]===1}d(U,"isLittleEndian");function $(){try{return new Function(""),!0}catch{return!1}}d($,"isEvalSupported");class he{static get isLittleEndian(){return v(this,"isLittleEndian",U())}static get isEvalSupported(){return v(this,"isEvalSupported",$())}static get isOffscreenCanvasSupported(){return v(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?v(this,"platform",{isWin:!1,isMac:!1}):v(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}}d(he,"FeatureTest"),C.FeatureTest=he;const X=[...Array(256).keys()].map(M=>M.toString(16).padStart(2,"0"));class Q{static makeHexColor(O,j,be){return`#${X[O]}${X[j]}${X[be]}`}static scaleMinMax(O,j){let be;O[0]?(O[0]<0&&(be=j[0],j[0]=j[1],j[1]=be),j[0]*=O[0],j[1]*=O[0],O[3]<0&&(be=j[2],j[2]=j[3],j[3]=be),j[2]*=O[3],j[3]*=O[3]):(be=j[0],j[0]=j[2],j[2]=be,be=j[1],j[1]=j[3],j[3]=be,O[1]<0&&(be=j[2],j[2]=j[3],j[3]=be),j[2]*=O[1],j[3]*=O[1],O[2]<0&&(be=j[0],j[0]=j[1],j[1]=be),j[0]*=O[2],j[1]*=O[2]),j[0]+=O[4],j[1]+=O[4],j[2]+=O[5],j[3]+=O[5]}static transform(O,j){return[O[0]*j[0]+O[2]*j[1],O[1]*j[0]+O[3]*j[1],O[0]*j[2]+O[2]*j[3],O[1]*j[2]+O[3]*j[3],O[0]*j[4]+O[2]*j[5]+O[4],O[1]*j[4]+O[3]*j[5]+O[5]]}static applyTransform(O,j){const be=O[0]*j[0]+O[1]*j[2]+j[4],Te=O[0]*j[1]+O[1]*j[3]+j[5];return[be,Te]}static applyInverseTransform(O,j){const be=j[0]*j[3]-j[1]*j[2],Te=(O[0]*j[3]-O[1]*j[2]+j[2]*j[5]-j[4]*j[3])/be,ie=(-O[0]*j[1]+O[1]*j[0]+j[4]*j[1]-j[5]*j[0])/be;return[Te,ie]}static getAxialAlignedBoundingBox(O,j){const be=Q.applyTransform(O,j),Te=Q.applyTransform(O.slice(2,4),j),ie=Q.applyTransform([O[0],O[3]],j),ye=Q.applyTransform([O[2],O[1]],j);return[Math.min(be[0],Te[0],ie[0],ye[0]),Math.min(be[1],Te[1],ie[1],ye[1]),Math.max(be[0],Te[0],ie[0],ye[0]),Math.max(be[1],Te[1],ie[1],ye[1])]}static inverseTransform(O){const j=O[0]*O[3]-O[1]*O[2];return[O[3]/j,-O[1]/j,-O[2]/j,O[0]/j,(O[2]*O[5]-O[4]*O[3])/j,(O[4]*O[1]-O[5]*O[0])/j]}static singularValueDecompose2dScale(O){const j=[O[0],O[2],O[1],O[3]],be=O[0]*j[0]+O[1]*j[2],Te=O[0]*j[1]+O[1]*j[3],ie=O[2]*j[0]+O[3]*j[2],ye=O[2]*j[1]+O[3]*j[3],Me=(be+ye)/2,ge=Math.sqrt((be+ye)**2-4*(be*ye-ie*Te))/2,Ae=Me+ge||1,Ce=Me-ge||1;return[Math.sqrt(Ae),Math.sqrt(Ce)]}static normalizeRect(O){const j=O.slice(0);return O[0]>O[2]&&(j[0]=O[2],j[2]=O[0]),O[1]>O[3]&&(j[1]=O[3],j[3]=O[1]),j}static intersect(O,j){const be=Math.max(Math.min(O[0],O[2]),Math.min(j[0],j[2])),Te=Math.min(Math.max(O[0],O[2]),Math.max(j[0],j[2]));if(be>Te)return null;const ie=Math.max(Math.min(O[1],O[3]),Math.min(j[1],j[3])),ye=Math.min(Math.max(O[1],O[3]),Math.max(j[1],j[3]));return ie>ye?null:[be,ie,Te,ye]}static bezierBoundingBox(O,j,be,Te,ie,ye,Me,ge){const Ae=[],Ce=[[],[]];let xe,we,Le,ke,Fe,Ie,Oe,De;for(let je=0;je<2;++je){if(je===0?(we=6*O-12*be+6*ie,xe=-3*O+9*be-9*ie+3*Me,Le=3*be-3*O):(we=6*j-12*Te+6*ye,xe=-3*j+9*Te-9*ye+3*ge,Le=3*Te-3*j),Math.abs(xe)<1e-12){if(Math.abs(we)<1e-12)continue;ke=-Le/we,0<ke&&ke<1&&Ae.push(ke);continue}Oe=we*we-4*Le*xe,De=Math.sqrt(Oe),!(Oe<0)&&(Fe=(-we+De)/(2*xe),0<Fe&&Fe<1&&Ae.push(Fe),Ie=(-we-De)/(2*xe),0<Ie&&Ie<1&&Ae.push(Ie))}let Ve=Ae.length,Ne;const Be=Ve;for(;Ve--;)ke=Ae[Ve],Ne=1-ke,Ce[0][Ve]=Ne*Ne*Ne*O+3*Ne*Ne*ke*be+3*Ne*ke*ke*ie+ke*ke*ke*Me,Ce[1][Ve]=Ne*Ne*Ne*j+3*Ne*Ne*ke*Te+3*Ne*ke*ke*ye+ke*ke*ke*ge;return Ce[0][Be]=O,Ce[1][Be]=j,Ce[0][Be+1]=Me,Ce[1][Be+1]=ge,Ce[0].length=Ce[1].length=Be+2,[Math.min(...Ce[0]),Math.min(...Ce[1]),Math.max(...Ce[0]),Math.max(...Ce[1])]}}d(Q,"Util"),C.Util=Q;const pe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function ce(M){if(M[0]>="ï"){let j;if(M[0]==="þ"&&M[1]==="ÿ"?j="utf-16be":M[0]==="ÿ"&&M[1]==="þ"?j="utf-16le":M[0]==="ï"&&M[1]==="»"&&M[2]==="¿"&&(j="utf-8"),j)try{const be=new TextDecoder(j,{fatal:!0}),Te=a(M);return be.decode(Te)}catch(be){me(`stringToPDFString: "${be}".`)}}const O=[];for(let j=0,be=M.length;j<be;j++){const Te=pe[M.charCodeAt(j)];O.push(Te?String.fromCharCode(Te):M.charAt(j))}return O.join("")}d(ce,"stringToPDFString");function _e(M){return decodeURIComponent(escape(M))}d(_e,"stringToUTF8String");function Se(M){return unescape(encodeURIComponent(M))}d(Se,"utf8StringToString");function Pe(M){return typeof M=="object"&&M!==null&&M.byteLength!==void 0}d(Pe,"isArrayBuffer");function Re(M,O){if(M.length!==O.length)return!1;for(let j=0,be=M.length;j<be;j++)if(M[j]!==O[j])return!1;return!0}d(Re,"isArrayEqual");function T(M=new Date){return[M.getUTCFullYear().toString(),(M.getUTCMonth()+1).toString().padStart(2,"0"),M.getUTCDate().toString().padStart(2,"0"),M.getUTCHours().toString().padStart(2,"0"),M.getUTCMinutes().toString().padStart(2,"0"),M.getUTCSeconds().toString().padStart(2,"0")].join("")}d(T,"getModificationDate");function se(){const M=Object.create(null);let O=!1;return Object.defineProperty(M,"settled",{get(){return O}}),M.promise=new Promise(function(j,be){M.resolve=function(Te){O=!0,j(Te)},M.reject=function(Te){O=!0,be(Te)}}),M}d(se,"createPromiseCapability")},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var ae,de,x,B,st,G,_t,I,f,l,w,S,g,i,c,xt,o,E,Mt,p,e;Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_is_node=__w_pdfjs_require__(10),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_xfa_text=__w_pdfjs_require__(19);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultFilterFactory=_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:r,NodeCMapReaderFactory:s,NodeFilterFactory:m,NodeStandardFontDataFactory:P}=__w_pdfjs_require__(20);exports.DefaultCanvasFactory=DefaultCanvasFactory=r,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=s,exports.DefaultFilterFactory=DefaultFilterFactory=m,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=P}let createPDFNetworkStream;if(_is_node.isNodeJS){const{PDFNodeStream:r}=__w_pdfjs_require__(21);createPDFNetworkStream=d(s=>new r(s),"createPDFNetworkStream")}else{const{PDFNetworkStream:r}=__w_pdfjs_require__(24),{PDFFetchStream:s}=__w_pdfjs_require__(25);createPDFNetworkStream=d(m=>(0,_display_utils.isValidFetchUrl)(m.url)?new s(m):new r(m),"createPDFNetworkStream")}function getDocument(r){if(typeof r=="string"||r instanceof URL?r={url:r}:(0,_util.isArrayBuffer)(r)&&(r={data:r}),typeof r!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!r.url&&!r.data&&!r.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const s=new PDFDocumentLoadingTask,{docId:m}=s,P=r.url?getUrlProp(r.url):null,h=r.data?getDataProp(r.data):null,F=r.httpHeaders||null,J=r.withCredentials===!0,le=r.password??null,q=r.range instanceof PDFDataRangeTransport?r.range:null,re=Number.isInteger(r.rangeChunkSize)&&r.rangeChunkSize>0?r.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let fe=r.worker instanceof PDFWorker?r.worker:null;const K=r.verbosity,me=typeof r.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(r.docBaseUrl)?r.docBaseUrl:null,Ee=typeof r.cMapUrl=="string"?r.cMapUrl:null,oe=r.cMapPacked!==!1,W=r.CMapReaderFactory||DefaultCMapReaderFactory,A=typeof r.standardFontDataUrl=="string"?r.standardFontDataUrl:null,v=r.StandardFontDataFactory||DefaultStandardFontDataFactory,R=r.stopAtErrors!==!0,z=Number.isInteger(r.maxImageSize)&&r.maxImageSize>-1?r.maxImageSize:-1,H=r.isEvalSupported!==!1,ne=typeof r.isOffscreenCanvasSupported=="boolean"?r.isOffscreenCanvasSupported:!_is_node.isNodeJS,D=Number.isInteger(r.canvasMaxAreaInBytes)?r.canvasMaxAreaInBytes:-1,Y=typeof r.disableFontFace=="boolean"?r.disableFontFace:_is_node.isNodeJS,te=r.fontExtraProperties===!0,V=r.enableXfa===!0,N=r.ownerDocument||globalThis.document,a=r.disableRange===!0,_=r.disableStream===!0,y=r.disableAutoFetch===!0,k=r.pdfBug===!0,U=q?q.length:r.length??NaN,$=typeof r.useSystemFonts=="boolean"?r.useSystemFonts:!_is_node.isNodeJS&&!Y,he=typeof r.useWorkerFetch=="boolean"?r.useWorkerFetch:W===_display_utils.DOMCMapReaderFactory&&v===_display_utils.DOMStandardFontDataFactory&&(0,_display_utils.isValidFetchUrl)(Ee,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(A,document.baseURI),X=r.canvasFactory||new DefaultCanvasFactory({ownerDocument:N}),Q=r.filterFactory||new DefaultFilterFactory({docId:m,ownerDocument:N}),pe=null;(0,_util.setVerbosityLevel)(K);const ce={canvasFactory:X,filterFactory:Q};if(he||(ce.cMapReaderFactory=new W({baseUrl:Ee,isCompressed:oe}),ce.standardFontDataFactory=new v({baseUrl:A})),!fe){const Pe={verbosity:K,port:_worker_options.GlobalWorkerOptions.workerPort};fe=Pe.port?PDFWorker.fromPort(Pe):new PDFWorker(Pe),s._worker=fe}const _e={docId:m,apiVersion:"3.5.141",data:h,password:le,disableAutoFetch:y,rangeChunkSize:re,length:U,docBaseUrl:me,enableXfa:V,evaluatorOptions:{maxImageSize:z,disableFontFace:Y,ignoreErrors:R,isEvalSupported:H,isOffscreenCanvasSupported:ne,canvasMaxAreaInBytes:D,fontExtraProperties:te,useSystemFonts:$,cMapUrl:he?Ee:null,standardFontDataUrl:he?A:null}},Se={ignoreErrors:R,isEvalSupported:H,disableFontFace:Y,fontExtraProperties:te,enableXfa:V,ownerDocument:N,disableAutoFetch:y,pdfBug:k,styleElement:pe};return fe.promise.then(function(){if(s.destroyed)throw new Error("Loading aborted");const Pe=_fetchDocument(fe,_e),Re=new Promise(function(T){let se;q?se=new _transport_stream.PDFDataTransportStream({length:U,initialData:q.initialData,progressiveDone:q.progressiveDone,contentDispositionFilename:q.contentDispositionFilename,disableRange:a,disableStream:_},q):h||(se=createPDFNetworkStream({url:P,length:U,httpHeaders:F,withCredentials:J,rangeChunkSize:re,disableRange:a,disableStream:_})),T(se)});return Promise.all([Pe,Re]).then(function([T,se]){if(s.destroyed)throw new Error("Loading aborted");const M=new _message_handler.MessageHandler(m,T,fe.port),O=new WorkerTransport(M,s,se,Se,ce);s._transport=O,M.send("Ready",null)})}).catch(s._capability.reject),s}d(getDocument,"getDocument");async function _fetchDocument(r,s){if(r.destroyed)throw new Error("Worker was destroyed");const m=await r.messageHandler.sendWithPromise("GetDocRequest",s,s.data?[s.data.buffer]:null);if(r.destroyed)throw new Error("Worker was destroyed");return m}d(_fetchDocument,"_fetchDocument");function getUrlProp(r){if(r instanceof URL)return r.href;try{return new URL(r,window.location).href}catch{if(_is_node.isNodeJS&&typeof r=="string")return r}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}d(getUrlProp,"getUrlProp");function getDataProp(r){if(_is_node.isNodeJS&&typeof Buffer<"u"&&r instanceof Buffer)return(0,_display_utils.deprecated)("Please provide binary data as `Uint8Array`, rather than `Buffer`."),new Uint8Array(r);if(r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength)return r;if(typeof r=="string")return(0,_util.stringToBytes)(r);if(typeof r=="object"&&!isNaN(r==null?void 0:r.length)||(0,_util.isArrayBuffer)(r))return new Uint8Array(r);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}d(getDataProp,"getDataProp");const C=class{constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId=`d${ht(C,ae)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var s;this.destroyed=!0,await((s=this._transport)==null?void 0:s.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};let PDFDocumentLoadingTask=C;d(PDFDocumentLoadingTask,"PDFDocumentLoadingTask"),ae=new WeakMap,Z(PDFDocumentLoadingTask,ae,0),exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(s,m,P=!1,h=null){this.length=s,this.initialData=m,this.progressiveDone=P,this.contentDispositionFilename=h,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(s){this._rangeListeners.push(s)}addProgressListener(s){this._progressListeners.push(s)}addProgressiveReadListener(s){this._progressiveReadListeners.push(s)}addProgressiveDoneListener(s){this._progressiveDoneListeners.push(s)}onDataRange(s,m){for(const P of this._rangeListeners)P(s,m)}onDataProgress(s,m){this._readyCapability.promise.then(()=>{for(const P of this._progressListeners)P(s,m)})}onDataProgressiveRead(s){this._readyCapability.promise.then(()=>{for(const m of this._progressiveReadListeners)m(s)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const s of this._progressiveDoneListeners)s()})}transportReady(){this._readyCapability.resolve()}requestDataRange(s,m){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}d(PDFDataRangeTransport,"PDFDataRangeTransport"),exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(s,m){this._pdfInfo=s,this._transport=m}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(s){return this._transport.getPage(s)}getPageIndex(s){return this._transport.getPageIndex(s)}getDestinations(){return this._transport.getDestinations()}getDestination(s){return this._transport.getDestination(s)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(s=!1){return this._transport.startCleanup(s||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}d(PDFDocumentProxy,"PDFDocumentProxy"),exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(s,m,P,h=!1){Z(this,B);Z(this,G);Z(this,de,null);Z(this,x,!1);this._pageIndex=s,this._pageInfo=m,this._transport=P,this._stats=h?new _display_utils.StatTimer:null,this._pdfBug=h,this.commonObjs=P.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:s,rotation:m=this.rotate,offsetX:P=0,offsetY:h=0,dontFlip:F=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:s,rotation:m,offsetX:P,offsetY:h,dontFlip:F})}getAnnotations({intent:s="display"}={}){const m=this._transport.getRenderingIntent(s);return this._transport.getAnnotations(this._pageIndex,m.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var s;return((s=this._transport._htmlForXfa)==null?void 0:s.children[this._pageIndex])||null}render({canvasContext:s,viewport:m,intent:P="display",annotationMode:h=_util.AnnotationMode.ENABLE,transform:F=null,background:J=null,optionalContentConfigPromise:le=null,annotationCanvasMap:q=null,pageColors:re=null,printAnnotationStorage:fe=null}){var v,R,z;if((v=arguments[0])!=null&&v.canvasFactory)throw new Error("render no longer accepts the `canvasFactory`-option, please pass it to the `getDocument`-function instead.");(R=this._stats)==null||R.time("Overall");const K=this._transport.getRenderingIntent(P,h,fe);ve(this,x,!1),ee(this,G,_t).call(this),le||(le=this._transport.getOptionalContentConfig());let me=this._intentStates.get(K.cacheKey);me||(me=Object.create(null),this._intentStates.set(K.cacheKey,me)),me.streamReaderCancelTimeout&&(clearTimeout(me.streamReaderCancelTimeout),me.streamReaderCancelTimeout=null);const Ee=!!(K.renderingIntent&_util.RenderingIntentFlag.PRINT);me.displayReadyCapability||(me.displayReadyCapability=(0,_util.createPromiseCapability)(),me.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(z=this._stats)==null||z.time("Page Request"),this._pumpOperatorList(K));const oe=d(H=>{var ne,D;me.renderTasks.delete(W),(this._maybeCleanupAfterRender||Ee)&&ve(this,x,!0),ee(this,B,st).call(this,!Ee),H?(W.capability.reject(H),this._abortOperatorList({intentState:me,reason:H instanceof Error?H:new Error(H)})):W.capability.resolve(),(ne=this._stats)==null||ne.timeEnd("Rendering"),(D=this._stats)==null||D.timeEnd("Overall")},"complete"),W=new InternalRenderTask({callback:oe,params:{canvasContext:s,viewport:m,transform:F,background:J},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:q,operatorList:me.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!Ee,pdfBug:this._pdfBug,pageColors:re});(me.renderTasks||(me.renderTasks=new Set)).add(W);const A=W.task;return Promise.all([me.displayReadyCapability.promise,le]).then(([H,ne])=>{var D;if(u(this,x)){oe();return}(D=this._stats)==null||D.time("Rendering"),W.initializeGraphics({transparency:H,optionalContentConfig:ne}),W.operatorListChanged()}).catch(oe),A}getOperatorList({intent:s="display",annotationMode:m=_util.AnnotationMode.ENABLE,printAnnotationStorage:P=null}={}){var q;function h(){J.operatorList.lastChunk&&(J.opListReadCapability.resolve(J.operatorList),J.renderTasks.delete(le))}d(h,"operatorListChanged");const F=this._transport.getRenderingIntent(s,m,P,!0);let J=this._intentStates.get(F.cacheKey);J||(J=Object.create(null),this._intentStates.set(F.cacheKey,J));let le;return J.opListReadCapability||(le=Object.create(null),le.operatorListChanged=h,J.opListReadCapability=(0,_util.createPromiseCapability)(),(J.renderTasks||(J.renderTasks=new Set)).add(le),J.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(q=this._stats)==null||q.time("Page Request"),this._pumpOperatorList(F)),J.opListReadCapability.promise}streamTextContent({includeMarkedContent:s=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:s===!0},{highWaterMark:100,size(P){return P.items.length}})}getTextContent(s={}){if(this._transport._htmlForXfa)return this.getXfa().then(P=>_xfa_text.XfaText.textContent(P));const m=this.streamTextContent(s);return new Promise(function(P,h){function F(){J.read().then(function({value:q,done:re}){if(re){P(le);return}Object.assign(le.styles,q.styles),le.items.push(...q.items),F()},h)}d(F,"pump");const J=m.getReader(),le={items:[],styles:Object.create(null)};F()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const s=[];for(const m of this._intentStates.values())if(this._abortOperatorList({intentState:m,reason:new Error("Page was destroyed."),force:!0}),!m.opListReadCapability)for(const P of m.renderTasks)s.push(P.completed),P.cancel();return this.objs.clear(),ve(this,x,!1),ee(this,G,_t).call(this),Promise.all(s)}cleanup(s=!1){ve(this,x,!0);const m=ee(this,B,st).call(this,!1);return s&&m&&this._stats&&(this._stats=new _display_utils.StatTimer),m}_startRenderPage(s,m){var h,F;const P=this._intentStates.get(m);P&&((h=this._stats)==null||h.timeEnd("Page Request"),(F=P.displayReadyCapability)==null||F.resolve(s))}_renderPageChunk(s,m){for(let P=0,h=s.length;P<h;P++)m.operatorList.fnArray.push(s.fnArray[P]),m.operatorList.argsArray.push(s.argsArray[P]);m.operatorList.lastChunk=s.lastChunk,m.operatorList.separateAnnots=s.separateAnnots;for(const P of m.renderTasks)P.operatorListChanged();s.lastChunk&&ee(this,B,st).call(this,!0)}_pumpOperatorList({renderingIntent:s,cacheKey:m,annotationStorageMap:P}){const F=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:s,cacheKey:m,annotationStorage:P}).getReader(),J=this._intentStates.get(m);J.streamReader=F;const le=d(()=>{F.read().then(({value:q,done:re})=>{if(re){J.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(q,J),le())},q=>{if(J.streamReader=null,!this._transport.destroyed){if(J.operatorList){J.operatorList.lastChunk=!0;for(const re of J.renderTasks)re.operatorListChanged();ee(this,B,st).call(this,!0)}if(J.displayReadyCapability)J.displayReadyCapability.reject(q);else if(J.opListReadCapability)J.opListReadCapability.reject(q);else throw q}})},"pump");le()}_abortOperatorList({intentState:s,reason:m,force:P=!1}){if(s.streamReader){if(s.streamReaderCancelTimeout&&(clearTimeout(s.streamReaderCancelTimeout),s.streamReaderCancelTimeout=null),!P){if(s.renderTasks.size>0)return;if(m instanceof _display_utils.RenderingCancelledException){let h=RENDERING_CANCELLED_TIMEOUT;m.extraDelay>0&&m.extraDelay<1e3&&(h+=m.extraDelay),s.streamReaderCancelTimeout=setTimeout(()=>{s.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:s,reason:m,force:!0})},h);return}}if(s.streamReader.cancel(new _util.AbortException(m.message)).catch(()=>{}),s.streamReader=null,!this._transport.destroyed){for(const[h,F]of this._intentStates)if(F===s){this._intentStates.delete(h);break}this.cleanup()}}}get stats(){return this._stats}}d(PDFPageProxy,"PDFPageProxy"),de=new WeakMap,x=new WeakMap,B=new WeakSet,st=d(function(s=!1){if(ee(this,G,_t).call(this),!u(this,x))return!1;if(s)return ve(this,de,setTimeout(()=>{ve(this,de,null),ee(this,B,st).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:m,operatorList:P}of this._intentStates.values())if(m.size>0||!P.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),ve(this,x,!1),!0},"#tryCleanup"),G=new WeakSet,_t=d(function(){u(this,de)&&(clearTimeout(u(this,de)),ve(this,de,null))},"#abortDelayedCleanup"),exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){Z(this,I,new Set);Z(this,f,Promise.resolve())}postMessage(s,m){const P={data:structuredClone(s,m?{transfer:m}:null)};u(this,f).then(()=>{for(const h of u(this,I))h.call(this,P)})}addEventListener(s,m){u(this,I).add(m)}removeEventListener(s,m){u(this,I).delete(m)}terminate(){u(this,I).clear()}}d(LoopbackPort,"LoopbackPort"),I=new WeakMap,f=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const r=(l=document==null?void 0:document.currentScript)==null?void 0:l.src;r&&(PDFWorkerUtil.fallbackWorkerSrc=r.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(r,s){let m;try{if(m=new URL(r),!m.origin||m.origin==="null")return!1}catch{return!1}const P=new URL(s,m);return m.origin===P.origin},PDFWorkerUtil.createCDNWrapper=function(r){const s=`importScripts("${r}");`;return URL.createObjectURL(new Blob([s]))}}const _PDFWorker=class{constructor({name:r=null,port:s=null,verbosity:m=(0,_util.getVerbosityLevel)()}={}){if(s&&u(_PDFWorker,w).has(s))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=r,this.destroyed=!1,this.verbosity=m,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,s){u(_PDFWorker,w).set(s,this),this._initializeFromPort(s);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(r){this._port=r,this._messageHandler=new _message_handler.MessageHandler("main","worker",r),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:r}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,r)||(r=PDFWorkerUtil.createCDNWrapper(new URL(r,window.location).href));const s=new Worker(r),m=new _message_handler.MessageHandler("main","worker",s),P=d(()=>{s.removeEventListener("error",h),m.destroy(),s.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},"terminateEarly"),h=d(()=>{this._webWorker||P()},"onWorkerError");s.addEventListener("error",h),m.on("test",J=>{if(s.removeEventListener("error",h),this.destroyed){P();return}J?(this._messageHandler=m,this._port=s,this._webWorker=s,this._readyCapability.resolve(),m.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),m.destroy(),s.terminate())}),m.on("ready",J=>{if(s.removeEventListener("error",h),this.destroyed){P();return}try{F()}catch{this._setupFakeWorker()}});const F=d(()=>{const J=new Uint8Array;m.send("test",J,[J.buffer])},"sendTest");F();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(r=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const s=new LoopbackPort;this._port=s;const m=`fake${PDFWorkerUtil.fakeWorkerId++}`,P=new _message_handler.MessageHandler(m+"_worker",m,s);r.setup(P,s);const h=new _message_handler.MessageHandler(m,m+"_worker",s);this._messageHandler=h,this._readyCapability.resolve(),h.send("configure",{verbosity:this.verbosity})}).catch(r=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${r.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),u(_PDFWorker,w).delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(r){if(!(r!=null&&r.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return u(this,w).has(r.port)?u(this,w).get(r.port):new _PDFWorker(r)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var r;try{return((r=globalThis.pdfjsWorker)==null?void 0:r.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=d(async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler},"loader");return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};let PDFWorker=_PDFWorker;d(PDFWorker,"PDFWorker"),w=new WeakMap,Z(PDFWorker,w,new WeakMap),exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(s,m,P,h,F){Z(this,c);Z(this,S,new Map);Z(this,g,new Map);Z(this,i,new Map);this.messageHandler=s,this.loadingTask=m,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:h.ownerDocument,styleElement:h.styleElement}),this._params=h,this.canvasFactory=F.canvasFactory,this.filterFactory=F.filterFactory,this.cMapReaderFactory=F.cMapReaderFactory,this.standardFontDataFactory=F.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=P,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(s,m=_util.AnnotationMode.ENABLE,P=null,h=!1){let F=_util.RenderingIntentFlag.DISPLAY,J=null;switch(s){case"any":F=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":F=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${s}`)}switch(m){case _util.AnnotationMode.DISABLE:F+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:F+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:F+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,J=(F&_util.RenderingIntentFlag.PRINT&&P instanceof _annotation_storage.PrintAnnotationStorage?P:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${m}`)}return h&&(F+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:F,cacheKey:`${F}_${_annotation_storage.AnnotationStorage.getHash(J)}`,annotationStorageMap:J}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const s=[];for(const P of u(this,g).values())s.push(P._destroy());u(this,g).clear(),u(this,i).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const m=this.messageHandler.sendWithPromise("Terminate",null);return s.push(m),Promise.all(s).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),u(this,S).clear(),this.filterFactory.destroy(),this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:s,loadingTask:m}=this;s.on("GetReader",(P,h)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=F=>{this._lastProgress={loaded:F.loaded,total:F.total}},h.onPull=()=>{this._fullReader.read().then(function({value:F,done:J}){if(J){h.close();return}(0,_util.assert)(F instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),h.enqueue(new Uint8Array(F),1,[F])}).catch(F=>{h.error(F)})},h.onCancel=F=>{this._fullReader.cancel(F),h.ready.catch(J=>{if(!this.destroyed)throw J})}}),s.on("ReaderHeadersReady",P=>{const h=(0,_util.createPromiseCapability)(),F=this._fullReader;return F.headersReady.then(()=>{var J;(!F.isStreamingSupported||!F.isRangeSupported)&&(this._lastProgress&&((J=m.onProgress)==null||J.call(m,this._lastProgress)),F.onProgress=le=>{var q;(q=m.onProgress)==null||q.call(m,{loaded:le.loaded,total:le.total})}),h.resolve({isStreamingSupported:F.isStreamingSupported,isRangeSupported:F.isRangeSupported,contentLength:F.contentLength})},h.reject),h.promise}),s.on("GetRangeReader",(P,h)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const F=this._networkStream.getRangeReader(P.begin,P.end);if(!F){h.close();return}h.onPull=()=>{F.read().then(function({value:J,done:le}){if(le){h.close();return}(0,_util.assert)(J instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),h.enqueue(new Uint8Array(J),1,[J])}).catch(J=>{h.error(J)})},h.onCancel=J=>{F.cancel(J),h.ready.catch(le=>{if(!this.destroyed)throw le})}}),s.on("GetDoc",({pdfInfo:P})=>{this._numPages=P.numPages,this._htmlForXfa=P.htmlForXfa,delete P.htmlForXfa,m._capability.resolve(new PDFDocumentProxy(P,this))}),s.on("DocException",function(P){let h;switch(P.name){case"PasswordException":h=new _util.PasswordException(P.message,P.code);break;case"InvalidPDFException":h=new _util.InvalidPDFException(P.message);break;case"MissingPDFException":h=new _util.MissingPDFException(P.message);break;case"UnexpectedResponseException":h=new _util.UnexpectedResponseException(P.message,P.status);break;case"UnknownErrorException":h=new _util.UnknownErrorException(P.message,P.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}m._capability.reject(h)}),s.on("PasswordRequest",P=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),m.onPassword){const h=d(F=>{F instanceof Error?this._passwordCapability.reject(F):this._passwordCapability.resolve({password:F})},"updatePassword");try{m.onPassword(h,P.code)}catch(F){this._passwordCapability.reject(F)}}else this._passwordCapability.reject(new _util.PasswordException(P.message,P.code));return this._passwordCapability.promise}),s.on("DataLoaded",P=>{var h;(h=m.onProgress)==null||h.call(m,{loaded:P.length,total:P.length}),this.downloadInfoCapability.resolve(P)}),s.on("StartRenderPage",P=>{if(this.destroyed)return;u(this,g).get(P.pageIndex)._startRenderPage(P.transparency,P.cacheKey)}),s.on("commonobj",([P,h,F])=>{var J;if(!this.destroyed&&!this.commonObjs.has(P))switch(h){case"Font":const le=this._params;if("error"in F){const fe=F.error;(0,_util.warn)(`Error during font loading: ${fe}`),this.commonObjs.resolve(P,fe);break}const q=le.pdfBug&&((J=globalThis.FontInspector)!=null&&J.enabled)?(fe,K)=>globalThis.FontInspector.fontAdded(fe,K):null,re=new _font_loader.FontFaceObject(F,{isEvalSupported:le.isEvalSupported,disableFontFace:le.disableFontFace,ignoreErrors:le.ignoreErrors,inspectFont:q});this.fontLoader.bind(re).catch(fe=>s.sendWithPromise("FontFallback",{id:P})).finally(()=>{!le.fontExtraProperties&&re.data&&(re.data=null),this.commonObjs.resolve(P,re)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(P,F);break;default:throw new Error(`Got unknown common object type ${h}`)}}),s.on("obj",([P,h,F,J])=>{var q;if(this.destroyed)return;const le=u(this,g).get(h);if(!le.objs.has(P))switch(F){case"Image":if(le.objs.resolve(P,J),J){let re;if(J.bitmap){const{width:fe,height:K}=J;re=fe*K*4}else re=((q=J.data)==null?void 0:q.length)||0;re>_util.MAX_IMAGE_SIZE_TO_CACHE&&(le._maybeCleanupAfterRender=!0)}break;case"Pattern":le.objs.resolve(P,J);break;default:throw new Error(`Got unknown object type ${F}`)}}),s.on("DocProgress",P=>{var h;this.destroyed||(h=m.onProgress)==null||h.call(m,{loaded:P.loaded,total:P.total})}),s.on("FetchBuiltInCMap",P=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(P):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),s.on("FetchStandardFontData",P=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(P):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var s;return this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:((s=this._fullReader)==null?void 0:s.filename)??null}).finally(()=>{this.annotationStorage.resetModified()})}getPage(s){if(!Number.isInteger(s)||s<=0||s>this._numPages)return Promise.reject(new Error("Invalid page request."));const m=s-1,P=u(this,i).get(m);if(P)return P;const h=this.messageHandler.sendWithPromise("GetPage",{pageIndex:m}).then(F=>{if(this.destroyed)throw new Error("Transport destroyed");const J=new PDFPageProxy(m,F,this,this._params.pdfBug);return u(this,g).set(m,J),J});return u(this,i).set(m,h),h}getPageIndex(s){return typeof s!="object"||s===null||!Number.isInteger(s.num)||s.num<0||!Number.isInteger(s.gen)||s.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:s.num,gen:s.gen})}getAnnotations(s,m){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:s,intent:m})}getFieldObjects(){return ee(this,c,xt).call(this,"GetFieldObjects")}hasJSActions(){return ee(this,c,xt).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(s){return typeof s!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:s})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(s){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:s})}getStructTree(s){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:s})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(s=>new _optional_content_config.OptionalContentConfig(s))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const s="GetMetadata",m=u(this,S).get(s);if(m)return m;const P=this.messageHandler.sendWithPromise(s,null).then(h=>{var F,J;return{info:h[0],metadata:h[1]?new _metadata.Metadata(h[1]):null,contentDispositionFilename:((F=this._fullReader)==null?void 0:F.filename)??null,contentLength:((J=this._fullReader)==null?void 0:J.contentLength)??null}});return u(this,S).set(s,P),P}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(s=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const m of u(this,g).values())if(!m.cleanup())throw new Error(`startCleanup: Page ${m.pageNumber} is currently rendering.`);this.commonObjs.clear(),s||this.fontLoader.clear(),u(this,S).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:s,enableXfa:m}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:s,enableXfa:m})}}d(WorkerTransport,"WorkerTransport"),S=new WeakMap,g=new WeakMap,i=new WeakMap,c=new WeakSet,xt=d(function(s,m=null){const P=u(this,S).get(s);if(P)return P;const h=this.messageHandler.sendWithPromise(s,m);return u(this,S).set(s,h),h},"#cacheSimpleMethod");class PDFObjects{constructor(){Z(this,E);Z(this,o,Object.create(null))}get(s,m=null){if(m){const h=ee(this,E,Mt).call(this,s);return h.capability.promise.then(()=>m(h.data)),null}const P=u(this,o)[s];if(!(P!=null&&P.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${s}.`);return P.data}has(s){const m=u(this,o)[s];return(m==null?void 0:m.capability.settled)||!1}resolve(s,m=null){const P=ee(this,E,Mt).call(this,s);P.data=m,P.capability.resolve()}clear(){var s;for(const m in u(this,o)){const{data:P}=u(this,o)[m];(s=P==null?void 0:P.bitmap)==null||s.close()}ve(this,o,Object.create(null))}}d(PDFObjects,"PDFObjects"),o=new WeakMap,E=new WeakSet,Mt=d(function(s){const m=u(this,o)[s];return m||(u(this,o)[s]={capability:(0,_util.createPromiseCapability)(),data:null})},"#ensureObj");class RenderTask{constructor(s){Z(this,p,null);ve(this,p,s),this.onContinue=null}get promise(){return u(this,p).capability.promise}cancel(s=0){u(this,p).cancel(null,s)}get separateAnnots(){const{separateAnnots:s}=u(this,p).operatorList;if(!s)return!1;const{annotationCanvasMap:m}=u(this,p);return s.form||s.canvas&&(m==null?void 0:m.size)>0}}d(RenderTask,"RenderTask"),p=new WeakMap,exports.RenderTask=RenderTask;const t=class{constructor({callback:s,params:m,objs:P,commonObjs:h,annotationCanvasMap:F,operatorList:J,pageIndex:le,canvasFactory:q,filterFactory:re,useRequestAnimationFrame:fe=!1,pdfBug:K=!1,pageColors:me=null}){this.callback=s,this.params=m,this.objs=P,this.commonObjs=h,this.annotationCanvasMap=F,this.operatorListIdx=null,this.operatorList=J,this._pageIndex=le,this.canvasFactory=q,this.filterFactory=re,this._pdfBug=K,this.pageColors=me,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=fe===!0&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=m.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:s=!1,optionalContentConfig:m}){var le,q;if(this.cancelled)return;if(this._canvas){if(u(t,e).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");u(t,e).add(this._canvas)}this._pdfBug&&((le=globalThis.StepperManager)!=null&&le.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:P,viewport:h,transform:F,background:J}=this.params;this.gfx=new _canvas.CanvasGraphics(P,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:m},this.annotationCanvasMap),this.gfx.beginDrawing({transform:F,viewport:h,transparency:s,background:J}),this.operatorListIdx=0,this.graphicsReady=!0,(q=this.graphicsReadyCallback)==null||q.call(this)}cancel(s=null,m=0){var P;this.running=!1,this.cancelled=!0,(P=this.gfx)==null||P.endDrawing(this.pageColors),this._canvas&&u(t,e).delete(this._canvas),this.callback(s||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas",m))}operatorListChanged(){var s;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(s=this.stepper)==null||s.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(this.pageColors),this._canvas&&u(t,e).delete(this._canvas),this.callback())))}};let InternalRenderTask=t;d(InternalRenderTask,"InternalRenderTask"),e=new WeakMap,Z(InternalRenderTask,e,new WeakSet);const version="3.5.141";exports.version=version;const build="be0f6ee08";exports.build=build},(ae,C,de)=>{var I,f,l,mi,S;Object.defineProperty(C,"__esModule",{value:!0}),C.PrintAnnotationStorage=C.AnnotationStorage=void 0;var x=de(1),B=de(4),ue=de(8);class G{constructor(){Z(this,l);Z(this,I,!1);Z(this,f,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(i,c){const n=u(this,f).get(i);return n===void 0?c:Object.assign(c,n)}getRawValue(i){return u(this,f).get(i)}remove(i){if(u(this,f).delete(i),u(this,f).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const c of u(this,f).values())if(c instanceof B.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(i,c){const n=u(this,f).get(i);let o=!1;if(n!==void 0)for(const[E,b]of Object.entries(c))n[E]!==b&&(o=!0,n[E]=b);else o=!0,u(this,f).set(i,c);o&&ee(this,l,mi).call(this),c instanceof B.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(c.constructor._type)}has(i){return u(this,f).has(i)}getAll(){return u(this,f).size>0?(0,x.objectFromMap)(u(this,f)):null}setAll(i){for(const[c,n]of Object.entries(i))this.setValue(c,n)}get size(){return u(this,f).size}resetModified(){u(this,I)&&(ve(this,I,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new L(this)}get serializable(){if(u(this,f).size===0)return null;const i=new Map;for(const[c,n]of u(this,f)){const o=n instanceof B.AnnotationEditor?n.serialize():n;o&&i.set(c,o)}return i}static getHash(i){if(!i)return"";const c=new ue.MurmurHash3_64;for(const[n,o]of i)c.update(`${n}:${JSON.stringify(o)}`);return c.hexdigest()}}d(G,"AnnotationStorage"),I=new WeakMap,f=new WeakMap,l=new WeakSet,mi=d(function(){u(this,I)||(ve(this,I,!0),typeof this.onSetModified=="function"&&this.onSetModified())},"#setModified"),C.AnnotationStorage=G;class L extends G{constructor(c){super();Z(this,S,null);ve(this,S,structuredClone(c.serializable))}get print(){(0,x.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return u(this,S)}}d(L,"PrintAnnotationStorage"),S=new WeakMap,C.PrintAnnotationStorage=L},(ae,C,de)=>{var G,L,I,f,l,w;Object.defineProperty(C,"__esModule",{value:!0}),C.AnnotationEditor=void 0;var x=de(5),B=de(1);const S=class{constructor(i){Z(this,G,this.focusin.bind(this));Z(this,L,this.focusout.bind(this));Z(this,I,!1);Z(this,f,!1);Z(this,l,!1);Ue(this,"_uiManager",null);Z(this,w,S._zIndex++);this.constructor===S&&(0,B.unreachable)("Cannot initialize AnnotationEditor."),this.parent=i.parent,this.id=i.id,this.width=this.height=null,this.pageIndex=i.parent.pageIndex,this.name=i.name,this.div=null,this._uiManager=i.uiManager;const{rotation:c,rawDims:{pageWidth:n,pageHeight:o,pageX:E,pageY:b}}=this.parent.viewport;this.rotation=c,this.pageDimensions=[n,o],this.pageTranslation=[E,b];const[p,e]=this.parentDimensions;this.x=i.x/p,this.y=i.y/e,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,B.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}addCommands(i){this._uiManager.addCommands(i)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=u(this,w)}setParent(i){i!==null&&(this.pageIndex=i.pageIndex,this.pageDimensions=i.pageDimensions),this.parent=i}focusin(i){u(this,I)?ve(this,I,!1):this.parent.setSelected(this)}focusout(i){var n;if(!this.isAttachedToDOM)return;const c=i.relatedTarget;c!=null&&c.closest(`#${this.id}`)||(i.preventDefault(),(n=this.parent)!=null&&n.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}dragstart(i){const c=this.parent.div.getBoundingClientRect();this.startX=i.clientX-c.x,this.startY=i.clientY-c.y,i.dataTransfer.setData("text/plain",this.id),i.dataTransfer.effectAllowed="move"}setAt(i,c,n,o){const[E,b]=this.parentDimensions;[n,o]=this.screenToPageTranslation(n,o),this.x=(i+n)/E,this.y=(c+o)/b,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}translate(i,c){const[n,o]=this.parentDimensions;[i,c]=this.screenToPageTranslation(i,c),this.x+=i/n,this.y+=c/o,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}screenToPageTranslation(i,c){switch(this.parentRotation){case 90:return[c,-i];case 180:return[-i,-c];case 270:return[-c,i];default:return[i,c]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return this._uiManager.viewParameters.rotation}get parentDimensions(){const{realScale:i}=this._uiManager.viewParameters,[c,n]=this.pageDimensions;return[c*i,n*i]}setDims(i,c){const[n,o]=this.parentDimensions;this.div.style.width=`${100*i/n}%`,this.div.style.height=`${100*c/o}%`}fixDims(){const{style:i}=this.div,{height:c,width:n}=i,o=n.endsWith("%"),E=c.endsWith("%");if(o&&E)return;const[b,p]=this.parentDimensions;o||(i.width=`${100*parseFloat(n)/b}%`),E||(i.height=`${100*parseFloat(c)/p}%`)}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",u(this,G)),this.div.addEventListener("focusout",u(this,L));const[i,c]=this.getInitialTranslation();return this.translate(i,c),(0,x.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(i){const{isMac:c}=B.FeatureTest.platform;if(i.button!==0||i.ctrlKey&&c){i.preventDefault();return}i.ctrlKey&&!c||i.shiftKey||i.metaKey&&c?this.parent.toggleSelected(this):this.parent.setSelected(this),ve(this,I,!0)}getRect(i,c){const n=this.parentScale,[o,E]=this.pageDimensions,[b,p]=this.pageTranslation,e=i/n,t=c/n,r=this.x*o,s=this.y*E,m=this.width*o,P=this.height*E;switch(this.rotation){case 0:return[r+e+b,E-s-t-P+p,r+e+m+b,E-s-t+p];case 90:return[r+t+b,E-s+e+p,r+t+P+b,E-s+e+m+p];case 180:return[r-e-m+b,E-s+t+p,r-e+b,E-s+t+P+p];case 270:return[r-t-P+b,E-s-e-m+p,r-t+b,E-s-e+p];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(i,c){const[n,o,E,b]=i,p=E-n,e=b-o;switch(this.rotation){case 0:return[n,c-b,p,e];case 90:return[n,c-o,e,p];case 180:return[E,c-o,p,e];case 270:return[E,c-b,e,p];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){ve(this,l,!0)}disableEditMode(){ve(this,l,!1)}isInEditMode(){return u(this,l)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var i;(i=this.div)==null||i.addEventListener("focusin",u(this,G))}serialize(){(0,B.unreachable)("An editor must be serializable")}static deserialize(i,c,n){const o=new this.prototype.constructor({parent:c,id:c.getNextId(),uiManager:n});o.rotation=i.rotation;const[E,b]=o.pageDimensions,[p,e,t,r]=o.getRectInCurrentCoords(i.rect,b);return o.x=p/E,o.y=e/b,o.width=t/E,o.height=r/b,o}remove(){this.div.removeEventListener("focusin",u(this,G)),this.div.removeEventListener("focusout",u(this,L)),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){var i;(i=this.div)==null||i.classList.add("selectedEditor")}unselect(){var i;(i=this.div)==null||i.classList.remove("selectedEditor")}updateParams(i,c){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return u(this,f)}set isEditing(i){ve(this,f,i),i?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}};let ue=S;d(ue,"AnnotationEditor"),G=new WeakMap,L=new WeakMap,I=new WeakMap,f=new WeakMap,l=new WeakMap,w=new WeakMap,Ue(ue,"_colorManager",new x.ColorManager),Ue(ue,"_zIndex",1),C.AnnotationEditor=ue},(ae,C,de)=>{var S,g,i,c,n,o,_i,p,e,t,r,s,m,P,h,F,J,le,q,re,fe,K,me,Ee,oe,W,A,v,R,z,H,bi,D,Rt,te,vi,N,yi,_,qe,k,dt,$,Ai,X,Si,pe,kt,_e,ut,Pe,Lt;Object.defineProperty(C,"__esModule",{value:!0}),C.KeyboardManager=C.CommandManager=C.ColorManager=C.AnnotationEditorUIManager=void 0,C.bindEvents=ue,C.opacityToHex=G;var x=de(1),B=de(6);function ue(se,M,O){for(const j of O)M.addEventListener(j,se[j].bind(se))}d(ue,"bindEvents");function G(se){return Math.round(Math.min(255,Math.max(1,255*se))).toString(16).padStart(2,"0")}d(G,"opacityToHex");class L{constructor(){Z(this,S,0)}getId(){return`${x.AnnotationEditorPrefix}${ht(this,S)._++}`}}d(L,"IdManager"),S=new WeakMap;class I{constructor(M=128){Z(this,g,[]);Z(this,i,!1);Z(this,c,void 0);Z(this,n,-1);ve(this,c,M)}add({cmd:M,undo:O,mustExec:j,type:be=NaN,overwriteIfSameType:Te=!1,keepUndo:ie=!1}){if(j&&M(),u(this,i))return;const ye={cmd:M,undo:O,type:be};if(u(this,n)===-1){u(this,g).length>0&&(u(this,g).length=0),ve(this,n,0),u(this,g).push(ye);return}if(Te&&u(this,g)[u(this,n)].type===be){ie&&(ye.undo=u(this,g)[u(this,n)].undo),u(this,g)[u(this,n)]=ye;return}const Me=u(this,n)+1;Me===u(this,c)?u(this,g).splice(0,1):(ve(this,n,Me),Me<u(this,g).length&&u(this,g).splice(Me)),u(this,g).push(ye)}undo(){u(this,n)!==-1&&(ve(this,i,!0),u(this,g)[u(this,n)].undo(),ve(this,i,!1),ve(this,n,u(this,n)-1))}redo(){u(this,n)<u(this,g).length-1&&(ve(this,n,u(this,n)+1),ve(this,i,!0),u(this,g)[u(this,n)].cmd(),ve(this,i,!1))}hasSomethingToUndo(){return u(this,n)!==-1}hasSomethingToRedo(){return u(this,n)<u(this,g).length-1}destroy(){ve(this,g,null)}}d(I,"CommandManager"),g=new WeakMap,i=new WeakMap,c=new WeakMap,n=new WeakMap,C.CommandManager=I;class f{constructor(M){Z(this,o);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:O}=x.FeatureTest.platform;for(const[j,be]of M)for(const Te of j){const ie=Te.startsWith("mac+");O&&ie?(this.callbacks.set(Te.slice(4),be),this.allKeys.add(Te.split("+").at(-1))):!O&&!ie&&(this.callbacks.set(Te,be),this.allKeys.add(Te.split("+").at(-1)))}}exec(M,O){if(!this.allKeys.has(O.key))return;const j=this.callbacks.get(ee(this,o,_i).call(this,O));j&&(j.bind(M)(),O.stopPropagation(),O.preventDefault())}}d(f,"KeyboardManager"),o=new WeakSet,_i=d(function(M){M.altKey&&this.buffer.push("alt"),M.ctrlKey&&this.buffer.push("ctrl"),M.metaKey&&this.buffer.push("meta"),M.shiftKey&&this.buffer.push("shift"),this.buffer.push(M.key);const O=this.buffer.join("+");return this.buffer.length=0,O},"#serialize"),C.KeyboardManager=f;const b=class{get _colors(){const M=new Map([["CanvasText",null],["Canvas",null]]);return(0,B.getColorValues)(M),(0,x.shadow)(this,"_colors",M)}convert(M){const O=(0,B.getRGB)(M);if(!window.matchMedia("(forced-colors: active)").matches)return O;for(const[j,be]of this._colors)if(be.every((Te,ie)=>Te===O[ie]))return b._colorsMapping.get(j);return O}getHexCode(M){const O=this._colors.get(M);return O?x.Util.makeHexColor(...O):M}};let l=b;d(l,"ColorManager"),Ue(l,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]])),C.ColorManager=l;const T=class{constructor(M,O,j){Z(this,H);Z(this,D);Z(this,te);Z(this,N);Z(this,_);Z(this,k);Z(this,$);Z(this,X);Z(this,pe);Z(this,_e);Z(this,Pe);Z(this,p,null);Z(this,e,new Map);Z(this,t,new Map);Z(this,r,null);Z(this,s,new I);Z(this,m,0);Z(this,P,null);Z(this,h,new Set);Z(this,F,null);Z(this,J,new L);Z(this,le,!1);Z(this,q,x.AnnotationEditorType.NONE);Z(this,re,new Set);Z(this,fe,this.copy.bind(this));Z(this,K,this.cut.bind(this));Z(this,me,this.paste.bind(this));Z(this,Ee,this.keydown.bind(this));Z(this,oe,this.onEditingAction.bind(this));Z(this,W,this.onPageChanging.bind(this));Z(this,A,this.onScaleChanging.bind(this));Z(this,v,this.onRotationChanging.bind(this));Z(this,R,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});Z(this,z,null);ve(this,z,M),ve(this,F,O),u(this,F)._on("editingaction",u(this,oe)),u(this,F)._on("pagechanging",u(this,W)),u(this,F)._on("scalechanging",u(this,A)),u(this,F)._on("rotationchanging",u(this,v)),ve(this,r,j),this.viewParameters={realScale:B.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}destroy(){ee(this,D,Rt).call(this),u(this,F)._off("editingaction",u(this,oe)),u(this,F)._off("pagechanging",u(this,W)),u(this,F)._off("scalechanging",u(this,A)),u(this,F)._off("rotationchanging",u(this,v));for(const M of u(this,t).values())M.destroy();u(this,t).clear(),u(this,e).clear(),u(this,h).clear(),ve(this,p,null),u(this,re).clear(),u(this,s).destroy()}onPageChanging({pageNumber:M}){ve(this,m,M-1)}focusMainContainer(){u(this,z).focus()}addShouldRescale(M){u(this,h).add(M)}removeShouldRescale(M){u(this,h).delete(M)}onScaleChanging({scale:M}){this.commitOrRemove(),this.viewParameters.realScale=M*B.PixelsPerInch.PDF_TO_CSS_UNITS;for(const O of u(this,h))O.onScaleChanging()}onRotationChanging({pagesRotation:M}){this.commitOrRemove(),this.viewParameters.rotation=M}addToAnnotationStorage(M){!M.isEmpty()&&u(this,r)&&!u(this,r).has(M.id)&&u(this,r).setValue(M.id,M)}copy(M){if(M.preventDefault(),u(this,p)&&u(this,p).commitOrRemove(),!this.hasSelection)return;const O=[];for(const j of u(this,re))j.isEmpty()||O.push(j.serialize());O.length!==0&&M.clipboardData.setData("application/pdfjs",JSON.stringify(O))}cut(M){this.copy(M),this.delete()}paste(M){M.preventDefault();let O=M.clipboardData.getData("application/pdfjs");if(!O)return;try{O=JSON.parse(O)}catch(be){(0,x.warn)(`paste: "${be.message}".`);return}if(!Array.isArray(O))return;this.unselectAll();const j=u(this,t).get(u(this,m));try{const be=[];for(const ye of O){const Me=j.deserialize(ye);if(!Me)return;be.push(Me)}const Te=d(()=>{for(const ye of be)ee(this,pe,kt).call(this,ye);ee(this,Pe,Lt).call(this,be)},"cmd"),ie=d(()=>{for(const ye of be)ye.remove()},"undo");this.addCommands({cmd:Te,undo:ie,mustExec:!0})}catch(be){(0,x.warn)(`paste: "${be.message}".`)}}keydown(M){var O;(O=this.getActive())!=null&&O.shouldGetKeyboardEvents()||T._keyboardManager.exec(this,M)}onEditingAction(M){["undo","redo","delete","selectAll"].includes(M.name)&&this[M.name]()}setEditingState(M){M?(ee(this,H,bi).call(this),ee(this,te,vi).call(this),ee(this,_,qe).call(this,{isEditing:u(this,q)!==x.AnnotationEditorType.NONE,isEmpty:ee(this,_e,ut).call(this),hasSomethingToUndo:u(this,s).hasSomethingToUndo(),hasSomethingToRedo:u(this,s).hasSomethingToRedo(),hasSelectedEditor:!1})):(ee(this,D,Rt).call(this),ee(this,N,yi).call(this),ee(this,_,qe).call(this,{isEditing:!1}))}registerEditorTypes(M){if(!u(this,P)){ve(this,P,M);for(const O of u(this,P))ee(this,k,dt).call(this,O.defaultPropertiesToUpdate)}}getId(){return u(this,J).getId()}get currentLayer(){return u(this,t).get(u(this,m))}get currentPageIndex(){return u(this,m)}addLayer(M){u(this,t).set(M.pageIndex,M),u(this,le)?M.enable():M.disable()}removeLayer(M){u(this,t).delete(M.pageIndex)}updateMode(M){if(ve(this,q,M),M===x.AnnotationEditorType.NONE)this.setEditingState(!1),ee(this,X,Si).call(this);else{this.setEditingState(!0),ee(this,$,Ai).call(this);for(const O of u(this,t).values())O.updateMode(M)}}updateToolbar(M){M!==u(this,q)&&u(this,F).dispatch("switchannotationeditormode",{source:this,mode:M})}updateParams(M,O){if(u(this,P)){for(const j of u(this,re))j.updateParams(M,O);for(const j of u(this,P))j.updateDefaultParams(M,O)}}getEditors(M){const O=[];for(const j of u(this,e).values())j.pageIndex===M&&O.push(j);return O}getEditor(M){return u(this,e).get(M)}addEditor(M){u(this,e).set(M.id,M)}removeEditor(M){var O;u(this,e).delete(M.id),this.unselect(M),(O=u(this,r))==null||O.remove(M.id)}setActiveEditor(M){u(this,p)!==M&&(ve(this,p,M),M&&ee(this,k,dt).call(this,M.propertiesToUpdate))}toggleSelected(M){if(u(this,re).has(M)){u(this,re).delete(M),M.unselect(),ee(this,_,qe).call(this,{hasSelectedEditor:this.hasSelection});return}u(this,re).add(M),M.select(),ee(this,k,dt).call(this,M.propertiesToUpdate),ee(this,_,qe).call(this,{hasSelectedEditor:!0})}setSelected(M){for(const O of u(this,re))O!==M&&O.unselect();u(this,re).clear(),u(this,re).add(M),M.select(),ee(this,k,dt).call(this,M.propertiesToUpdate),ee(this,_,qe).call(this,{hasSelectedEditor:!0})}isSelected(M){return u(this,re).has(M)}unselect(M){M.unselect(),u(this,re).delete(M),ee(this,_,qe).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return u(this,re).size!==0}undo(){u(this,s).undo(),ee(this,_,qe).call(this,{hasSomethingToUndo:u(this,s).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:ee(this,_e,ut).call(this)})}redo(){u(this,s).redo(),ee(this,_,qe).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:u(this,s).hasSomethingToRedo(),isEmpty:ee(this,_e,ut).call(this)})}addCommands(M){u(this,s).add(M),ee(this,_,qe).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:ee(this,_e,ut).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const M=[...u(this,re)],O=d(()=>{for(const be of M)be.remove()},"cmd"),j=d(()=>{for(const be of M)ee(this,pe,kt).call(this,be)},"undo");this.addCommands({cmd:O,undo:j,mustExec:!0})}commitOrRemove(){var M;(M=u(this,p))==null||M.commitOrRemove()}selectAll(){for(const M of u(this,re))M.commit();ee(this,Pe,Lt).call(this,u(this,e).values())}unselectAll(){if(u(this,p)){u(this,p).commitOrRemove();return}if(u(this,re).size!==0){for(const M of u(this,re))M.unselect();u(this,re).clear(),ee(this,_,qe).call(this,{hasSelectedEditor:!1})}}isActive(M){return u(this,p)===M}getActive(){return u(this,p)}getMode(){return u(this,q)}};let w=T;d(w,"AnnotationEditorUIManager"),p=new WeakMap,e=new WeakMap,t=new WeakMap,r=new WeakMap,s=new WeakMap,m=new WeakMap,P=new WeakMap,h=new WeakMap,F=new WeakMap,J=new WeakMap,le=new WeakMap,q=new WeakMap,re=new WeakMap,fe=new WeakMap,K=new WeakMap,me=new WeakMap,Ee=new WeakMap,oe=new WeakMap,W=new WeakMap,A=new WeakMap,v=new WeakMap,R=new WeakMap,z=new WeakMap,H=new WeakSet,bi=d(function(){u(this,z).addEventListener("keydown",u(this,Ee))},"#addKeyboardManager"),D=new WeakSet,Rt=d(function(){u(this,z).removeEventListener("keydown",u(this,Ee))},"#removeKeyboardManager"),te=new WeakSet,vi=d(function(){document.addEventListener("copy",u(this,fe)),document.addEventListener("cut",u(this,K)),document.addEventListener("paste",u(this,me))},"#addCopyPasteListeners"),N=new WeakSet,yi=d(function(){document.removeEventListener("copy",u(this,fe)),document.removeEventListener("cut",u(this,K)),document.removeEventListener("paste",u(this,me))},"#removeCopyPasteListeners"),_=new WeakSet,qe=d(function(M){Object.entries(M).some(([j,be])=>u(this,R)[j]!==be)&&u(this,F).dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(u(this,R),M)})},"#dispatchUpdateStates"),k=new WeakSet,dt=d(function(M){u(this,F).dispatch("annotationeditorparamschanged",{source:this,details:M})},"#dispatchUpdateUI"),$=new WeakSet,Ai=d(function(){if(!u(this,le)){ve(this,le,!0);for(const M of u(this,t).values())M.enable()}},"#enableAll"),X=new WeakSet,Si=d(function(){if(this.unselectAll(),u(this,le)){ve(this,le,!1);for(const M of u(this,t).values())M.disable()}},"#disableAll"),pe=new WeakSet,kt=d(function(M){const O=u(this,t).get(M.pageIndex);O?O.addOrRebuild(M):this.addEditor(M)},"#addEditorToLayer"),_e=new WeakSet,ut=d(function(){if(u(this,e).size===0)return!0;if(u(this,e).size===1)for(const M of u(this,e).values())return M.isEmpty();return!1},"#isEmpty"),Pe=new WeakSet,Lt=d(function(M){u(this,re).clear();for(const O of M)O.isEmpty()||(u(this,re).add(O),O.select());ee(this,_,qe).call(this,{hasSelectedEditor:!0})},"#selectEditors"),Ue(w,"_keyboardManager",new f([[["ctrl+a","mac+meta+a"],T.prototype.selectAll],[["ctrl+z","mac+meta+z"],T.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],T.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],T.prototype.delete],[["Escape","mac+Escape"],T.prototype.unselectAll]])),C.AnnotationEditorUIManager=w},(ae,C,de)=>{var fe,K,me,Ee,oe,W,A,v,R,rt,H,et,D,Ye;Object.defineProperty(C,"__esModule",{value:!0}),C.StatTimer=C.RenderingCancelledException=C.PixelsPerInch=C.PageViewport=C.PDFDateString=C.DOMStandardFontDataFactory=C.DOMSVGFactory=C.DOMFilterFactory=C.DOMCanvasFactory=C.DOMCMapReaderFactory=C.AnnotationPrefix=void 0,C.deprecated=r,C.getColorValues=F,C.getCurrentTransform=J,C.getCurrentTransformInverse=le,C.getFilenameFromUrl=E,C.getPdfFilenameFromUrl=b,C.getRGB=h,C.getXfaPageViewport=P,C.isDataScheme=n,C.isPdfFile=o,C.isValidFetchUrl=e,C.loadScript=t,C.setLayerDimensions=q;var x=de(7),B=de(1);const ue="http://www.w3.org/2000/svg",G="pdfjs_internal_id_";C.AnnotationPrefix=G;const re=class{};let L=re;d(L,"PixelsPerInch"),Ue(L,"CSS",96),Ue(L,"PDF",72),Ue(L,"PDF_TO_CSS_UNITS",re.CSS/re.PDF),C.PixelsPerInch=L;class I extends x.BaseFilterFactory{constructor({docId:N,ownerDocument:a=globalThis.document}={}){super();Z(this,R);Z(this,H);Z(this,D);Z(this,fe,void 0);Z(this,K,void 0);Z(this,me,void 0);Z(this,Ee,void 0);Z(this,oe,void 0);Z(this,W,void 0);Z(this,A,void 0);Z(this,v,0);ve(this,me,N),ve(this,Ee,a)}addFilter(N){if(!N)return"none";let a=u(this,R,rt).get(N);if(a)return a;let _,y,k,U;if(N.length===1){const pe=N[0],ce=new Array(256);for(let _e=0;_e<256;_e++)ce[_e]=pe[_e]/255;U=_=y=k=ce.join(",")}else{const[pe,ce,_e]=N,Se=new Array(256),Pe=new Array(256),Re=new Array(256);for(let T=0;T<256;T++)Se[T]=pe[T]/255,Pe[T]=ce[T]/255,Re[T]=_e[T]/255;_=Se.join(","),y=Pe.join(","),k=Re.join(","),U=`${_}${y}${k}`}if(a=u(this,R,rt).get(U),a)return u(this,R,rt).set(N,a),a;const $=`g_${u(this,me)}_transfer_map_${ht(this,v)._++}`,he=`url(#${$})`;u(this,R,rt).set(N,he),u(this,R,rt).set(U,he);const X=u(this,Ee).createElementNS(ue,"filter",ue);X.setAttribute("id",$),X.setAttribute("color-interpolation-filters","sRGB");const Q=u(this,Ee).createElementNS(ue,"feComponentTransfer");return X.append(Q),ee(this,D,Ye).call(this,Q,"feFuncR",_),ee(this,D,Ye).call(this,Q,"feFuncG",y),ee(this,D,Ye).call(this,Q,"feFuncB",k),u(this,H,et).append(X),he}addHCMFilter(N,a){var _e;const _=`${N}-${a}`;if(u(this,W)===_)return u(this,A);if(ve(this,W,_),ve(this,A,"none"),(_e=u(this,oe))==null||_e.remove(),!N||!a)return u(this,A);u(this,H,et).style.color=N,N=getComputedStyle(u(this,H,et)).getPropertyValue("color");const y=h(N);N=B.Util.makeHexColor(...y),u(this,H,et).style.color=a,a=getComputedStyle(u(this,H,et)).getPropertyValue("color");const k=h(a);if(a=B.Util.makeHexColor(...k),u(this,H,et).style.color="",N==="#000000"&&a==="#ffffff"||N===a)return u(this,A);const U=new Array(256);for(let Se=0;Se<=255;Se++){const Pe=Se/255;U[Se]=Pe<=.03928?Pe/12.92:((Pe+.055)/1.055)**2.4}const $=U.join(","),he=`g_${u(this,me)}_hcm_filter`,X=ve(this,oe,u(this,Ee).createElementNS(ue,"filter",ue));X.setAttribute("id",he),X.setAttribute("color-interpolation-filters","sRGB");let Q=u(this,Ee).createElementNS(ue,"feComponentTransfer");X.append(Q),ee(this,D,Ye).call(this,Q,"feFuncR",$),ee(this,D,Ye).call(this,Q,"feFuncG",$),ee(this,D,Ye).call(this,Q,"feFuncB",$);const pe=u(this,Ee).createElementNS(ue,"feColorMatrix");pe.setAttribute("type","matrix"),pe.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),X.append(pe),Q=u(this,Ee).createElementNS(ue,"feComponentTransfer"),X.append(Q);const ce=d((Se,Pe)=>{const Re=y[Se]/255,T=k[Se]/255,se=new Array(Pe+1);for(let M=0;M<=Pe;M++)se[M]=Re+M/Pe*(T-Re);return se.join(",")},"getSteps");return ee(this,D,Ye).call(this,Q,"feFuncR",ce(0,5)),ee(this,D,Ye).call(this,Q,"feFuncG",ce(1,5)),ee(this,D,Ye).call(this,Q,"feFuncB",ce(2,5)),u(this,H,et).append(X),ve(this,A,`url(#${he})`),u(this,A)}destroy(N=!1){N&&u(this,A)||(u(this,K)&&(u(this,K).parentNode.parentNode.remove(),ve(this,K,null)),u(this,fe)&&(u(this,fe).clear(),ve(this,fe,null)),ve(this,v,0))}}d(I,"DOMFilterFactory"),fe=new WeakMap,K=new WeakMap,me=new WeakMap,Ee=new WeakMap,oe=new WeakMap,W=new WeakMap,A=new WeakMap,v=new WeakMap,R=new WeakSet,rt=d(function(){return u(this,fe)||ve(this,fe,new Map)},"#cache"),H=new WeakSet,et=d(function(){if(!u(this,K)){const N=u(this,Ee).createElement("div"),{style:a}=N;a.visibility="hidden",a.contain="strict",a.width=a.height=0,a.position="absolute",a.top=a.left=0,a.zIndex=-1;const _=u(this,Ee).createElementNS(ue,"svg");_.setAttribute("width",0),_.setAttribute("height",0),ve(this,K,u(this,Ee).createElementNS(ue,"defs")),N.append(_),_.append(u(this,K)),u(this,Ee).body.append(N)}return u(this,K)},"#defs"),D=new WeakSet,Ye=d(function(N,a,_){const y=u(this,Ee).createElementNS(ue,a);y.setAttribute("type","discrete"),y.setAttribute("tableValues",_),N.append(y)},"#appendFeFunc"),C.DOMFilterFactory=I;class f extends x.BaseCanvasFactory{constructor({ownerDocument:V=globalThis.document}={}){super(),this._document=V}_createCanvas(V,N){const a=this._document.createElement("canvas");return a.width=V,a.height=N,a}}d(f,"DOMCanvasFactory"),C.DOMCanvasFactory=f;async function l(te,V=!1){if(e(te,document.baseURI)){const N=await fetch(te);if(!N.ok)throw new Error(N.statusText);return V?new Uint8Array(await N.arrayBuffer()):(0,B.stringToBytes)(await N.text())}return new Promise((N,a)=>{const _=new XMLHttpRequest;_.open("GET",te,!0),V&&(_.responseType="arraybuffer"),_.onreadystatechange=()=>{if(_.readyState===XMLHttpRequest.DONE){if(_.status===200||_.status===0){let y;if(V&&_.response?y=new Uint8Array(_.response):!V&&_.responseText&&(y=(0,B.stringToBytes)(_.responseText)),y){N(y);return}}a(new Error(_.statusText))}},_.send(null)})}d(l,"fetchData");class w extends x.BaseCMapReaderFactory{_fetchData(V,N){return l(V,this.isCompressed).then(a=>({cMapData:a,compressionType:N}))}}d(w,"DOMCMapReaderFactory"),C.DOMCMapReaderFactory=w;class S extends x.BaseStandardFontDataFactory{_fetchData(V){return l(V,!0)}}d(S,"DOMStandardFontDataFactory"),C.DOMStandardFontDataFactory=S;class g extends x.BaseSVGFactory{_createSVG(V){return document.createElementNS(ue,V)}}d(g,"DOMSVGFactory"),C.DOMSVGFactory=g;class i{constructor({viewBox:V,scale:N,rotation:a,offsetX:_=0,offsetY:y=0,dontFlip:k=!1}){this.viewBox=V,this.scale=N,this.rotation=a,this.offsetX=_,this.offsetY=y;const U=(V[2]+V[0])/2,$=(V[3]+V[1])/2;let he,X,Q,pe;switch(a%=360,a<0&&(a+=360),a){case 180:he=-1,X=0,Q=0,pe=1;break;case 90:he=0,X=1,Q=1,pe=0;break;case 270:he=0,X=-1,Q=-1,pe=0;break;case 0:he=1,X=0,Q=0,pe=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}k&&(Q=-Q,pe=-pe);let ce,_e,Se,Pe;he===0?(ce=Math.abs($-V[1])*N+_,_e=Math.abs(U-V[0])*N+y,Se=(V[3]-V[1])*N,Pe=(V[2]-V[0])*N):(ce=Math.abs(U-V[0])*N+_,_e=Math.abs($-V[1])*N+y,Se=(V[2]-V[0])*N,Pe=(V[3]-V[1])*N),this.transform=[he*N,X*N,Q*N,pe*N,ce-he*N*U-Q*N*$,_e-X*N*U-pe*N*$],this.width=Se,this.height=Pe}get rawDims(){const{viewBox:V}=this;return(0,B.shadow)(this,"rawDims",{pageWidth:V[2]-V[0],pageHeight:V[3]-V[1],pageX:V[0],pageY:V[1]})}clone({scale:V=this.scale,rotation:N=this.rotation,offsetX:a=this.offsetX,offsetY:_=this.offsetY,dontFlip:y=!1}={}){return new i({viewBox:this.viewBox.slice(),scale:V,rotation:N,offsetX:a,offsetY:_,dontFlip:y})}convertToViewportPoint(V,N){return B.Util.applyTransform([V,N],this.transform)}convertToViewportRectangle(V){const N=B.Util.applyTransform([V[0],V[1]],this.transform),a=B.Util.applyTransform([V[2],V[3]],this.transform);return[N[0],N[1],a[0],a[1]]}convertToPdfPoint(V,N){return B.Util.applyInverseTransform([V,N],this.transform)}}d(i,"PageViewport"),C.PageViewport=i;class c extends B.BaseException{constructor(V,N,a=0){super(V,"RenderingCancelledException"),this.type=N,this.extraDelay=a}}d(c,"RenderingCancelledException"),C.RenderingCancelledException=c;function n(te){const V=te.length;let N=0;for(;N<V&&te[N].trim()==="";)N++;return te.substring(N,N+5).toLowerCase()==="data:"}d(n,"isDataScheme");function o(te){return typeof te=="string"&&/\.pdf$/i.test(te)}d(o,"isPdfFile");function E(te,V=!1){return V||([te]=te.split(/[#?]/,1)),te.substring(te.lastIndexOf("/")+1)}d(E,"getFilenameFromUrl");function b(te,V="document.pdf"){if(typeof te!="string")return V;if(n(te))return(0,B.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),V;const N=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,a=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,_=N.exec(te);let y=a.exec(_[1])||a.exec(_[2])||a.exec(_[3]);if(y&&(y=y[0],y.includes("%")))try{y=a.exec(decodeURIComponent(y))[0]}catch{}return y||V}d(b,"getPdfFilenameFromUrl");class p{constructor(){Ue(this,"started",Object.create(null));Ue(this,"times",[])}time(V){V in this.started&&(0,B.warn)(`Timer is already running for ${V}`),this.started[V]=Date.now()}timeEnd(V){V in this.started||(0,B.warn)(`Timer has not been started for ${V}`),this.times.push({name:V,start:this.started[V],end:Date.now()}),delete this.started[V]}toString(){const V=[];let N=0;for(const{name:a}of this.times)N=Math.max(a.length,N);for(const{name:a,start:_,end:y}of this.times)V.push(`${a.padEnd(N)} ${y-_}ms
`);return V.join("")}}d(p,"StatTimer"),C.StatTimer=p;function e(te,V){try{const{protocol:N}=V?new URL(te,V):new URL(te);return N==="http:"||N==="https:"}catch{return!1}}d(e,"isValidFetchUrl");function t(te,V=!1){return new Promise((N,a)=>{const _=document.createElement("script");_.src=te,_.onload=function(y){V&&_.remove(),N(y)},_.onerror=function(){a(new Error(`Cannot load script at: ${_.src}`))},(document.head||document.documentElement).append(_)})}d(t,"loadScript");function r(te){console.log("Deprecated API usage: "+te)}d(r,"deprecated");let s;class m{static toDateObject(V){if(!V||typeof V!="string")return null;s||(s=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const N=s.exec(V);if(!N)return null;const a=parseInt(N[1],10);let _=parseInt(N[2],10);_=_>=1&&_<=12?_-1:0;let y=parseInt(N[3],10);y=y>=1&&y<=31?y:1;let k=parseInt(N[4],10);k=k>=0&&k<=23?k:0;let U=parseInt(N[5],10);U=U>=0&&U<=59?U:0;let $=parseInt(N[6],10);$=$>=0&&$<=59?$:0;const he=N[7]||"Z";let X=parseInt(N[8],10);X=X>=0&&X<=23?X:0;let Q=parseInt(N[9],10)||0;return Q=Q>=0&&Q<=59?Q:0,he==="-"?(k+=X,U+=Q):he==="+"&&(k-=X,U-=Q),new Date(Date.UTC(a,_,y,k,U,$))}}d(m,"PDFDateString"),C.PDFDateString=m;function P(te,{scale:V=1,rotation:N=0}){const{width:a,height:_}=te.attributes.style,y=[0,0,parseInt(a),parseInt(_)];return new i({viewBox:y,scale:V,rotation:N})}d(P,"getXfaPageViewport");function h(te){if(te.startsWith("#")){const V=parseInt(te.slice(1),16);return[(V&16711680)>>16,(V&65280)>>8,V&255]}return te.startsWith("rgb(")?te.slice(4,-1).split(",").map(V=>parseInt(V)):te.startsWith("rgba(")?te.slice(5,-1).split(",").map(V=>parseInt(V)).slice(0,3):((0,B.warn)(`Not a valid color format: "${te}"`),[0,0,0])}d(h,"getRGB");function F(te){const V=document.createElement("span");V.style.visibility="hidden",document.body.append(V);for(const N of te.keys()){V.style.color=N;const a=window.getComputedStyle(V).color;te.set(N,h(a))}V.remove()}d(F,"getColorValues");function J(te){const{a:V,b:N,c:a,d:_,e:y,f:k}=te.getTransform();return[V,N,a,_,y,k]}d(J,"getCurrentTransform");function le(te){const{a:V,b:N,c:a,d:_,e:y,f:k}=te.getTransform().invertSelf();return[V,N,a,_,y,k]}d(le,"getCurrentTransformInverse");function q(te,V,N=!1,a=!0){if(V instanceof i){const{pageWidth:_,pageHeight:y}=V.rawDims,{style:k}=te,U=`calc(var(--scale-factor) * ${_}px)`,$=`calc(var(--scale-factor) * ${y}px)`;!N||V.rotation%180===0?(k.width=U,k.height=$):(k.width=$,k.height=U)}a&&te.setAttribute("data-main-rotation",V.rotation)}d(q,"setLayerDimensions")},(ae,C,de)=>{Object.defineProperty(C,"__esModule",{value:!0}),C.BaseStandardFontDataFactory=C.BaseSVGFactory=C.BaseFilterFactory=C.BaseCanvasFactory=C.BaseCMapReaderFactory=void 0;var x=de(1);class B{constructor(){this.constructor===B&&(0,x.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(l){return"none"}addHCMFilter(l,w){return"none"}destroy(l=!1){}}d(B,"BaseFilterFactory"),C.BaseFilterFactory=B;class ue{constructor(){this.constructor===ue&&(0,x.unreachable)("Cannot initialize BaseCanvasFactory.")}create(l,w){if(l<=0||w<=0)throw new Error("Invalid canvas size");const S=this._createCanvas(l,w);return{canvas:S,context:S.getContext("2d")}}reset(l,w,S){if(!l.canvas)throw new Error("Canvas is not specified");if(w<=0||S<=0)throw new Error("Invalid canvas size");l.canvas.width=w,l.canvas.height=S}destroy(l){if(!l.canvas)throw new Error("Canvas is not specified");l.canvas.width=0,l.canvas.height=0,l.canvas=null,l.context=null}_createCanvas(l,w){(0,x.unreachable)("Abstract method `_createCanvas` called.")}}d(ue,"BaseCanvasFactory"),C.BaseCanvasFactory=ue;class G{constructor({baseUrl:l=null,isCompressed:w=!0}){this.constructor===G&&(0,x.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=l,this.isCompressed=w}async fetch({name:l}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!l)throw new Error("CMap name must be specified.");const w=this.baseUrl+l+(this.isCompressed?".bcmap":""),S=this.isCompressed?x.CMapCompressionType.BINARY:x.CMapCompressionType.NONE;return this._fetchData(w,S).catch(g=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${w}`)})}_fetchData(l,w){(0,x.unreachable)("Abstract method `_fetchData` called.")}}d(G,"BaseCMapReaderFactory"),C.BaseCMapReaderFactory=G;class L{constructor({baseUrl:l=null}){this.constructor===L&&(0,x.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=l}async fetch({filename:l}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!l)throw new Error("Font filename must be specified.");const w=`${this.baseUrl}${l}`;return this._fetchData(w).catch(S=>{throw new Error(`Unable to load font data at: ${w}`)})}_fetchData(l){(0,x.unreachable)("Abstract method `_fetchData` called.")}}d(L,"BaseStandardFontDataFactory"),C.BaseStandardFontDataFactory=L;class I{constructor(){this.constructor===I&&(0,x.unreachable)("Cannot initialize BaseSVGFactory.")}create(l,w,S=!1){if(l<=0||w<=0)throw new Error("Invalid SVG dimensions");const g=this._createSVG("svg:svg");return g.setAttribute("version","1.1"),S||(g.setAttribute("width",`${l}px`),g.setAttribute("height",`${w}px`)),g.setAttribute("preserveAspectRatio","none"),g.setAttribute("viewBox",`0 0 ${l} ${w}`),g}createElement(l){if(typeof l!="string")throw new Error("Invalid SVG element type");return this._createSVG(l)}_createSVG(l){(0,x.unreachable)("Abstract method `_createSVG` called.")}}d(I,"BaseSVGFactory"),C.BaseSVGFactory=I},(ae,C,de)=>{Object.defineProperty(C,"__esModule",{value:!0}),C.MurmurHash3_64=void 0;var x=de(1);const B=3285377520,ue=4294901760,G=65535;class L{constructor(f){this.h1=f?f&4294967295:B,this.h2=f?f&4294967295:B}update(f){let l,w;if(typeof f=="string"){l=new Uint8Array(f.length*2),w=0;for(let r=0,s=f.length;r<s;r++){const m=f.charCodeAt(r);m<=255?l[w++]=m:(l[w++]=m>>>8,l[w++]=m&255)}}else if((0,x.isArrayBuffer)(f))l=f.slice(),w=l.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const S=w>>2,g=w-S*4,i=new Uint32Array(l.buffer,0,S);let c=0,n=0,o=this.h1,E=this.h2;const b=3432918353,p=461845907,e=b&G,t=p&G;for(let r=0;r<S;r++)r&1?(c=i[r],c=c*b&ue|c*e&G,c=c<<15|c>>>17,c=c*p&ue|c*t&G,o^=c,o=o<<13|o>>>19,o=o*5+3864292196):(n=i[r],n=n*b&ue|n*e&G,n=n<<15|n>>>17,n=n*p&ue|n*t&G,E^=n,E=E<<13|E>>>19,E=E*5+3864292196);switch(c=0,g){case 3:c^=l[S*4+2]<<16;case 2:c^=l[S*4+1]<<8;case 1:c^=l[S*4],c=c*b&ue|c*e&G,c=c<<15|c>>>17,c=c*p&ue|c*t&G,S&1?o^=c:E^=c}this.h1=o,this.h2=E}hexdigest(){let f=this.h1,l=this.h2;return f^=l>>>1,f=f*3981806797&ue|f*36045&G,l=l*4283543511&ue|((l<<16|f>>>16)*2950163797&ue)>>>16,f^=l>>>1,f=f*444984403&ue|f*60499&G,l=l*3301882366&ue|((l<<16|f>>>16)*3120437893&ue)>>>16,f^=l>>>1,(f>>>0).toString(16).padStart(8,"0")+(l>>>0).toString(16).padStart(8,"0")}}d(L,"MurmurHash3_64"),C.MurmurHash3_64=L},(ae,C,de)=>{Object.defineProperty(C,"__esModule",{value:!0}),C.FontLoader=C.FontFaceObject=void 0;var x=de(1),B=de(10);class ue{constructor({ownerDocument:I=globalThis.document,styleElement:f=null}){this._document=I,this.nativeFontFaces=[],this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(I){this.nativeFontFaces.push(I),this._document.fonts.add(I)}insertRule(I){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const f=this.styleElement.sheet;f.insertRule(I,f.cssRules.length)}clear(){for(const I of this.nativeFontFaces)this._document.fonts.delete(I);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(I){if(I.attached||I.missingFile)return;if(I.attached=!0,this.isFontLoadingAPISupported){const l=I.createNativeFontFace();if(l){this.addNativeFontFace(l);try{await l.loaded}catch(w){throw(0,x.warn)(`Failed to load font '${l.family}': '${w}'.`),I.disableFontFace=!0,w}}return}const f=I.createFontFaceRule();if(f){if(this.insertRule(f),this.isSyncFontLoadingSupported)return;await new Promise(l=>{const w=this._queueLoadingCallback(l);this._prepareFontLoadEvent(I,w)})}}get isFontLoadingAPISupported(){var f;const I=!!((f=this._document)!=null&&f.fonts);return(0,x.shadow)(this,"isFontLoadingAPISupported",I)}get isSyncFontLoadingSupported(){let I=!1;return(B.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(I=!0),(0,x.shadow)(this,"isSyncFontLoadingSupported",I)}_queueLoadingCallback(I){function f(){for((0,x.assert)(!w.done,"completeRequest() cannot be called twice."),w.done=!0;l.length>0&&l[0].done;){const S=l.shift();setTimeout(S.callback,0)}}d(f,"completeRequest");const{loadingRequests:l}=this,w={done:!1,complete:f,callback:I};return l.push(w),w}get _loadTestFont(){const I=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,x.shadow)(this,"_loadTestFont",I)}_prepareFontLoadEvent(I,f){function l(h,F){return h.charCodeAt(F)<<24|h.charCodeAt(F+1)<<16|h.charCodeAt(F+2)<<8|h.charCodeAt(F+3)&255}d(l,"int32");function w(h,F,J,le){const q=h.substring(0,F),re=h.substring(F+J);return q+le+re}d(w,"spliceString");let S,g;const i=this._document.createElement("canvas");i.width=1,i.height=1;const c=i.getContext("2d");let n=0;function o(h,F){if(++n>30){(0,x.warn)("Load test font never loaded."),F();return}if(c.font="30px "+h,c.fillText(".",0,20),c.getImageData(0,0,1,1).data[3]>0){F();return}setTimeout(o.bind(null,h,F))}d(o,"isFontReady");const E=`lt${Date.now()}${this.loadTestFontId++}`;let b=this._loadTestFont;b=w(b,976,E.length,E);const e=16,t=1482184792;let r=l(b,e);for(S=0,g=E.length-3;S<g;S+=4)r=r-t+l(E,S)|0;S<E.length&&(r=r-t+l(E+"XXX",S)|0),b=w(b,e,4,(0,x.string32)(r));const s=`url(data:font/opentype;base64,${btoa(b)});`,m=`@font-face {font-family:"${E}";src:${s}}`;this.insertRule(m);const P=this._document.createElement("div");P.style.visibility="hidden",P.style.width=P.style.height="10px",P.style.position="absolute",P.style.top=P.style.left="0px";for(const h of[I.loadedName,E]){const F=this._document.createElement("span");F.textContent="Hi",F.style.fontFamily=h,P.append(F)}this._document.body.append(P),o(E,()=>{P.remove(),f.complete()})}}d(ue,"FontLoader"),C.FontLoader=ue;class G{constructor(I,{isEvalSupported:f=!0,disableFontFace:l=!1,ignoreErrors:w=!1,inspectFont:S=null}){this.compiledGlyphs=Object.create(null);for(const g in I)this[g]=I[g];this.isEvalSupported=f!==!1,this.disableFontFace=l===!0,this.ignoreErrors=w===!0,this._inspectFont=S}createNativeFontFace(){var f;if(!this.data||this.disableFontFace)return null;let I;if(!this.cssFontInfo)I=new FontFace(this.loadedName,this.data,{});else{const l={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(l.style=`oblique ${this.cssFontInfo.italicAngle}deg`),I=new FontFace(this.cssFontInfo.fontFamily,this.data,l)}return(f=this._inspectFont)==null||f.call(this,this),I}createFontFaceRule(){var w;if(!this.data||this.disableFontFace)return null;const I=(0,x.bytesToString)(this.data),f=`url(data:${this.mimetype};base64,${btoa(I)});`;let l;if(!this.cssFontInfo)l=`@font-face {font-family:"${this.loadedName}";src:${f}}`;else{let S=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(S+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),l=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${S}src:${f}}`}return(w=this._inspectFont)==null||w.call(this,this,f),l}getPathGenerator(I,f){if(this.compiledGlyphs[f]!==void 0)return this.compiledGlyphs[f];let l;try{l=I.get(this.loadedName+"_path_"+f)}catch(w){if(!this.ignoreErrors)throw w;return(0,x.warn)(`getPathGenerator - ignoring character: "${w}".`),this.compiledGlyphs[f]=function(S,g){}}if(this.isEvalSupported&&x.FeatureTest.isEvalSupported){const w=[];for(const S of l){const g=S.args!==void 0?S.args.join(","):"";w.push("c.",S.cmd,"(",g,`);
`)}return this.compiledGlyphs[f]=new Function("c","size",w.join(""))}return this.compiledGlyphs[f]=function(w,S){for(const g of l)g.cmd==="scale"&&(g.args=[S,-S]),w[g.cmd].apply(w,g.args)}}}d(G,"FontFaceObject"),C.FontFaceObject=G},(ae,C)=>{Object.defineProperty(C,"__esModule",{value:!0}),C.isNodeJS=void 0;const de=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");C.isNodeJS=de},(ae,C,de)=>{var me,It;Object.defineProperty(C,"__esModule",{value:!0}),C.CanvasGraphics=void 0;var x=de(1),B=de(6),ue=de(12),G=de(13),L=de(10);const I=16,f=100,l=4096,w=15,S=10,g=1e3,i=16;function c(W,A){if(W._removeMirroring)throw new Error("Context is already forwarding operations.");W.__originalSave=W.save,W.__originalRestore=W.restore,W.__originalRotate=W.rotate,W.__originalScale=W.scale,W.__originalTranslate=W.translate,W.__originalTransform=W.transform,W.__originalSetTransform=W.setTransform,W.__originalResetTransform=W.resetTransform,W.__originalClip=W.clip,W.__originalMoveTo=W.moveTo,W.__originalLineTo=W.lineTo,W.__originalBezierCurveTo=W.bezierCurveTo,W.__originalRect=W.rect,W.__originalClosePath=W.closePath,W.__originalBeginPath=W.beginPath,W._removeMirroring=()=>{W.save=W.__originalSave,W.restore=W.__originalRestore,W.rotate=W.__originalRotate,W.scale=W.__originalScale,W.translate=W.__originalTranslate,W.transform=W.__originalTransform,W.setTransform=W.__originalSetTransform,W.resetTransform=W.__originalResetTransform,W.clip=W.__originalClip,W.moveTo=W.__originalMoveTo,W.lineTo=W.__originalLineTo,W.bezierCurveTo=W.__originalBezierCurveTo,W.rect=W.__originalRect,W.closePath=W.__originalClosePath,W.beginPath=W.__originalBeginPath,delete W._removeMirroring},W.save=d(function(){A.save(),this.__originalSave()},"ctxSave"),W.restore=d(function(){A.restore(),this.__originalRestore()},"ctxRestore"),W.translate=d(function(R,z){A.translate(R,z),this.__originalTranslate(R,z)},"ctxTranslate"),W.scale=d(function(R,z){A.scale(R,z),this.__originalScale(R,z)},"ctxScale"),W.transform=d(function(R,z,H,ne,D,Y){A.transform(R,z,H,ne,D,Y),this.__originalTransform(R,z,H,ne,D,Y)},"ctxTransform"),W.setTransform=d(function(R,z,H,ne,D,Y){A.setTransform(R,z,H,ne,D,Y),this.__originalSetTransform(R,z,H,ne,D,Y)},"ctxSetTransform"),W.resetTransform=d(function(){A.resetTransform(),this.__originalResetTransform()},"ctxResetTransform"),W.rotate=d(function(R){A.rotate(R),this.__originalRotate(R)},"ctxRotate"),W.clip=d(function(R){A.clip(R),this.__originalClip(R)},"ctxRotate"),W.moveTo=function(v,R){A.moveTo(v,R),this.__originalMoveTo(v,R)},W.lineTo=function(v,R){A.lineTo(v,R),this.__originalLineTo(v,R)},W.bezierCurveTo=function(v,R,z,H,ne,D){A.bezierCurveTo(v,R,z,H,ne,D),this.__originalBezierCurveTo(v,R,z,H,ne,D)},W.rect=function(v,R,z,H){A.rect(v,R,z,H),this.__originalRect(v,R,z,H)},W.closePath=function(){A.closePath(),this.__originalClosePath()},W.beginPath=function(){A.beginPath(),this.__originalBeginPath()}}d(c,"mirrorContextOperations");class n{constructor(A){this.canvasFactory=A,this.cache=Object.create(null)}getCanvas(A,v,R){let z;return this.cache[A]!==void 0?(z=this.cache[A],this.canvasFactory.reset(z,v,R)):(z=this.canvasFactory.create(v,R),this.cache[A]=z),z}delete(A){delete this.cache[A]}clear(){for(const A in this.cache){const v=this.cache[A];this.canvasFactory.destroy(v),delete this.cache[A]}}}d(n,"CachedCanvases");function o(W,A,v,R,z,H,ne,D,Y,te){const[V,N,a,_,y,k]=(0,B.getCurrentTransform)(W);if(N===0&&a===0){const he=ne*V+y,X=Math.round(he),Q=D*_+k,pe=Math.round(Q),ce=(ne+Y)*V+y,_e=Math.abs(Math.round(ce)-X)||1,Se=(D+te)*_+k,Pe=Math.abs(Math.round(Se)-pe)||1;return W.setTransform(Math.sign(V),0,0,Math.sign(_),X,pe),W.drawImage(A,v,R,z,H,0,0,_e,Pe),W.setTransform(V,N,a,_,y,k),[_e,Pe]}if(V===0&&_===0){const he=D*a+y,X=Math.round(he),Q=ne*N+k,pe=Math.round(Q),ce=(D+te)*a+y,_e=Math.abs(Math.round(ce)-X)||1,Se=(ne+Y)*N+k,Pe=Math.abs(Math.round(Se)-pe)||1;return W.setTransform(0,Math.sign(N),Math.sign(a),0,X,pe),W.drawImage(A,v,R,z,H,0,0,Pe,_e),W.setTransform(V,N,a,_,y,k),[Pe,_e]}W.drawImage(A,v,R,z,H,ne,D,Y,te);const U=Math.hypot(V,N),$=Math.hypot(a,_);return[U*Y,$*te]}d(o,"drawImageAtIntegerCoords");function E(W){const{width:A,height:v}=W;if(A>g||v>g)return null;const R=1e3,z=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),H=A+1;let ne=new Uint8Array(H*(v+1)),D,Y,te;const V=A+7&-8;let N=new Uint8Array(V*v),a=0;for(const $ of W.data){let he=128;for(;he>0;)N[a++]=$&he?0:255,he>>=1}let _=0;for(a=0,N[a]!==0&&(ne[0]=1,++_),Y=1;Y<A;Y++)N[a]!==N[a+1]&&(ne[Y]=N[a]?2:1,++_),a++;for(N[a]!==0&&(ne[Y]=2,++_),D=1;D<v;D++){a=D*V,te=D*H,N[a-V]!==N[a]&&(ne[te]=N[a]?1:8,++_);let $=(N[a]?4:0)+(N[a-V]?8:0);for(Y=1;Y<A;Y++)$=($>>2)+(N[a+1]?4:0)+(N[a-V+1]?8:0),z[$]&&(ne[te+Y]=z[$],++_),a++;if(N[a-V]!==N[a]&&(ne[te+Y]=N[a]?2:4,++_),_>R)return null}for(a=V*(v-1),te=D*H,N[a]!==0&&(ne[te]=8,++_),Y=1;Y<A;Y++)N[a]!==N[a+1]&&(ne[te+Y]=N[a]?4:8,++_),a++;if(N[a]!==0&&(ne[te+Y]=4,++_),_>R)return null;const y=new Int32Array([0,H,-1,0,-H,0,0,0,1]),k=new Path2D;for(D=0;_&&D<=v;D++){let $=D*H;const he=$+A;for(;$<he&&!ne[$];)$++;if($===he)continue;k.moveTo($%H,D);const X=$;let Q=ne[$];do{const pe=y[Q];do $+=pe;while(!ne[$]);const ce=ne[$];ce!==5&&ce!==10?(Q=ce,ne[$]=0):(Q=ce&51*Q>>4,ne[$]&=Q>>2|Q<<2),k.lineTo($%H,$/H|0),ne[$]||--_}while(X!==$);--D}return N=null,ne=null,d(function($){$.save(),$.scale(1/A,-1/v),$.translate(0,-v),$.fill(k),$.beginPath(),$.restore()},"drawOutline")}d(E,"compileType3Glyph");class b{constructor(A,v){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=x.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=x.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=x.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,A,v])}clone(){const A=Object.create(this);return A.clipBox=this.clipBox.slice(),A}setCurrentPoint(A,v){this.x=A,this.y=v}updatePathMinMax(A,v,R){[v,R]=x.Util.applyTransform([v,R],A),this.minX=Math.min(this.minX,v),this.minY=Math.min(this.minY,R),this.maxX=Math.max(this.maxX,v),this.maxY=Math.max(this.maxY,R)}updateRectMinMax(A,v){const R=x.Util.applyTransform(v,A),z=x.Util.applyTransform(v.slice(2),A);this.minX=Math.min(this.minX,R[0],z[0]),this.minY=Math.min(this.minY,R[1],z[1]),this.maxX=Math.max(this.maxX,R[0],z[0]),this.maxY=Math.max(this.maxY,R[1],z[1])}updateScalingPathMinMax(A,v){x.Util.scaleMinMax(A,v),this.minX=Math.min(this.minX,v[0]),this.maxX=Math.max(this.maxX,v[1]),this.minY=Math.min(this.minY,v[2]),this.maxY=Math.max(this.maxY,v[3])}updateCurvePathMinMax(A,v,R,z,H,ne,D,Y,te,V){const N=x.Util.bezierBoundingBox(v,R,z,H,ne,D,Y,te);if(V){V[0]=Math.min(V[0],N[0],N[2]),V[1]=Math.max(V[1],N[0],N[2]),V[2]=Math.min(V[2],N[1],N[3]),V[3]=Math.max(V[3],N[1],N[3]);return}this.updateRectMinMax(A,N)}getPathBoundingBox(A=ue.PathType.FILL,v=null){const R=[this.minX,this.minY,this.maxX,this.maxY];if(A===ue.PathType.STROKE){v||(0,x.unreachable)("Stroke bounding box must include transform.");const z=x.Util.singularValueDecompose2dScale(v),H=z[0]*this.lineWidth/2,ne=z[1]*this.lineWidth/2;R[0]-=H,R[1]-=ne,R[2]+=H,R[3]+=ne}return R}updateClipFromPath(){const A=x.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(A||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(A){this.clipBox=A,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(A=ue.PathType.FILL,v=null){return x.Util.intersect(this.clipBox,this.getPathBoundingBox(A,v))}}d(b,"CanvasExtraState");function p(W,A){if(typeof ImageData<"u"&&A instanceof ImageData){W.putImageData(A,0,0);return}const v=A.height,R=A.width,z=v%i,H=(v-z)/i,ne=z===0?H:H+1,D=W.createImageData(R,i);let Y=0,te;const V=A.data,N=D.data;let a,_,y,k;if(A.kind===x.ImageKind.GRAYSCALE_1BPP){const U=V.byteLength,$=new Uint32Array(N.buffer,0,N.byteLength>>2),he=$.length,X=R+7>>3,Q=4294967295,pe=x.FeatureTest.isLittleEndian?4278190080:255;for(a=0;a<ne;a++){for(y=a<H?i:z,te=0,_=0;_<y;_++){const ce=U-Y;let _e=0;const Se=ce>X?R:ce*8-7,Pe=Se&-8;let Re=0,T=0;for(;_e<Pe;_e+=8)T=V[Y++],$[te++]=T&128?Q:pe,$[te++]=T&64?Q:pe,$[te++]=T&32?Q:pe,$[te++]=T&16?Q:pe,$[te++]=T&8?Q:pe,$[te++]=T&4?Q:pe,$[te++]=T&2?Q:pe,$[te++]=T&1?Q:pe;for(;_e<Se;_e++)Re===0&&(T=V[Y++],Re=128),$[te++]=T&Re?Q:pe,Re>>=1}for(;te<he;)$[te++]=0;W.putImageData(D,0,a*i)}}else if(A.kind===x.ImageKind.RGBA_32BPP){for(_=0,k=R*i*4,a=0;a<H;a++)N.set(V.subarray(Y,Y+k)),Y+=k,W.putImageData(D,0,_),_+=i;a<ne&&(k=R*z*4,N.set(V.subarray(Y,Y+k)),W.putImageData(D,0,_))}else if(A.kind===x.ImageKind.RGB_24BPP)for(y=i,k=R*y,a=0;a<ne;a++){for(a>=H&&(y=z,k=R*y),te=0,_=k;_--;)N[te++]=V[Y++],N[te++]=V[Y++],N[te++]=V[Y++],N[te++]=255;W.putImageData(D,0,a*i)}else throw new Error(`bad image kind: ${A.kind}`)}d(p,"putBinaryImageData");function e(W,A){if(A.bitmap){W.drawImage(A.bitmap,0,0);return}const v=A.height,R=A.width,z=v%i,H=(v-z)/i,ne=z===0?H:H+1,D=W.createImageData(R,i);let Y=0;const te=A.data,V=D.data;for(let N=0;N<ne;N++){const a=N<H?i:z;({srcPos:Y}=(0,G.convertBlackAndWhiteToRGBA)({src:te,srcPos:Y,dest:V,width:R,height:a,nonBlackColor:0})),W.putImageData(D,0,N*i)}}d(e,"putBinaryImageMask");function t(W,A){const v=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const R of v)W[R]!==void 0&&(A[R]=W[R]);W.setLineDash!==void 0&&(A.setLineDash(W.getLineDash()),A.lineDashOffset=W.lineDashOffset)}d(t,"copyCtxState");function r(W){W.strokeStyle=W.fillStyle="#000000",W.fillRule="nonzero",W.globalAlpha=1,W.lineWidth=1,W.lineCap="butt",W.lineJoin="miter",W.miterLimit=10,W.globalCompositeOperation="source-over",W.font="10px sans-serif",W.setLineDash!==void 0&&(W.setLineDash([]),W.lineDashOffset=0),L.isNodeJS||(W.filter="none")}d(r,"resetCtxToDefault");function s(W,A,v,R){const z=W.length;for(let H=3;H<z;H+=4){const ne=W[H];if(ne===0)W[H-3]=A,W[H-2]=v,W[H-1]=R;else if(ne<255){const D=255-ne;W[H-3]=W[H-3]*ne+A*D>>8,W[H-2]=W[H-2]*ne+v*D>>8,W[H-1]=W[H-1]*ne+R*D>>8}}}d(s,"composeSMaskBackdrop");function m(W,A,v){const R=W.length,z=1/255;for(let H=3;H<R;H+=4){const ne=v?v[W[H]]:W[H];A[H]=A[H]*ne*z|0}}d(m,"composeSMaskAlpha");function P(W,A,v){const R=W.length;for(let z=3;z<R;z+=4){const H=W[z-3]*77+W[z-2]*152+W[z-1]*28;A[z]=v?A[z]*v[H>>8]>>8:A[z]*H>>16}}d(P,"composeSMaskLuminosity");function h(W,A,v,R,z,H,ne,D,Y,te,V){const N=!!H,a=N?H[0]:0,_=N?H[1]:0,y=N?H[2]:0;let k;z==="Luminosity"?k=P:k=m;const $=Math.min(R,Math.ceil(1048576/v));for(let he=0;he<R;he+=$){const X=Math.min($,R-he),Q=W.getImageData(D-te,he+(Y-V),v,X),pe=A.getImageData(D,he+Y,v,X);N&&s(Q.data,a,_,y),k(Q.data,pe.data,ne),A.putImageData(pe,D,he+Y)}}d(h,"genericComposeSMask");function F(W,A,v,R){const z=R[0],H=R[1],ne=R[2]-z,D=R[3]-H;ne===0||D===0||(h(A.context,v,ne,D,A.subtype,A.backdrop,A.transferMap,z,H,A.offsetX,A.offsetY),W.save(),W.globalAlpha=1,W.globalCompositeOperation="source-over",W.setTransform(1,0,0,1,0,0),W.drawImage(v.canvas,0,0),W.restore())}d(F,"composeSMask");function J(W,A){const v=x.Util.singularValueDecompose2dScale(W);v[0]=Math.fround(v[0]),v[1]=Math.fround(v[1]);const R=Math.fround((globalThis.devicePixelRatio||1)*B.PixelsPerInch.PDF_TO_CSS_UNITS);return A!==void 0?A:v[0]<=R||v[1]<=R}d(J,"getImageSmoothingEnabled");const le=["butt","round","square"],q=["miter","round","bevel"],re={},fe={},oe=class{constructor(A,v,R,z,H,{optionalContentConfig:ne,markedContentStack:D=null},Y){Z(this,me);this.ctx=A,this.current=new b(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=v,this.objs=R,this.canvasFactory=z,this.filterFactory=H,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=D||[],this.optionalContentConfig=ne,this.cachedCanvases=new n(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=Y,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(A,v=null){return typeof A=="string"?A.startsWith("g_")?this.commonObjs.get(A):this.objs.get(A):v}beginDrawing({transform:A,viewport:v,transparency:R=!1,background:z=null}){const H=this.ctx.canvas.width,ne=this.ctx.canvas.height,D=this.ctx.fillStyle;if(this.ctx.fillStyle=z||"#ffffff",this.ctx.fillRect(0,0,H,ne),this.ctx.fillStyle=D,R){const Y=this.cachedCanvases.getCanvas("transparent",H,ne);this.compositeCtx=this.ctx,this.transparentCanvas=Y.canvas,this.ctx=Y.context,this.ctx.save(),this.ctx.transform(...(0,B.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),r(this.ctx),A&&(this.ctx.transform(...A),this.outputScaleX=A[0],this.outputScaleY=A[0]),this.ctx.transform(...v.transform),this.viewportScale=v.scale,this.baseTransform=(0,B.getCurrentTransform)(this.ctx)}executeOperatorList(A,v,R,z){const H=A.argsArray,ne=A.fnArray;let D=v||0;const Y=H.length;if(Y===D)return D;const te=Y-D>S&&typeof R=="function",V=te?Date.now()+w:0;let N=0;const a=this.commonObjs,_=this.objs;let y;for(;;){if(z!==void 0&&D===z.nextBreakPoint)return z.breakIt(D,R),D;if(y=ne[D],y!==x.OPS.dependency)this[y].apply(this,H[D]);else for(const k of H[D]){const U=k.startsWith("g_")?a:_;if(!U.has(k))return U.get(k,R),D}if(D++,D===Y)return D;if(te&&++N>S){if(Date.now()>V)return R(),D;N=0}}}endDrawing(A=null){ee(this,me,It).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const v of this._cachedBitmapsMap.values()){for(const R of v.values())typeof HTMLCanvasElement<"u"&&R instanceof HTMLCanvasElement&&(R.width=R.height=0);v.clear()}if(this._cachedBitmapsMap.clear(),A){const v=this.filterFactory.addHCMFilter(A.foreground,A.background);if(v!=="none"){const R=this.ctx.filter;this.ctx.filter=v,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=R}}}_scaleImage(A,v){const R=A.width,z=A.height;let H=Math.max(Math.hypot(v[0],v[1]),1),ne=Math.max(Math.hypot(v[2],v[3]),1),D=R,Y=z,te="prescale1",V,N;for(;H>2&&D>1||ne>2&&Y>1;){let a=D,_=Y;H>2&&D>1&&(a=D>=16384?Math.floor(D/2)-1||1:Math.ceil(D/2),H/=D/a),ne>2&&Y>1&&(_=Y>=16384?Math.floor(Y/2)-1||1:Math.ceil(Y)/2,ne/=Y/_),V=this.cachedCanvases.getCanvas(te,a,_),N=V.context,N.clearRect(0,0,a,_),N.drawImage(A,0,0,D,Y,0,0,a,_),A=V.canvas,D=a,Y=_,te=te==="prescale1"?"prescale2":"prescale1"}return{img:A,paintWidth:D,paintHeight:Y}}_createMaskCanvas(A){const v=this.ctx,{width:R,height:z}=A,H=this.current.fillColor,ne=this.current.patternFill,D=(0,B.getCurrentTransform)(v);let Y,te,V,N;if((A.bitmap||A.data)&&A.count>1){const _e=A.bitmap||A.data.buffer;te=JSON.stringify(ne?D:[D.slice(0,4),H]),Y=this._cachedBitmapsMap.get(_e),Y||(Y=new Map,this._cachedBitmapsMap.set(_e,Y));const Se=Y.get(te);if(Se&&!ne){const Pe=Math.round(Math.min(D[0],D[2])+D[4]),Re=Math.round(Math.min(D[1],D[3])+D[5]);return{canvas:Se,offsetX:Pe,offsetY:Re}}V=Se}V||(N=this.cachedCanvases.getCanvas("maskCanvas",R,z),e(N.context,A));let a=x.Util.transform(D,[1/R,0,0,-1/z,0,0]);a=x.Util.transform(a,[1,0,0,1,0,-z]);const _=x.Util.applyTransform([0,0],a),y=x.Util.applyTransform([R,z],a),k=x.Util.normalizeRect([_[0],_[1],y[0],y[1]]),U=Math.round(k[2]-k[0])||1,$=Math.round(k[3]-k[1])||1,he=this.cachedCanvases.getCanvas("fillCanvas",U,$),X=he.context,Q=Math.min(_[0],y[0]),pe=Math.min(_[1],y[1]);X.translate(-Q,-pe),X.transform(...a),V||(V=this._scaleImage(N.canvas,(0,B.getCurrentTransformInverse)(X)),V=V.img,Y&&ne&&Y.set(te,V)),X.imageSmoothingEnabled=J((0,B.getCurrentTransform)(X),A.interpolate),o(X,V,0,0,V.width,V.height,0,0,R,z),X.globalCompositeOperation="source-in";const ce=x.Util.transform((0,B.getCurrentTransformInverse)(X),[1,0,0,1,-Q,-pe]);return X.fillStyle=ne?H.getPattern(v,this,ce,ue.PathType.FILL):H,X.fillRect(0,0,R,z),Y&&!ne&&(this.cachedCanvases.delete("fillCanvas"),Y.set(te,he.canvas)),{canvas:he.canvas,offsetX:Math.round(Q),offsetY:Math.round(pe)}}setLineWidth(A){A!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=A,this.ctx.lineWidth=A}setLineCap(A){this.ctx.lineCap=le[A]}setLineJoin(A){this.ctx.lineJoin=q[A]}setMiterLimit(A){this.ctx.miterLimit=A}setDash(A,v){const R=this.ctx;R.setLineDash!==void 0&&(R.setLineDash(A),R.lineDashOffset=v)}setRenderingIntent(A){}setFlatness(A){}setGState(A){for(const[v,R]of A)switch(v){case"LW":this.setLineWidth(R);break;case"LC":this.setLineCap(R);break;case"LJ":this.setLineJoin(R);break;case"ML":this.setMiterLimit(R);break;case"D":this.setDash(R[0],R[1]);break;case"RI":this.setRenderingIntent(R);break;case"FL":this.setFlatness(R);break;case"Font":this.setFont(R[0],R[1]);break;case"CA":this.current.strokeAlpha=R;break;case"ca":this.current.fillAlpha=R,this.ctx.globalAlpha=R;break;case"BM":this.ctx.globalCompositeOperation=R;break;case"SMask":this.current.activeSMask=R?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(R);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const A=this.inSMaskMode;this.current.activeSMask&&!A?this.beginSMaskMode():!this.current.activeSMask&&A&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const A=this.ctx.canvas.width,v=this.ctx.canvas.height,R="smaskGroupAt"+this.groupLevel,z=this.cachedCanvases.getCanvas(R,A,v);this.suspendedCtx=this.ctx,this.ctx=z.context;const H=this.ctx;H.setTransform(...(0,B.getCurrentTransform)(this.suspendedCtx)),t(this.suspendedCtx,H),c(H,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),t(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(A){if(!this.current.activeSMask)return;A?(A[0]=Math.floor(A[0]),A[1]=Math.floor(A[1]),A[2]=Math.ceil(A[2]),A[3]=Math.ceil(A[3])):A=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const v=this.current.activeSMask,R=this.suspendedCtx;F(R,v,this.ctx,A),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(t(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const A=this.current;this.stateStack.push(A),this.current=A.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),t(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(A,v,R,z,H,ne){this.ctx.transform(A,v,R,z,H,ne),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(A,v,R){const z=this.ctx,H=this.current;let ne=H.x,D=H.y,Y,te;const V=(0,B.getCurrentTransform)(z),N=V[0]===0&&V[3]===0||V[1]===0&&V[2]===0,a=N?R.slice(0):null;for(let _=0,y=0,k=A.length;_<k;_++)switch(A[_]|0){case x.OPS.rectangle:ne=v[y++],D=v[y++];const U=v[y++],$=v[y++],he=ne+U,X=D+$;z.moveTo(ne,D),U===0||$===0?z.lineTo(he,X):(z.lineTo(he,D),z.lineTo(he,X),z.lineTo(ne,X)),N||H.updateRectMinMax(V,[ne,D,he,X]),z.closePath();break;case x.OPS.moveTo:ne=v[y++],D=v[y++],z.moveTo(ne,D),N||H.updatePathMinMax(V,ne,D);break;case x.OPS.lineTo:ne=v[y++],D=v[y++],z.lineTo(ne,D),N||H.updatePathMinMax(V,ne,D);break;case x.OPS.curveTo:Y=ne,te=D,ne=v[y+4],D=v[y+5],z.bezierCurveTo(v[y],v[y+1],v[y+2],v[y+3],ne,D),H.updateCurvePathMinMax(V,Y,te,v[y],v[y+1],v[y+2],v[y+3],ne,D,a),y+=6;break;case x.OPS.curveTo2:Y=ne,te=D,z.bezierCurveTo(ne,D,v[y],v[y+1],v[y+2],v[y+3]),H.updateCurvePathMinMax(V,Y,te,ne,D,v[y],v[y+1],v[y+2],v[y+3],a),ne=v[y+2],D=v[y+3],y+=4;break;case x.OPS.curveTo3:Y=ne,te=D,ne=v[y+2],D=v[y+3],z.bezierCurveTo(v[y],v[y+1],ne,D,ne,D),H.updateCurvePathMinMax(V,Y,te,v[y],v[y+1],ne,D,ne,D,a),y+=4;break;case x.OPS.closePath:z.closePath();break}N&&H.updateScalingPathMinMax(V,a),H.setCurrentPoint(ne,D)}closePath(){this.ctx.closePath()}stroke(A=!0){const v=this.ctx,R=this.current.strokeColor;v.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof R=="object"&&(R!=null&&R.getPattern)?(v.save(),v.strokeStyle=R.getPattern(v,this,(0,B.getCurrentTransformInverse)(v),ue.PathType.STROKE),this.rescaleAndStroke(!1),v.restore()):this.rescaleAndStroke(!0)),A&&this.consumePath(this.current.getClippedPathBoundingBox()),v.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(A=!0){const v=this.ctx,R=this.current.fillColor,z=this.current.patternFill;let H=!1;z&&(v.save(),v.fillStyle=R.getPattern(v,this,(0,B.getCurrentTransformInverse)(v),ue.PathType.FILL),H=!0);const ne=this.current.getClippedPathBoundingBox();this.contentVisible&&ne!==null&&(this.pendingEOFill?(v.fill("evenodd"),this.pendingEOFill=!1):v.fill()),H&&v.restore(),A&&this.consumePath(ne)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=re}eoClip(){this.pendingClip=fe}beginText(){this.current.textMatrix=x.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const A=this.pendingTextPaths,v=this.ctx;if(A===void 0){v.beginPath();return}v.save(),v.beginPath();for(const R of A)v.setTransform(...R.transform),v.translate(R.x,R.y),R.addToPath(v,R.fontSize);v.restore(),v.clip(),v.beginPath(),delete this.pendingTextPaths}setCharSpacing(A){this.current.charSpacing=A}setWordSpacing(A){this.current.wordSpacing=A}setHScale(A){this.current.textHScale=A/100}setLeading(A){this.current.leading=-A}setFont(A,v){const R=this.commonObjs.get(A),z=this.current;if(!R)throw new Error(`Can't find font for ${A}`);if(z.fontMatrix=R.fontMatrix||x.FONT_IDENTITY_MATRIX,(z.fontMatrix[0]===0||z.fontMatrix[3]===0)&&(0,x.warn)("Invalid font matrix for font "+A),v<0?(v=-v,z.fontDirection=-1):z.fontDirection=1,this.current.font=R,this.current.fontSize=v,R.isType3Font)return;const H=R.loadedName||"sans-serif";let ne="normal";R.black?ne="900":R.bold&&(ne="bold");const D=R.italic?"italic":"normal",Y=`"${H}", ${R.fallbackName}`;let te=v;v<I?te=I:v>f&&(te=f),this.current.fontSizeScale=v/te,this.ctx.font=`${D} ${ne} ${te}px ${Y}`}setTextRenderingMode(A){this.current.textRenderingMode=A}setTextRise(A){this.current.textRise=A}moveText(A,v){this.current.x=this.current.lineX+=A,this.current.y=this.current.lineY+=v}setLeadingMoveText(A,v){this.setLeading(-v),this.moveText(A,v)}setTextMatrix(A,v,R,z,H,ne){this.current.textMatrix=[A,v,R,z,H,ne],this.current.textMatrixScale=Math.hypot(A,v),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(A,v,R,z){const H=this.ctx,ne=this.current,D=ne.font,Y=ne.textRenderingMode,te=ne.fontSize/ne.fontSizeScale,V=Y&x.TextRenderingMode.FILL_STROKE_MASK,N=!!(Y&x.TextRenderingMode.ADD_TO_PATH_FLAG),a=ne.patternFill&&!D.missingFile;let _;(D.disableFontFace||N||a)&&(_=D.getPathGenerator(this.commonObjs,A)),D.disableFontFace||a?(H.save(),H.translate(v,R),H.beginPath(),_(H,te),z&&H.setTransform(...z),(V===x.TextRenderingMode.FILL||V===x.TextRenderingMode.FILL_STROKE)&&H.fill(),(V===x.TextRenderingMode.STROKE||V===x.TextRenderingMode.FILL_STROKE)&&H.stroke(),H.restore()):((V===x.TextRenderingMode.FILL||V===x.TextRenderingMode.FILL_STROKE)&&H.fillText(A,v,R),(V===x.TextRenderingMode.STROKE||V===x.TextRenderingMode.FILL_STROKE)&&H.strokeText(A,v,R)),N&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,B.getCurrentTransform)(H),x:v,y:R,fontSize:te,addToPath:_})}get isFontSubpixelAAEnabled(){const{context:A}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);A.scale(1.5,1),A.fillText("I",0,10);const v=A.getImageData(0,0,10,10).data;let R=!1;for(let z=3;z<v.length;z+=4)if(v[z]>0&&v[z]<255){R=!0;break}return(0,x.shadow)(this,"isFontSubpixelAAEnabled",R)}showText(A){const v=this.current,R=v.font;if(R.isType3Font)return this.showType3Text(A);const z=v.fontSize;if(z===0)return;const H=this.ctx,ne=v.fontSizeScale,D=v.charSpacing,Y=v.wordSpacing,te=v.fontDirection,V=v.textHScale*te,N=A.length,a=R.vertical,_=a?1:-1,y=R.defaultVMetrics,k=z*v.fontMatrix[0],U=v.textRenderingMode===x.TextRenderingMode.FILL&&!R.disableFontFace&&!v.patternFill;H.save(),H.transform(...v.textMatrix),H.translate(v.x,v.y+v.textRise),te>0?H.scale(V,-1):H.scale(V,1);let $;if(v.patternFill){H.save();const ce=v.fillColor.getPattern(H,this,(0,B.getCurrentTransformInverse)(H),ue.PathType.FILL);$=(0,B.getCurrentTransform)(H),H.restore(),H.fillStyle=ce}let he=v.lineWidth;const X=v.textMatrixScale;if(X===0||he===0){const ce=v.textRenderingMode&x.TextRenderingMode.FILL_STROKE_MASK;(ce===x.TextRenderingMode.STROKE||ce===x.TextRenderingMode.FILL_STROKE)&&(he=this.getSinglePixelWidth())}else he/=X;if(ne!==1&&(H.scale(ne,ne),he/=ne),H.lineWidth=he,R.isInvalidPDFjsFont){const ce=[];let _e=0;for(const Se of A)ce.push(Se.unicode),_e+=Se.width;H.fillText(ce.join(""),0,0),v.x+=_e*k*V,H.restore(),this.compose();return}let Q=0,pe;for(pe=0;pe<N;++pe){const ce=A[pe];if(typeof ce=="number"){Q+=_*ce*z/1e3;continue}let _e=!1;const Se=(ce.isSpace?Y:0)+D,Pe=ce.fontChar,Re=ce.accent;let T,se,M=ce.width;if(a){const j=ce.vmetric||y,be=-(ce.vmetric?j[1]:M*.5)*k,Te=j[2]*k;M=j?-j[0]:M,T=be/ne,se=(Q+Te)/ne}else T=Q/ne,se=0;if(R.remeasure&&M>0){const j=H.measureText(Pe).width*1e3/z*ne;if(M<j&&this.isFontSubpixelAAEnabled){const be=M/j;_e=!0,H.save(),H.scale(be,1),T/=be}else M!==j&&(T+=(M-j)/2e3*z/ne)}if(this.contentVisible&&(ce.isInFont||R.missingFile)){if(U&&!Re)H.fillText(Pe,T,se);else if(this.paintChar(Pe,T,se,$),Re){const j=T+z*Re.offset.x/ne,be=se-z*Re.offset.y/ne;this.paintChar(Re.fontChar,j,be,$)}}let O;a?O=M*k-Se*te:O=M*k+Se*te,Q+=O,_e&&H.restore()}a?v.y-=Q:v.x+=Q*V,H.restore(),this.compose()}showType3Text(A){const v=this.ctx,R=this.current,z=R.font,H=R.fontSize,ne=R.fontDirection,D=z.vertical?1:-1,Y=R.charSpacing,te=R.wordSpacing,V=R.textHScale*ne,N=R.fontMatrix||x.FONT_IDENTITY_MATRIX,a=A.length,_=R.textRenderingMode===x.TextRenderingMode.INVISIBLE;let y,k,U,$;if(!(_||H===0)){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,v.save(),v.transform(...R.textMatrix),v.translate(R.x,R.y),v.scale(V,ne),y=0;y<a;++y){if(k=A[y],typeof k=="number"){$=D*k*H/1e3,this.ctx.translate($,0),R.x+=$*V;continue}const he=(k.isSpace?te:0)+Y,X=z.charProcOperatorList[k.operatorListId];if(!X){(0,x.warn)(`Type3 character "${k.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=k,this.save(),v.scale(H,H),v.transform(...N),this.executeOperatorList(X),this.restore()),U=x.Util.applyTransform([k.width,0],N)[0]*H+he,v.translate(U,0),R.x+=U*V}v.restore(),this.processingType3=null}}setCharWidth(A,v){}setCharWidthAndBounds(A,v,R,z,H,ne){this.ctx.rect(R,z,H-R,ne-z),this.ctx.clip(),this.endPath()}getColorN_Pattern(A){let v;if(A[0]==="TilingPattern"){const R=A[1],z=this.baseTransform||(0,B.getCurrentTransform)(this.ctx),H={createCanvasGraphics:ne=>new oe(ne,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};v=new ue.TilingPattern(A,R,this.ctx,H,z)}else v=this._getPattern(A[1],A[2]);return v}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(A,v,R){const z=x.Util.makeHexColor(A,v,R);this.ctx.strokeStyle=z,this.current.strokeColor=z}setFillRGBColor(A,v,R){const z=x.Util.makeHexColor(A,v,R);this.ctx.fillStyle=z,this.current.fillColor=z,this.current.patternFill=!1}_getPattern(A,v=null){let R;return this.cachedPatterns.has(A)?R=this.cachedPatterns.get(A):(R=(0,ue.getShadingPattern)(this.getObject(A)),this.cachedPatterns.set(A,R)),v&&(R.matrix=v),R}shadingFill(A){if(!this.contentVisible)return;const v=this.ctx;this.save();const R=this._getPattern(A);v.fillStyle=R.getPattern(v,this,(0,B.getCurrentTransformInverse)(v),ue.PathType.SHADING);const z=(0,B.getCurrentTransformInverse)(v);if(z){const H=v.canvas,ne=H.width,D=H.height,Y=x.Util.applyTransform([0,0],z),te=x.Util.applyTransform([0,D],z),V=x.Util.applyTransform([ne,0],z),N=x.Util.applyTransform([ne,D],z),a=Math.min(Y[0],te[0],V[0],N[0]),_=Math.min(Y[1],te[1],V[1],N[1]),y=Math.max(Y[0],te[0],V[0],N[0]),k=Math.max(Y[1],te[1],V[1],N[1]);this.ctx.fillRect(a,_,y-a,k-_)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,x.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,x.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(A,v){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(A)&&A.length===6&&this.transform(...A),this.baseTransform=(0,B.getCurrentTransform)(this.ctx),v)){const R=v[2]-v[0],z=v[3]-v[1];this.ctx.rect(v[0],v[1],R,z),this.current.updateRectMinMax((0,B.getCurrentTransform)(this.ctx),v),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(A){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const v=this.ctx;A.isolated||(0,x.info)("TODO: Support non-isolated groups."),A.knockout&&(0,x.warn)("Knockout groups not supported.");const R=(0,B.getCurrentTransform)(v);if(A.matrix&&v.transform(...A.matrix),!A.bbox)throw new Error("Bounding box is required.");let z=x.Util.getAxialAlignedBoundingBox(A.bbox,(0,B.getCurrentTransform)(v));const H=[0,0,v.canvas.width,v.canvas.height];z=x.Util.intersect(z,H)||[0,0,0,0];const ne=Math.floor(z[0]),D=Math.floor(z[1]);let Y=Math.max(Math.ceil(z[2])-ne,1),te=Math.max(Math.ceil(z[3])-D,1),V=1,N=1;Y>l&&(V=Y/l,Y=l),te>l&&(N=te/l,te=l),this.current.startNewPathAndClipBox([0,0,Y,te]);let a="groupAt"+this.groupLevel;A.smask&&(a+="_smask_"+this.smaskCounter++%2);const _=this.cachedCanvases.getCanvas(a,Y,te),y=_.context;y.scale(1/V,1/N),y.translate(-ne,-D),y.transform(...R),A.smask?this.smaskStack.push({canvas:_.canvas,context:y,offsetX:ne,offsetY:D,scaleX:V,scaleY:N,subtype:A.smask.subtype,backdrop:A.smask.backdrop,transferMap:A.smask.transferMap||null,startTransformInverse:null}):(v.setTransform(1,0,0,1,0,0),v.translate(ne,D),v.scale(V,N),v.save()),t(v,y),this.ctx=y,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(v),this.groupLevel++}endGroup(A){if(!this.contentVisible)return;this.groupLevel--;const v=this.ctx,R=this.groupStack.pop();if(this.ctx=R,this.ctx.imageSmoothingEnabled=!1,A.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const z=(0,B.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...z);const H=x.Util.getAxialAlignedBoundingBox([0,0,v.canvas.width,v.canvas.height],z);this.ctx.drawImage(v.canvas,0,0),this.ctx.restore(),this.compose(H)}}beginAnnotation(A,v,R,z,H){if(ee(this,me,It).call(this),r(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(v)&&v.length===4){const ne=v[2]-v[0],D=v[3]-v[1];if(H&&this.annotationCanvasMap){R=R.slice(),R[4]-=v[0],R[5]-=v[1],v=v.slice(),v[0]=v[1]=0,v[2]=ne,v[3]=D;const[Y,te]=x.Util.singularValueDecompose2dScale((0,B.getCurrentTransform)(this.ctx)),{viewportScale:V}=this,N=Math.ceil(ne*this.outputScaleX*V),a=Math.ceil(D*this.outputScaleY*V);this.annotationCanvas=this.canvasFactory.create(N,a);const{canvas:_,context:y}=this.annotationCanvas;this.annotationCanvasMap.set(A,_),this.annotationCanvas.savedCtx=this.ctx,this.ctx=y,this.ctx.setTransform(Y,0,0,-te,0,D*te),r(this.ctx)}else r(this.ctx),this.ctx.rect(v[0],v[1],ne,D),this.ctx.clip(),this.endPath()}this.current=new b(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...R),this.transform(...z)}endAnnotation(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(A){if(!this.contentVisible)return;const v=A.count;A=this.getObject(A.data,A),A.count=v;const R=this.ctx,z=this.processingType3;if(z&&(z.compiled===void 0&&(z.compiled=E(A)),z.compiled)){z.compiled(R);return}const H=this._createMaskCanvas(A),ne=H.canvas;R.save(),R.setTransform(1,0,0,1,0,0),R.drawImage(ne,H.offsetX,H.offsetY),R.restore(),this.compose()}paintImageMaskXObjectRepeat(A,v,R=0,z=0,H,ne){if(!this.contentVisible)return;A=this.getObject(A.data,A);const D=this.ctx;D.save();const Y=(0,B.getCurrentTransform)(D);D.transform(v,R,z,H,0,0);const te=this._createMaskCanvas(A);D.setTransform(1,0,0,1,te.offsetX-Y[4],te.offsetY-Y[5]);for(let V=0,N=ne.length;V<N;V+=2){const a=x.Util.transform(Y,[v,R,z,H,ne[V],ne[V+1]]),[_,y]=x.Util.applyTransform([0,0],a);D.drawImage(te.canvas,_,y)}D.restore(),this.compose()}paintImageMaskXObjectGroup(A){if(!this.contentVisible)return;const v=this.ctx,R=this.current.fillColor,z=this.current.patternFill;for(const H of A){const{data:ne,width:D,height:Y,transform:te}=H,V=this.cachedCanvases.getCanvas("maskCanvas",D,Y),N=V.context;N.save();const a=this.getObject(ne,H);e(N,a),N.globalCompositeOperation="source-in",N.fillStyle=z?R.getPattern(N,this,(0,B.getCurrentTransformInverse)(v),ue.PathType.FILL):R,N.fillRect(0,0,D,Y),N.restore(),v.save(),v.transform(...te),v.scale(1,-1),o(v,V.canvas,0,0,D,Y,0,-1,1,1),v.restore()}this.compose()}paintImageXObject(A){if(!this.contentVisible)return;const v=this.getObject(A);if(!v){(0,x.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(v)}paintImageXObjectRepeat(A,v,R,z){if(!this.contentVisible)return;const H=this.getObject(A);if(!H){(0,x.warn)("Dependent image isn't ready yet");return}const ne=H.width,D=H.height,Y=[];for(let te=0,V=z.length;te<V;te+=2)Y.push({transform:[v,0,0,R,z[te],z[te+1]],x:0,y:0,w:ne,h:D});this.paintInlineImageXObjectGroup(H,Y)}applyTransferMapsToCanvas(A){return this.current.transferMaps!=="none"&&(A.filter=this.current.transferMaps,A.drawImage(A.canvas,0,0),A.filter="none"),A.canvas}applyTransferMapsToBitmap(A){if(this.current.transferMaps==="none")return A.bitmap;const{bitmap:v,width:R,height:z}=A,H=this.cachedCanvases.getCanvas("inlineImage",R,z),ne=H.context;return ne.filter=this.current.transferMaps,ne.drawImage(v,0,0),ne.filter="none",H.canvas}paintInlineImageXObject(A){if(!this.contentVisible)return;const v=A.width,R=A.height,z=this.ctx;this.save(),L.isNodeJS||(z.filter="none"),z.scale(1/v,-1/R);let H;if(A.bitmap)H=this.applyTransferMapsToBitmap(A);else if(typeof HTMLElement=="function"&&A instanceof HTMLElement||!A.data)H=A;else{const Y=this.cachedCanvases.getCanvas("inlineImage",v,R).context;p(Y,A),H=this.applyTransferMapsToCanvas(Y)}const ne=this._scaleImage(H,(0,B.getCurrentTransformInverse)(z));z.imageSmoothingEnabled=J((0,B.getCurrentTransform)(z),A.interpolate),o(z,ne.img,0,0,ne.paintWidth,ne.paintHeight,0,-R,v,R),this.compose(),this.restore()}paintInlineImageXObjectGroup(A,v){if(!this.contentVisible)return;const R=this.ctx;let z;if(A.bitmap)z=A.bitmap;else{const H=A.width,ne=A.height,Y=this.cachedCanvases.getCanvas("inlineImage",H,ne).context;p(Y,A),z=this.applyTransferMapsToCanvas(Y)}for(const H of v)R.save(),R.transform(...H.transform),R.scale(1,-1),o(R,z,H.x,H.y,H.w,H.h,0,-1,1,1),R.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(A){}markPointProps(A,v){}beginMarkedContent(A){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(A,v){A==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(v)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(A){const v=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(A);const R=this.ctx;this.pendingClip&&(v||(this.pendingClip===fe?R.clip("evenodd"):R.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),R.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const A=(0,B.getCurrentTransform)(this.ctx);if(A[1]===0&&A[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(A[0]),Math.abs(A[3]));else{const v=Math.abs(A[0]*A[3]-A[2]*A[1]),R=Math.hypot(A[0],A[2]),z=Math.hypot(A[1],A[3]);this._cachedGetSinglePixelWidth=Math.max(R,z)/v}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:A}=this.current,v=(0,B.getCurrentTransform)(this.ctx);let R,z;if(v[1]===0&&v[2]===0){const H=Math.abs(v[0]),ne=Math.abs(v[3]);if(A===0)R=1/H,z=1/ne;else{const D=H*A,Y=ne*A;R=D<1?1/D:1,z=Y<1?1/Y:1}}else{const H=Math.abs(v[0]*v[3]-v[2]*v[1]),ne=Math.hypot(v[0],v[1]),D=Math.hypot(v[2],v[3]);if(A===0)R=D/H,z=ne/H;else{const Y=A*H;R=D>Y?D/Y:1,z=ne>Y?ne/Y:1}}this._cachedScaleForStroking=[R,z]}return this._cachedScaleForStroking}rescaleAndStroke(A){const{ctx:v}=this,{lineWidth:R}=this.current,[z,H]=this.getScaleForStroking();if(v.lineWidth=R||1,z===1&&H===1){v.stroke();return}let ne,D,Y;A&&(ne=(0,B.getCurrentTransform)(v),D=v.getLineDash().slice(),Y=v.lineDashOffset),v.scale(z,H);const te=Math.max(z,H);v.setLineDash(v.getLineDash().map(V=>V/te)),v.lineDashOffset/=te,v.stroke(),A&&(v.setTransform(...ne),v.setLineDash(D),v.lineDashOffset=Y)}isContentVisible(){for(let A=this.markedContentStack.length-1;A>=0;A--)if(!this.markedContentStack[A].visible)return!1;return!0}};let K=oe;d(K,"CanvasGraphics"),me=new WeakSet,It=d(function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},"#restoreInitialState"),C.CanvasGraphics=K;for(const W in x.OPS)K.prototype[W]!==void 0&&(K.prototype[x.OPS[W]]=K.prototype[W])},(ae,C,de)=>{Object.defineProperty(C,"__esModule",{value:!0}),C.TilingPattern=C.PathType=void 0,C.getShadingPattern=g;var x=de(1),B=de(6);const ue={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};C.PathType=ue;function G(n,o){if(!o)return;const E=o[2]-o[0],b=o[3]-o[1],p=new Path2D;p.rect(o[0],o[1],E,b),n.clip(p)}d(G,"applyBoundingBox");class L{constructor(){this.constructor===L&&(0,x.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,x.unreachable)("Abstract method `getPattern` called.")}}d(L,"BaseShadingPattern");class I extends L{constructor(o){super(),this._type=o[1],this._bbox=o[2],this._colorStops=o[3],this._p0=o[4],this._p1=o[5],this._r0=o[6],this._r1=o[7],this.matrix=null}_createGradient(o){let E;this._type==="axial"?E=o.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(E=o.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const b of this._colorStops)E.addColorStop(b[0],b[1]);return E}getPattern(o,E,b,p){let e;if(p===ue.STROKE||p===ue.FILL){const t=E.current.getClippedPathBoundingBox(p,(0,B.getCurrentTransform)(o))||[0,0,0,0],r=Math.ceil(t[2]-t[0])||1,s=Math.ceil(t[3]-t[1])||1,m=E.cachedCanvases.getCanvas("pattern",r,s,!0),P=m.context;P.clearRect(0,0,P.canvas.width,P.canvas.height),P.beginPath(),P.rect(0,0,P.canvas.width,P.canvas.height),P.translate(-t[0],-t[1]),b=x.Util.transform(b,[1,0,0,1,t[0],t[1]]),P.transform(...E.baseTransform),this.matrix&&P.transform(...this.matrix),G(P,this._bbox),P.fillStyle=this._createGradient(P),P.fill(),e=o.createPattern(m.canvas,"no-repeat");const h=new DOMMatrix(b);e.setTransform(h)}else G(o,this._bbox),e=this._createGradient(o);return e}}d(I,"RadialAxialShadingPattern");function f(n,o,E,b,p,e,t,r){const s=o.coords,m=o.colors,P=n.data,h=n.width*4;let F;s[E+1]>s[b+1]&&(F=E,E=b,b=F,F=e,e=t,t=F),s[b+1]>s[p+1]&&(F=b,b=p,p=F,F=t,t=r,r=F),s[E+1]>s[b+1]&&(F=E,E=b,b=F,F=e,e=t,t=F);const J=(s[E]+o.offsetX)*o.scaleX,le=(s[E+1]+o.offsetY)*o.scaleY,q=(s[b]+o.offsetX)*o.scaleX,re=(s[b+1]+o.offsetY)*o.scaleY,fe=(s[p]+o.offsetX)*o.scaleX,K=(s[p+1]+o.offsetY)*o.scaleY;if(le>=K)return;const me=m[e],Ee=m[e+1],oe=m[e+2],W=m[t],A=m[t+1],v=m[t+2],R=m[r],z=m[r+1],H=m[r+2],ne=Math.round(le),D=Math.round(K);let Y,te,V,N,a,_,y,k;for(let U=ne;U<=D;U++){if(U<re){let pe;U<le?pe=0:pe=(le-U)/(le-re),Y=J-(J-q)*pe,te=me-(me-W)*pe,V=Ee-(Ee-A)*pe,N=oe-(oe-v)*pe}else{let pe;U>K?pe=1:re===K?pe=0:pe=(re-U)/(re-K),Y=q-(q-fe)*pe,te=W-(W-R)*pe,V=A-(A-z)*pe,N=v-(v-H)*pe}let $;U<le?$=0:U>K?$=1:$=(le-U)/(le-K),a=J-(J-fe)*$,_=me-(me-R)*$,y=Ee-(Ee-z)*$,k=oe-(oe-H)*$;const he=Math.round(Math.min(Y,a)),X=Math.round(Math.max(Y,a));let Q=h*U+he*4;for(let pe=he;pe<=X;pe++)$=(Y-pe)/(Y-a),$<0?$=0:$>1&&($=1),P[Q++]=te-(te-_)*$|0,P[Q++]=V-(V-y)*$|0,P[Q++]=N-(N-k)*$|0,P[Q++]=255}}d(f,"drawTriangle");function l(n,o,E){const b=o.coords,p=o.colors;let e,t;switch(o.type){case"lattice":const r=o.verticesPerRow,s=Math.floor(b.length/r)-1,m=r-1;for(e=0;e<s;e++){let P=e*r;for(let h=0;h<m;h++,P++)f(n,E,b[P],b[P+1],b[P+r],p[P],p[P+1],p[P+r]),f(n,E,b[P+r+1],b[P+1],b[P+r],p[P+r+1],p[P+1],p[P+r])}break;case"triangles":for(e=0,t=b.length;e<t;e+=3)f(n,E,b[e],b[e+1],b[e+2],p[e],p[e+1],p[e+2]);break;default:throw new Error("illegal figure")}}d(l,"drawFigure");class w extends L{constructor(o){super(),this._coords=o[2],this._colors=o[3],this._figures=o[4],this._bounds=o[5],this._bbox=o[7],this._background=o[8],this.matrix=null}_createMeshCanvas(o,E,b){const r=Math.floor(this._bounds[0]),s=Math.floor(this._bounds[1]),m=Math.ceil(this._bounds[2])-r,P=Math.ceil(this._bounds[3])-s,h=Math.min(Math.ceil(Math.abs(m*o[0]*1.1)),3e3),F=Math.min(Math.ceil(Math.abs(P*o[1]*1.1)),3e3),J=m/h,le=P/F,q={coords:this._coords,colors:this._colors,offsetX:-r,offsetY:-s,scaleX:1/J,scaleY:1/le},re=h+2*2,fe=F+2*2,K=b.getCanvas("mesh",re,fe,!1),me=K.context,Ee=me.createImageData(h,F);if(E){const W=Ee.data;for(let A=0,v=W.length;A<v;A+=4)W[A]=E[0],W[A+1]=E[1],W[A+2]=E[2],W[A+3]=255}for(const W of this._figures)l(Ee,W,q);return me.putImageData(Ee,2,2),{canvas:K.canvas,offsetX:r-2*J,offsetY:s-2*le,scaleX:J,scaleY:le}}getPattern(o,E,b,p){G(o,this._bbox);let e;if(p===ue.SHADING)e=x.Util.singularValueDecompose2dScale((0,B.getCurrentTransform)(o));else if(e=x.Util.singularValueDecompose2dScale(E.baseTransform),this.matrix){const r=x.Util.singularValueDecompose2dScale(this.matrix);e=[e[0]*r[0],e[1]*r[1]]}const t=this._createMeshCanvas(e,p===ue.SHADING?null:this._background,E.cachedCanvases);return p!==ue.SHADING&&(o.setTransform(...E.baseTransform),this.matrix&&o.transform(...this.matrix)),o.translate(t.offsetX,t.offsetY),o.scale(t.scaleX,t.scaleY),o.createPattern(t.canvas,"no-repeat")}}d(w,"MeshShadingPattern");class S extends L{getPattern(){return"hotpink"}}d(S,"DummyShadingPattern");function g(n){switch(n[0]){case"RadialAxial":return new I(n);case"Mesh":return new w(n);case"Dummy":return new S}throw new Error(`Unknown IR type: ${n[0]}`)}d(g,"getShadingPattern");const i={COLORED:1,UNCOLORED:2};class c{static get MAX_PATTERN_SIZE(){return(0,x.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(o,E,b,p,e){this.operatorList=o[2],this.matrix=o[3]||[1,0,0,1,0,0],this.bbox=o[4],this.xstep=o[5],this.ystep=o[6],this.paintType=o[7],this.tilingType=o[8],this.color=E,this.ctx=b,this.canvasGraphicsFactory=p,this.baseTransform=e}createPatternCanvas(o){const E=this.operatorList,b=this.bbox,p=this.xstep,e=this.ystep,t=this.paintType,r=this.tilingType,s=this.color,m=this.canvasGraphicsFactory;(0,x.info)("TilingType: "+r);const P=b[0],h=b[1],F=b[2],J=b[3],le=x.Util.singularValueDecompose2dScale(this.matrix),q=x.Util.singularValueDecompose2dScale(this.baseTransform),re=[le[0]*q[0],le[1]*q[1]],fe=this.getSizeAndScale(p,this.ctx.canvas.width,re[0]),K=this.getSizeAndScale(e,this.ctx.canvas.height,re[1]),me=o.cachedCanvases.getCanvas("pattern",fe.size,K.size,!0),Ee=me.context,oe=m.createCanvasGraphics(Ee);oe.groupLevel=o.groupLevel,this.setFillAndStrokeStyleToContext(oe,t,s);let W=P,A=h,v=F,R=J;return P<0&&(W=0,v+=Math.abs(P)),h<0&&(A=0,R+=Math.abs(h)),Ee.translate(-(fe.scale*W),-(K.scale*A)),oe.transform(fe.scale,0,0,K.scale,0,0),Ee.save(),this.clipBbox(oe,W,A,v,R),oe.baseTransform=(0,B.getCurrentTransform)(oe.ctx),oe.executeOperatorList(E),oe.endDrawing(),{canvas:me.canvas,scaleX:fe.scale,scaleY:K.scale,offsetX:W,offsetY:A}}getSizeAndScale(o,E,b){o=Math.abs(o);const p=Math.max(c.MAX_PATTERN_SIZE,E);let e=Math.ceil(o*b);return e>=p?e=p:b=e/o,{scale:b,size:e}}clipBbox(o,E,b,p,e){const t=p-E,r=e-b;o.ctx.rect(E,b,t,r),o.current.updateRectMinMax((0,B.getCurrentTransform)(o.ctx),[E,b,p,e]),o.clip(),o.endPath()}setFillAndStrokeStyleToContext(o,E,b){const p=o.ctx,e=o.current;switch(E){case i.COLORED:const t=this.ctx;p.fillStyle=t.fillStyle,p.strokeStyle=t.strokeStyle,e.fillColor=t.fillStyle,e.strokeColor=t.strokeStyle;break;case i.UNCOLORED:const r=x.Util.makeHexColor(b[0],b[1],b[2]);p.fillStyle=r,p.strokeStyle=r,e.fillColor=r,e.strokeColor=r;break;default:throw new x.FormatError(`Unsupported paint type: ${E}`)}}getPattern(o,E,b,p){let e=b;p!==ue.SHADING&&(e=x.Util.transform(e,E.baseTransform),this.matrix&&(e=x.Util.transform(e,this.matrix)));const t=this.createPatternCanvas(E);let r=new DOMMatrix(e);r=r.translate(t.offsetX,t.offsetY),r=r.scale(1/t.scaleX,1/t.scaleY);const s=o.createPattern(t.canvas,"repeat");return s.setTransform(r),s}}d(c,"TilingPattern"),C.TilingPattern=c},(ae,C,de)=>{Object.defineProperty(C,"__esModule",{value:!0}),C.convertBlackAndWhiteToRGBA=ue,C.convertToRGBA=B,C.grayToRGBA=L;var x=de(1);function B(I){switch(I.kind){case x.ImageKind.GRAYSCALE_1BPP:return ue(I);case x.ImageKind.RGB_24BPP:return G(I)}return null}d(B,"convertToRGBA");function ue({src:I,srcPos:f=0,dest:l,width:w,height:S,nonBlackColor:g=4294967295,inverseDecode:i=!1}){const c=x.FeatureTest.isLittleEndian?4278190080:255,[n,o]=i?[g,c]:[c,g],E=w>>3,b=w&7,p=I.length;l=new Uint32Array(l.buffer);let e=0;for(let t=0;t<S;t++){for(const s=f+E;f<s;f++){const m=f<p?I[f]:255;l[e++]=m&128?o:n,l[e++]=m&64?o:n,l[e++]=m&32?o:n,l[e++]=m&16?o:n,l[e++]=m&8?o:n,l[e++]=m&4?o:n,l[e++]=m&2?o:n,l[e++]=m&1?o:n}if(b===0)continue;const r=f<p?I[f++]:255;for(let s=0;s<b;s++)l[e++]=r&1<<7-s?o:n}return{srcPos:f,destPos:e}}d(ue,"convertBlackAndWhiteToRGBA");function G({src:I,srcPos:f=0,dest:l,destPos:w=0,width:S,height:g}){let i=0;const c=I.length>>2,n=new Uint32Array(I.buffer,f,c);if(x.FeatureTest.isLittleEndian){for(;i<c-2;i+=3,w+=4){const o=n[i],E=n[i+1],b=n[i+2];l[w]=o|4278190080,l[w+1]=o>>>24|E<<8|4278190080,l[w+2]=E>>>16|b<<16|4278190080,l[w+3]=b>>>8|4278190080}for(let o=i*4,E=I.length;o<E;o+=3)l[w++]=I[o]|I[o+1]<<8|I[o+2]<<16|4278190080}else{for(;i<c-2;i+=3,w+=4){const o=n[i],E=n[i+1],b=n[i+2];l[w]=o|255,l[w+1]=o<<24|E>>>8|255,l[w+2]=E<<16|b>>>16|255,l[w+3]=b<<8|255}for(let o=i*4,E=I.length;o<E;o+=3)l[w++]=I[o]<<24|I[o+1]<<16|I[o+2]<<8|255}return{srcPos:f,destPos:w}}d(G,"convertRGBToRGBA");function L(I,f){if(x.FeatureTest.isLittleEndian)for(let l=0,w=I.length;l<w;l++)f[l]=I[l]*65793|4278190080;else for(let l=0,w=I.length;l<w;l++)f[l]=I[l]*16843008|255}d(L,"grayToRGBA")},(ae,C)=>{Object.defineProperty(C,"__esModule",{value:!0}),C.GlobalWorkerOptions=void 0;const de=Object.create(null);C.GlobalWorkerOptions=de,de.workerPort=null,de.workerSrc=""},(ae,C,de)=>{Object.defineProperty(C,"__esModule",{value:!0}),C.MessageHandler=void 0;var x=de(1);const B={UNKNOWN:0,DATA:1,ERROR:2},ue={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function G(I){switch(I instanceof Error||typeof I=="object"&&I!==null||(0,x.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),I.name){case"AbortException":return new x.AbortException(I.message);case"MissingPDFException":return new x.MissingPDFException(I.message);case"PasswordException":return new x.PasswordException(I.message,I.code);case"UnexpectedResponseException":return new x.UnexpectedResponseException(I.message,I.status);case"UnknownErrorException":return new x.UnknownErrorException(I.message,I.details);default:return new x.UnknownErrorException(I.message,I.toString())}}d(G,"wrapReason");class L{constructor(f,l,w){this.sourceName=f,this.targetName=l,this.comObj=w,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=S=>{const g=S.data;if(g.targetName!==this.sourceName)return;if(g.stream){this._processStreamMessage(g);return}if(g.callback){const c=g.callbackId,n=this.callbackCapabilities[c];if(!n)throw new Error(`Cannot resolve callback ${c}`);if(delete this.callbackCapabilities[c],g.callback===B.DATA)n.resolve(g.data);else if(g.callback===B.ERROR)n.reject(G(g.reason));else throw new Error("Unexpected callback case");return}const i=this.actionHandler[g.action];if(!i)throw new Error(`Unknown action from worker: ${g.action}`);if(g.callbackId){const c=this.sourceName,n=g.sourceName;new Promise(function(o){o(i(g.data))}).then(function(o){w.postMessage({sourceName:c,targetName:n,callback:B.DATA,callbackId:g.callbackId,data:o})},function(o){w.postMessage({sourceName:c,targetName:n,callback:B.ERROR,callbackId:g.callbackId,reason:G(o)})});return}if(g.streamId){this._createStreamSink(g);return}i(g.data)},w.addEventListener("message",this._onComObjOnMessage)}on(f,l){const w=this.actionHandler;if(w[f])throw new Error(`There is already an actionName called "${f}"`);w[f]=l}send(f,l,w){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:f,data:l},w)}sendWithPromise(f,l,w){const S=this.callbackId++,g=(0,x.createPromiseCapability)();this.callbackCapabilities[S]=g;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:f,callbackId:S,data:l},w)}catch(i){g.reject(i)}return g.promise}sendWithStream(f,l,w,S){const g=this.streamId++,i=this.sourceName,c=this.targetName,n=this.comObj;return new ReadableStream({start:o=>{const E=(0,x.createPromiseCapability)();return this.streamControllers[g]={controller:o,startCall:E,pullCall:null,cancelCall:null,isClosed:!1},n.postMessage({sourceName:i,targetName:c,action:f,streamId:g,data:l,desiredSize:o.desiredSize},S),E.promise},pull:o=>{const E=(0,x.createPromiseCapability)();return this.streamControllers[g].pullCall=E,n.postMessage({sourceName:i,targetName:c,stream:ue.PULL,streamId:g,desiredSize:o.desiredSize}),E.promise},cancel:o=>{(0,x.assert)(o instanceof Error,"cancel must have a valid reason");const E=(0,x.createPromiseCapability)();return this.streamControllers[g].cancelCall=E,this.streamControllers[g].isClosed=!0,n.postMessage({sourceName:i,targetName:c,stream:ue.CANCEL,streamId:g,reason:G(o)}),E.promise}},w)}_createStreamSink(f){const l=f.streamId,w=this.sourceName,S=f.sourceName,g=this.comObj,i=this,c=this.actionHandler[f.action],n={enqueue(o,E=1,b){if(this.isCancelled)return;const p=this.desiredSize;this.desiredSize-=E,p>0&&this.desiredSize<=0&&(this.sinkCapability=(0,x.createPromiseCapability)(),this.ready=this.sinkCapability.promise),g.postMessage({sourceName:w,targetName:S,stream:ue.ENQUEUE,streamId:l,chunk:o},b)},close(){this.isCancelled||(this.isCancelled=!0,g.postMessage({sourceName:w,targetName:S,stream:ue.CLOSE,streamId:l}),delete i.streamSinks[l])},error(o){(0,x.assert)(o instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,g.postMessage({sourceName:w,targetName:S,stream:ue.ERROR,streamId:l,reason:G(o)}))},sinkCapability:(0,x.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:f.desiredSize,ready:null};n.sinkCapability.resolve(),n.ready=n.sinkCapability.promise,this.streamSinks[l]=n,new Promise(function(o){o(c(f.data,n))}).then(function(){g.postMessage({sourceName:w,targetName:S,stream:ue.START_COMPLETE,streamId:l,success:!0})},function(o){g.postMessage({sourceName:w,targetName:S,stream:ue.START_COMPLETE,streamId:l,reason:G(o)})})}_processStreamMessage(f){const l=f.streamId,w=this.sourceName,S=f.sourceName,g=this.comObj,i=this.streamControllers[l],c=this.streamSinks[l];switch(f.stream){case ue.START_COMPLETE:f.success?i.startCall.resolve():i.startCall.reject(G(f.reason));break;case ue.PULL_COMPLETE:f.success?i.pullCall.resolve():i.pullCall.reject(G(f.reason));break;case ue.PULL:if(!c){g.postMessage({sourceName:w,targetName:S,stream:ue.PULL_COMPLETE,streamId:l,success:!0});break}c.desiredSize<=0&&f.desiredSize>0&&c.sinkCapability.resolve(),c.desiredSize=f.desiredSize,new Promise(function(n){n(c.onPull&&c.onPull())}).then(function(){g.postMessage({sourceName:w,targetName:S,stream:ue.PULL_COMPLETE,streamId:l,success:!0})},function(n){g.postMessage({sourceName:w,targetName:S,stream:ue.PULL_COMPLETE,streamId:l,reason:G(n)})});break;case ue.ENQUEUE:if((0,x.assert)(i,"enqueue should have stream controller"),i.isClosed)break;i.controller.enqueue(f.chunk);break;case ue.CLOSE:if((0,x.assert)(i,"close should have stream controller"),i.isClosed)break;i.isClosed=!0,i.controller.close(),this._deleteStreamController(i,l);break;case ue.ERROR:(0,x.assert)(i,"error should have stream controller"),i.controller.error(G(f.reason)),this._deleteStreamController(i,l);break;case ue.CANCEL_COMPLETE:f.success?i.cancelCall.resolve():i.cancelCall.reject(G(f.reason)),this._deleteStreamController(i,l);break;case ue.CANCEL:if(!c)break;new Promise(function(n){n(c.onCancel&&c.onCancel(G(f.reason)))}).then(function(){g.postMessage({sourceName:w,targetName:S,stream:ue.CANCEL_COMPLETE,streamId:l,success:!0})},function(n){g.postMessage({sourceName:w,targetName:S,stream:ue.CANCEL_COMPLETE,streamId:l,reason:G(n)})}),c.sinkCapability.reject(G(f.reason)),c.isCancelled=!0,delete this.streamSinks[l];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(f,l){await Promise.allSettled([f.startCall&&f.startCall.promise,f.pullCall&&f.pullCall.promise,f.cancelCall&&f.cancelCall.promise]),delete this.streamControllers[l]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}d(L,"MessageHandler"),C.MessageHandler=L},(ae,C,de)=>{var ue,G;Object.defineProperty(C,"__esModule",{value:!0}),C.Metadata=void 0;var x=de(1);class B{constructor({parsedData:I,rawData:f}){Z(this,ue,void 0);Z(this,G,void 0);ve(this,ue,I),ve(this,G,f)}getRaw(){return u(this,G)}get(I){return u(this,ue).get(I)??null}getAll(){return(0,x.objectFromMap)(u(this,ue))}has(I){return u(this,ue).has(I)}}d(B,"Metadata"),ue=new WeakMap,G=new WeakMap,C.Metadata=B},(ae,C,de)=>{var I,f,l,w,S,g,Ft;Object.defineProperty(C,"__esModule",{value:!0}),C.OptionalContentConfig=void 0;var x=de(1),B=de(8);const ue=Symbol("INTERNAL");class G{constructor(n,o){Z(this,I,!0);this.name=n,this.intent=o}get visible(){return u(this,I)}_setVisible(n,o){n!==ue&&(0,x.unreachable)("Internal method `_setVisible` called."),ve(this,I,o)}}d(G,"OptionalContentGroup"),I=new WeakMap;class L{constructor(n){Z(this,g);Z(this,f,null);Z(this,l,new Map);Z(this,w,null);Z(this,S,null);if(this.name=null,this.creator=null,n!==null){this.name=n.name,this.creator=n.creator,ve(this,S,n.order);for(const o of n.groups)u(this,l).set(o.id,new G(o.name,o.intent));if(n.baseState==="OFF")for(const o of u(this,l).values())o._setVisible(ue,!1);for(const o of n.on)u(this,l).get(o)._setVisible(ue,!0);for(const o of n.off)u(this,l).get(o)._setVisible(ue,!1);ve(this,w,this.getHash())}}isVisible(n){if(u(this,l).size===0)return!0;if(!n)return(0,x.warn)("Optional content group not defined."),!0;if(n.type==="OCG")return u(this,l).has(n.id)?u(this,l).get(n.id).visible:((0,x.warn)(`Optional content group not found: ${n.id}`),!0);if(n.type==="OCMD"){if(n.expression)return ee(this,g,Ft).call(this,n.expression);if(!n.policy||n.policy==="AnyOn"){for(const o of n.ids){if(!u(this,l).has(o))return(0,x.warn)(`Optional content group not found: ${o}`),!0;if(u(this,l).get(o).visible)return!0}return!1}else if(n.policy==="AllOn"){for(const o of n.ids){if(!u(this,l).has(o))return(0,x.warn)(`Optional content group not found: ${o}`),!0;if(!u(this,l).get(o).visible)return!1}return!0}else if(n.policy==="AnyOff"){for(const o of n.ids){if(!u(this,l).has(o))return(0,x.warn)(`Optional content group not found: ${o}`),!0;if(!u(this,l).get(o).visible)return!0}return!1}else if(n.policy==="AllOff"){for(const o of n.ids){if(!u(this,l).has(o))return(0,x.warn)(`Optional content group not found: ${o}`),!0;if(u(this,l).get(o).visible)return!1}return!0}return(0,x.warn)(`Unknown optional content policy ${n.policy}.`),!0}return(0,x.warn)(`Unknown group type ${n.type}.`),!0}setVisibility(n,o=!0){if(!u(this,l).has(n)){(0,x.warn)(`Optional content group not found: ${n}`);return}u(this,l).get(n)._setVisible(ue,!!o),ve(this,f,null)}get hasInitialVisibility(){return this.getHash()===u(this,w)}getOrder(){return u(this,l).size?u(this,S)?u(this,S).slice():[...u(this,l).keys()]:null}getGroups(){return u(this,l).size>0?(0,x.objectFromMap)(u(this,l)):null}getGroup(n){return u(this,l).get(n)||null}getHash(){if(u(this,f)!==null)return u(this,f);const n=new B.MurmurHash3_64;for(const[o,E]of u(this,l))n.update(`${o}:${E.visible}`);return ve(this,f,n.hexdigest())}}d(L,"OptionalContentConfig"),f=new WeakMap,l=new WeakMap,w=new WeakMap,S=new WeakMap,g=new WeakSet,Ft=d(function(n){const o=n.length;if(o<2)return!0;const E=n[0];for(let b=1;b<o;b++){const p=n[b];let e;if(Array.isArray(p))e=ee(this,g,Ft).call(this,p);else if(u(this,l).has(p))e=u(this,l).get(p).visible;else return(0,x.warn)(`Optional content group not found: ${p}`),!0;switch(E){case"And":if(!e)return!1;break;case"Or":if(e)return!0;break;case"Not":return!e;default:return!0}}return E==="And"},"#evaluateVisibilityExpression"),C.OptionalContentConfig=L},(ae,C,de)=>{Object.defineProperty(C,"__esModule",{value:!0}),C.PDFDataTransportStream=void 0;var x=de(1),B=de(6);class ue{constructor({length:f,initialData:l,progressiveDone:w=!1,contentDispositionFilename:S=null,disableRange:g=!1,disableStream:i=!1},c){if((0,x.assert)(c,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=w,this._contentDispositionFilename=S,(l==null?void 0:l.length)>0){const n=l instanceof Uint8Array&&l.byteLength===l.buffer.byteLength?l.buffer:new Uint8Array(l).buffer;this._queuedChunks.push(n)}this._pdfDataRangeTransport=c,this._isStreamingSupported=!i,this._isRangeSupported=!g,this._contentLength=f,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((n,o)=>{this._onReceiveData({begin:n,chunk:o})}),this._pdfDataRangeTransport.addProgressListener((n,o)=>{this._onProgress({loaded:n,total:o})}),this._pdfDataRangeTransport.addProgressiveReadListener(n=>{this._onReceiveData({chunk:n})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:f,chunk:l}){const w=l instanceof Uint8Array&&l.byteLength===l.buffer.byteLength?l.buffer:new Uint8Array(l).buffer;if(f===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(w):this._queuedChunks.push(w);else{const S=this._rangeReaders.some(function(g){return g._begin!==f?!1:(g._enqueue(w),!0)});(0,x.assert)(S,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var f;return((f=this._fullRequestReader)==null?void 0:f._loaded)??0}_onProgress(f){var l,w,S,g;f.total===void 0?(w=(l=this._rangeReaders[0])==null?void 0:l.onProgress)==null||w.call(l,{loaded:f.loaded}):(g=(S=this._fullRequestReader)==null?void 0:S.onProgress)==null||g.call(S,{loaded:f.loaded,total:f.total})}_onProgressiveDone(){var f;(f=this._fullRequestReader)==null||f.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(f){const l=this._rangeReaders.indexOf(f);l>=0&&this._rangeReaders.splice(l,1)}getFullReader(){(0,x.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const f=this._queuedChunks;return this._queuedChunks=null,new G(this,f,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(f,l){if(l<=this._progressiveDataLength)return null;const w=new L(this,f,l);return this._pdfDataRangeTransport.requestDataRange(f,l),this._rangeReaders.push(w),w}cancelAllRequests(f){var l;(l=this._fullRequestReader)==null||l.cancel(f);for(const w of this._rangeReaders.slice(0))w.cancel(f);this._pdfDataRangeTransport.abort()}}d(ue,"PDFDataTransportStream"),C.PDFDataTransportStream=ue;class G{constructor(f,l,w=!1,S=null){this._stream=f,this._done=w||!1,this._filename=(0,B.isPdfFile)(S)?S:null,this._queuedChunks=l||[],this._loaded=0;for(const g of this._queuedChunks)this._loaded+=g.byteLength;this._requests=[],this._headersReady=Promise.resolve(),f._fullRequestReader=this,this.onProgress=null}_enqueue(f){this._done||(this._requests.length>0?this._requests.shift().resolve({value:f,done:!1}):this._queuedChunks.push(f),this._loaded+=f.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const f=(0,x.createPromiseCapability)();return this._requests.push(f),f.promise}cancel(f){this._done=!0;for(const l of this._requests)l.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}d(G,"PDFDataTransportStreamReader");class L{constructor(f,l,w){this._stream=f,this._begin=l,this._end=w,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(f){if(!this._done){if(this._requests.length===0)this._queuedChunk=f;else{this._requests.shift().resolve({value:f,done:!1});for(const w of this._requests)w.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const l=this._queuedChunk;return this._queuedChunk=null,{value:l,done:!1}}if(this._done)return{value:void 0,done:!0};const f=(0,x.createPromiseCapability)();return this._requests.push(f),f.promise}cancel(f){this._done=!0;for(const l of this._requests)l.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}d(L,"PDFDataTransportStreamRangeReader")},(ae,C)=>{Object.defineProperty(C,"__esModule",{value:!0}),C.XfaText=void 0;class de{static textContent(B){const ue=[],G={items:ue,styles:Object.create(null)};function L(I){var w;if(!I)return;let f=null;const l=I.name;if(l==="#text")f=I.value;else if(de.shouldBuildText(l))(w=I==null?void 0:I.attributes)!=null&&w.textContent?f=I.attributes.textContent:I.value&&(f=I.value);else return;if(f!==null&&ue.push({str:f}),!!I.children)for(const S of I.children)L(S)}return d(L,"walk"),L(B),G}static shouldBuildText(B){return!(B==="textarea"||B==="input"||B==="option"||B==="select")}}d(de,"XfaText"),C.XfaText=de},(ae,C,de)=>{Object.defineProperty(C,"__esModule",{value:!0}),C.NodeStandardFontDataFactory=C.NodeFilterFactory=C.NodeCanvasFactory=C.NodeCMapReaderFactory=void 0;var x=de(7);const B=d(function(f){return new Promise((l,w)=>{require$$5.readFile(f,(g,i)=>{if(g||!i){w(new Error(g));return}l(new Uint8Array(i))})})},"fetchData");class ue extends x.BaseFilterFactory{}d(ue,"NodeFilterFactory"),C.NodeFilterFactory=ue;class G extends x.BaseCanvasFactory{_createCanvas(l,w){return require$$5.createCanvas(l,w)}}d(G,"NodeCanvasFactory"),C.NodeCanvasFactory=G;class L extends x.BaseCMapReaderFactory{_fetchData(l,w){return B(l).then(S=>({cMapData:S,compressionType:w}))}}d(L,"NodeCMapReaderFactory"),C.NodeCMapReaderFactory=L;class I extends x.BaseStandardFontDataFactory{_fetchData(l){return B(l)}}d(I,"NodeStandardFontDataFactory"),C.NodeStandardFontDataFactory=I},(ae,C,de)=>{Object.defineProperty(C,"__esModule",{value:!0}),C.PDFNodeStream=void 0;var x=de(1),B=de(22);const ue=require$$5,G=require$$5,L=require$$5,I=require$$5,f=/^file:\/\/\/[a-zA-Z]:\//;function l(b){const p=I.parse(b);return p.protocol==="file:"||p.host?p:/^[a-z]:[/\\]/i.test(b)?I.parse(`file:///${b}`):(p.host||(p.protocol="file:"),p)}d(l,"parseUrl");class w{constructor(p){this.source=p,this.url=l(p.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&p.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var p;return((p=this._fullRequestReader)==null?void 0:p._loaded)??0}getFullReader(){return(0,x.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new o(this):new c(this),this._fullRequestReader}getRangeReader(p,e){if(e<=this._progressiveDataLength)return null;const t=this.isFsUrl?new E(this,p,e):new n(this,p,e);return this._rangeRequestReaders.push(t),t}cancelAllRequests(p){var e;(e=this._fullRequestReader)==null||e.cancel(p);for(const t of this._rangeRequestReaders.slice(0))t.cancel(p)}}d(w,"PDFNodeStream"),C.PDFNodeStream=w;class S{constructor(p){this._url=p.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=p.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=(0,x.createPromiseCapability)(),this._headersCapability=(0,x.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var t;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const p=this._readableStream.read();return p===null?(this._readCapability=(0,x.createPromiseCapability)(),this.read()):(this._loaded+=p.length,(t=this.onProgress)==null||t.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(p).buffer,done:!1})}cancel(p){if(!this._readableStream){this._error(p);return}this._readableStream.destroy(p)}_error(p){this._storedError=p,this._readCapability.resolve()}_setReadableStream(p){this._readableStream=p,p.on("readable",()=>{this._readCapability.resolve()}),p.on("end",()=>{p.destroy(),this._done=!0,this._readCapability.resolve()}),p.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new x.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}d(S,"BaseFullReader");class g{constructor(p){this._url=p.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,x.createPromiseCapability)();const e=p.source;this._isStreamingSupported=!e.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var t;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const p=this._readableStream.read();return p===null?(this._readCapability=(0,x.createPromiseCapability)(),this.read()):(this._loaded+=p.length,(t=this.onProgress)==null||t.call(this,{loaded:this._loaded}),{value:new Uint8Array(p).buffer,done:!1})}cancel(p){if(!this._readableStream){this._error(p);return}this._readableStream.destroy(p)}_error(p){this._storedError=p,this._readCapability.resolve()}_setReadableStream(p){this._readableStream=p,p.on("readable",()=>{this._readCapability.resolve()}),p.on("end",()=>{p.destroy(),this._done=!0,this._readCapability.resolve()}),p.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}d(g,"BaseRangeReader");function i(b,p){return{protocol:b.protocol,auth:b.auth,host:b.hostname,port:b.port,path:b.path,method:"GET",headers:p}}d(i,"createRequestOptions");class c extends S{constructor(p){super(p);const e=d(t=>{if(t.statusCode===404){const P=new x.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=P,this._headersCapability.reject(P);return}this._headersCapability.resolve(),this._setReadableStream(t);const r=d(P=>this._readableStream.headers[P.toLowerCase()],"getResponseHeader"),{allowRangeRequests:s,suggestedLength:m}=(0,B.validateRangeRequestCapabilities)({getResponseHeader:r,isHttp:p.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=s,this._contentLength=m||this._contentLength,this._filename=(0,B.extractFilenameFromHeader)(r)},"handleResponse");this._request=null,this._url.protocol==="http:"?this._request=G.request(i(this._url,p.httpHeaders),e):this._request=L.request(i(this._url,p.httpHeaders),e),this._request.on("error",t=>{this._storedError=t,this._headersCapability.reject(t)}),this._request.end()}}d(c,"PDFNodeStreamFullReader");class n extends g{constructor(p,e,t){super(p),this._httpHeaders={};for(const s in p.httpHeaders){const m=p.httpHeaders[s];m!==void 0&&(this._httpHeaders[s]=m)}this._httpHeaders.Range=`bytes=${e}-${t-1}`;const r=d(s=>{if(s.statusCode===404){const m=new x.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=m;return}this._setReadableStream(s)},"handleResponse");this._request=null,this._url.protocol==="http:"?this._request=G.request(i(this._url,this._httpHeaders),r):this._request=L.request(i(this._url,this._httpHeaders),r),this._request.on("error",s=>{this._storedError=s}),this._request.end()}}d(n,"PDFNodeStreamRangeReader");class o extends S{constructor(p){super(p);let e=decodeURIComponent(this._url.path);f.test(this._url.href)&&(e=e.replace(/^\//,"")),ue.lstat(e,(t,r)=>{if(t){t.code==="ENOENT"&&(t=new x.MissingPDFException(`Missing PDF "${e}".`)),this._storedError=t,this._headersCapability.reject(t);return}this._contentLength=r.size,this._setReadableStream(ue.createReadStream(e)),this._headersCapability.resolve()})}}d(o,"PDFNodeStreamFsFullReader");class E extends g{constructor(p,e,t){super(p);let r=decodeURIComponent(this._url.path);f.test(this._url.href)&&(r=r.replace(/^\//,"")),this._setReadableStream(ue.createReadStream(r,{start:e,end:t-1}))}}d(E,"PDFNodeStreamFsRangeReader")},(ae,C,de)=>{Object.defineProperty(C,"__esModule",{value:!0}),C.createResponseStatusError=I,C.extractFilenameFromHeader=L,C.validateRangeRequestCapabilities=G,C.validateResponseStatus=f;var x=de(1),B=de(23),ue=de(6);function G({getResponseHeader:l,isHttp:w,rangeChunkSize:S,disableRange:g}){const i={allowRangeRequests:!1,suggestedLength:void 0},c=parseInt(l("Content-Length"),10);return!Number.isInteger(c)||(i.suggestedLength=c,c<=2*S)||g||!w||l("Accept-Ranges")!=="bytes"||(l("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}d(G,"validateRangeRequestCapabilities");function L(l){const w=l("Content-Disposition");if(w){let S=(0,B.getFilenameFromContentDispositionHeader)(w);if(S.includes("%"))try{S=decodeURIComponent(S)}catch{}if((0,ue.isPdfFile)(S))return S}return null}d(L,"extractFilenameFromHeader");function I(l,w){return l===404||l===0&&w.startsWith("file:")?new x.MissingPDFException('Missing PDF "'+w+'".'):new x.UnexpectedResponseException(`Unexpected server response (${l}) while retrieving PDF "${w}".`,l)}d(I,"createResponseStatusError");function f(l){return l===200||l===206}d(f,"validateResponseStatus")},(ae,C,de)=>{Object.defineProperty(C,"__esModule",{value:!0}),C.getFilenameFromContentDispositionHeader=B;var x=de(1);function B(ue){let G=!0,L=I("filename\\*","i").exec(ue);if(L){L=L[1];let c=S(L);return c=unescape(c),c=g(c),c=i(c),l(c)}if(L=w(ue),L){const c=i(L);return l(c)}if(L=I("filename","i").exec(ue),L){L=L[1];let c=S(L);return c=i(c),l(c)}function I(c,n){return new RegExp("(?:^|;)\\s*"+c+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',n)}d(I,"toParamRegExp");function f(c,n){if(c){if(!/^[\x00-\xFF]+$/.test(n))return n;try{const o=new TextDecoder(c,{fatal:!0}),E=(0,x.stringToBytes)(n);n=o.decode(E),G=!1}catch{}}return n}d(f,"textdecode");function l(c){return G&&/[\x80-\xff]/.test(c)&&(c=f("utf-8",c),G&&(c=f("iso-8859-1",c))),c}d(l,"fixupEncoding");function w(c){const n=[];let o;const E=I("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(o=E.exec(c))!==null;){let[,p,e,t]=o;if(p=parseInt(p,10),p in n){if(p===0)break;continue}n[p]=[e,t]}const b=[];for(let p=0;p<n.length&&p in n;++p){let[e,t]=n[p];t=S(t),e&&(t=unescape(t),p===0&&(t=g(t))),b.push(t)}return b.join("")}d(w,"rfc2231getparam");function S(c){if(c.startsWith('"')){const n=c.slice(1).split('\\"');for(let o=0;o<n.length;++o){const E=n[o].indexOf('"');E!==-1&&(n[o]=n[o].slice(0,E),n.length=o+1),n[o]=n[o].replaceAll(/\\(.)/g,"$1")}c=n.join('"')}return c}d(S,"rfc2616unquote");function g(c){const n=c.indexOf("'");if(n===-1)return c;const o=c.slice(0,n),b=c.slice(n+1).replace(/^[^']*'/,"");return f(o,b)}d(g,"rfc5987decode");function i(c){return!c.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(c)?c:c.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(n,o,E,b){if(E==="q"||E==="Q")return b=b.replaceAll("_"," "),b=b.replaceAll(/=([0-9a-fA-F]{2})/g,function(p,e){return String.fromCharCode(parseInt(e,16))}),f(o,b);try{b=atob(b)}catch{}return f(o,b)})}return d(i,"rfc2047decode"),""}d(B,"getFilenameFromContentDispositionHeader")},(ae,C,de)=>{Object.defineProperty(C,"__esModule",{value:!0}),C.PDFNetworkStream=void 0;var x=de(1),B=de(22);const ue=200,G=206;function L(S){const g=S.response;return typeof g!="string"?g:(0,x.stringToBytes)(g).buffer}d(L,"getArrayBuffer");class I{constructor(g,i={}){this.url=g,this.isHttp=/^https?:/i.test(g),this.httpHeaders=this.isHttp&&i.httpHeaders||Object.create(null),this.withCredentials=i.withCredentials||!1,this.getXhr=i.getXhr||d(function(){return new XMLHttpRequest},"NetworkManager_getXhr"),this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(g,i,c){const n={begin:g,end:i};for(const o in c)n[o]=c[o];return this.request(n)}requestFull(g){return this.request(g)}request(g){const i=this.getXhr(),c=this.currXhrId++,n=this.pendingRequests[c]={xhr:i};i.open("GET",this.url),i.withCredentials=this.withCredentials;for(const o in this.httpHeaders){const E=this.httpHeaders[o];E!==void 0&&i.setRequestHeader(o,E)}return this.isHttp&&"begin"in g&&"end"in g?(i.setRequestHeader("Range",`bytes=${g.begin}-${g.end-1}`),n.expectedStatus=G):n.expectedStatus=ue,i.responseType="arraybuffer",g.onError&&(i.onerror=function(o){g.onError(i.status)}),i.onreadystatechange=this.onStateChange.bind(this,c),i.onprogress=this.onProgress.bind(this,c),n.onHeadersReceived=g.onHeadersReceived,n.onDone=g.onDone,n.onError=g.onError,n.onProgress=g.onProgress,i.send(null),c}onProgress(g,i){var n;const c=this.pendingRequests[g];c&&((n=c.onProgress)==null||n.call(c,i))}onStateChange(g,i){var p,e,t;const c=this.pendingRequests[g];if(!c)return;const n=c.xhr;if(n.readyState>=2&&c.onHeadersReceived&&(c.onHeadersReceived(),delete c.onHeadersReceived),n.readyState!==4||!(g in this.pendingRequests))return;if(delete this.pendingRequests[g],n.status===0&&this.isHttp){(p=c.onError)==null||p.call(c,n.status);return}const o=n.status||ue;if(!(o===ue&&c.expectedStatus===G)&&o!==c.expectedStatus){(e=c.onError)==null||e.call(c,n.status);return}const b=L(n);if(o===G){const r=n.getResponseHeader("Content-Range"),s=/bytes (\d+)-(\d+)\/(\d+)/.exec(r);c.onDone({begin:parseInt(s[1],10),chunk:b})}else b?c.onDone({begin:0,chunk:b}):(t=c.onError)==null||t.call(c,n.status)}getRequestXhr(g){return this.pendingRequests[g].xhr}isPendingRequest(g){return g in this.pendingRequests}abortRequest(g){const i=this.pendingRequests[g].xhr;delete this.pendingRequests[g],i.abort()}}d(I,"NetworkManager");class f{constructor(g){this._source=g,this._manager=new I(g.url,{httpHeaders:g.httpHeaders,withCredentials:g.withCredentials}),this._rangeChunkSize=g.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(g){const i=this._rangeRequestReaders.indexOf(g);i>=0&&this._rangeRequestReaders.splice(i,1)}getFullReader(){return(0,x.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new l(this._manager,this._source),this._fullRequestReader}getRangeReader(g,i){const c=new w(this._manager,g,i);return c.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(c),c}cancelAllRequests(g){var i;(i=this._fullRequestReader)==null||i.cancel(g);for(const c of this._rangeRequestReaders.slice(0))c.cancel(g)}}d(f,"PDFNetworkStream"),C.PDFNetworkStream=f;class l{constructor(g,i){this._manager=g;const c={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=i.url,this._fullRequestId=g.requestFull(c),this._headersReceivedCapability=(0,x.createPromiseCapability)(),this._disableRange=i.disableRange||!1,this._contentLength=i.length,this._rangeChunkSize=i.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const g=this._fullRequestId,i=this._manager.getRequestXhr(g),c=d(E=>i.getResponseHeader(E),"getResponseHeader"),{allowRangeRequests:n,suggestedLength:o}=(0,B.validateRangeRequestCapabilities)({getResponseHeader:c,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});n&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=(0,B.extractFilenameFromHeader)(c),this._isRangeSupported&&this._manager.abortRequest(g),this._headersReceivedCapability.resolve()}_onDone(g){if(g&&(this._requests.length>0?this._requests.shift().resolve({value:g.chunk,done:!1}):this._cachedChunks.push(g.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(g){this._storedError=(0,B.createResponseStatusError)(g,this._url),this._headersReceivedCapability.reject(this._storedError);for(const i of this._requests)i.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(g){var i;(i=this.onProgress)==null||i.call(this,{loaded:g.loaded,total:g.lengthComputable?g.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const g=(0,x.createPromiseCapability)();return this._requests.push(g),g.promise}cancel(g){this._done=!0,this._headersReceivedCapability.reject(g);for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}d(l,"PDFNetworkStreamFullRequestReader");class w{constructor(g,i,c){this._manager=g;const n={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=g.url,this._requestId=g.requestRange(i,c,n),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var g;(g=this.onClosed)==null||g.call(this,this)}_onDone(g){const i=g.chunk;this._requests.length>0?this._requests.shift().resolve({value:i,done:!1}):this._queuedChunk=i,this._done=!0;for(const c of this._requests)c.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(g){this._storedError=(0,B.createResponseStatusError)(g,this._url);for(const i of this._requests)i.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(g){var i;this.isStreamingSupported||(i=this.onProgress)==null||i.call(this,{loaded:g.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const i=this._queuedChunk;return this._queuedChunk=null,{value:i,done:!1}}if(this._done)return{value:void 0,done:!0};const g=(0,x.createPromiseCapability)();return this._requests.push(g),g.promise}cancel(g){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}d(w,"PDFNetworkStreamRangeRequestReader")},(ae,C,de)=>{Object.defineProperty(C,"__esModule",{value:!0}),C.PDFFetchStream=void 0;var x=de(1),B=de(22);function ue(w,S,g){return{method:"GET",headers:w,signal:g.signal,mode:"cors",credentials:S?"include":"same-origin",redirect:"follow"}}d(ue,"createFetchOptions");function G(w){const S=new Headers;for(const g in w){const i=w[g];i!==void 0&&S.append(g,i)}return S}d(G,"createHeaders");function L(w){return w instanceof Uint8Array?w.buffer:w instanceof ArrayBuffer?w:((0,x.warn)(`getArrayBuffer - unexpected data format: ${w}`),new Uint8Array(w).buffer)}d(L,"getArrayBuffer");class I{constructor(S){this.source=S,this.isHttp=/^https?:/i.test(S.url),this.httpHeaders=this.isHttp&&S.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var S;return((S=this._fullRequestReader)==null?void 0:S._loaded)??0}getFullReader(){return(0,x.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new f(this),this._fullRequestReader}getRangeReader(S,g){if(g<=this._progressiveDataLength)return null;const i=new l(this,S,g);return this._rangeRequestReaders.push(i),i}cancelAllRequests(S){var g;(g=this._fullRequestReader)==null||g.cancel(S);for(const i of this._rangeRequestReaders.slice(0))i.cancel(S)}}d(I,"PDFFetchStream"),C.PDFFetchStream=I;class f{constructor(S){this._stream=S,this._reader=null,this._loaded=0,this._filename=null;const g=S.source;this._withCredentials=g.withCredentials||!1,this._contentLength=g.length,this._headersCapability=(0,x.createPromiseCapability)(),this._disableRange=g.disableRange||!1,this._rangeChunkSize=g.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!g.disableStream,this._isRangeSupported=!g.disableRange,this._headers=G(this._stream.httpHeaders);const i=g.url;fetch(i,ue(this._headers,this._withCredentials,this._abortController)).then(c=>{if(!(0,B.validateResponseStatus)(c.status))throw(0,B.createResponseStatusError)(c.status,i);this._reader=c.body.getReader(),this._headersCapability.resolve();const n=d(b=>c.headers.get(b),"getResponseHeader"),{allowRangeRequests:o,suggestedLength:E}=(0,B.validateRangeRequestCapabilities)({getResponseHeader:n,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=E||this._contentLength,this._filename=(0,B.extractFilenameFromHeader)(n),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new x.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;await this._headersCapability.promise;const{value:S,done:g}=await this._reader.read();return g?{value:S,done:g}:(this._loaded+=S.byteLength,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded,total:this._contentLength}),{value:L(S),done:!1})}cancel(S){var g;(g=this._reader)==null||g.cancel(S),this._abortController.abort()}}d(f,"PDFFetchStreamReader");class l{constructor(S,g,i){this._stream=S,this._reader=null,this._loaded=0;const c=S.source;this._withCredentials=c.withCredentials||!1,this._readCapability=(0,x.createPromiseCapability)(),this._isStreamingSupported=!c.disableStream,this._abortController=new AbortController,this._headers=G(this._stream.httpHeaders),this._headers.append("Range",`bytes=${g}-${i-1}`);const n=c.url;fetch(n,ue(this._headers,this._withCredentials,this._abortController)).then(o=>{if(!(0,B.validateResponseStatus)(o.status))throw(0,B.createResponseStatusError)(o.status,n);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;await this._readCapability.promise;const{value:S,done:g}=await this._reader.read();return g?{value:S,done:g}:(this._loaded+=S.byteLength,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded}),{value:L(S),done:!1})}cancel(S){var g;(g=this._reader)==null||g.cancel(S),this._abortController.abort()}}d(l,"PDFFetchStreamRangeReader")},(ae,C,de)=>{Object.defineProperty(C,"__esModule",{value:!0}),C.TextLayerRenderTask=void 0,C.renderTextLayer=c,C.updateTextLayer=n;var x=de(1),B=de(6);const ue=1e5,G=30,L=.8,I=new Map;function f(o,E){let b;if(E&&x.FeatureTest.isOffscreenCanvasSupported)b=new OffscreenCanvas(o,o).getContext("2d",{alpha:!1});else{const p=document.createElement("canvas");p.width=p.height=o,b=p.getContext("2d",{alpha:!1})}return b}d(f,"getCtx");function l(o,E){const b=I.get(o);if(b)return b;const p=f(G,E);p.font=`${G}px ${o}`;const e=p.measureText("");let t=e.fontBoundingBoxAscent,r=Math.abs(e.fontBoundingBoxDescent);if(t){const m=t/(t+r);return I.set(o,m),p.canvas.width=p.canvas.height=0,m}p.strokeStyle="red",p.clearRect(0,0,G,G),p.strokeText("g",0,0);let s=p.getImageData(0,0,G,G).data;r=0;for(let m=s.length-1-3;m>=0;m-=4)if(s[m]>0){r=Math.ceil(m/4/G);break}p.clearRect(0,0,G,G),p.strokeText("A",0,G),s=p.getImageData(0,0,G,G).data,t=0;for(let m=0,P=s.length;m<P;m+=4)if(s[m]>0){t=G-Math.floor(m/4/G);break}if(p.canvas.width=p.canvas.height=0,t){const m=t/(t+r);return I.set(o,m),m}return I.set(o,L),L}d(l,"getAscent");function w(o,E,b){const p=document.createElement("span"),e={angle:0,canvasWidth:0,hasText:E.str!=="",hasEOL:E.hasEOL,fontSize:0};o._textDivs.push(p);const t=x.Util.transform(o._transform,E.transform);let r=Math.atan2(t[1],t[0]);const s=b[E.fontName];s.vertical&&(r+=Math.PI/2);const m=Math.hypot(t[2],t[3]),P=m*l(s.fontFamily,o._isOffscreenCanvasSupported);let h,F;r===0?(h=t[4],F=t[5]-P):(h=t[4]+P*Math.sin(r),F=t[5]-P*Math.cos(r));const J="calc(var(--scale-factor)*",le=p.style;o._container===o._rootContainer?(le.left=`${(100*h/o._pageWidth).toFixed(2)}%`,le.top=`${(100*F/o._pageHeight).toFixed(2)}%`):(le.left=`${J}${h.toFixed(2)}px)`,le.top=`${J}${F.toFixed(2)}px)`),le.fontSize=`${J}${m.toFixed(2)}px)`,le.fontFamily=s.fontFamily,e.fontSize=m,p.setAttribute("role","presentation"),p.textContent=E.str,p.dir=E.dir,o._fontInspectorEnabled&&(p.dataset.fontName=E.fontName),r!==0&&(e.angle=r*(180/Math.PI));let q=!1;if(E.str.length>1)q=!0;else if(E.str!==" "&&E.transform[0]!==E.transform[3]){const re=Math.abs(E.transform[0]),fe=Math.abs(E.transform[3]);re!==fe&&Math.max(re,fe)/Math.min(re,fe)>1.5&&(q=!0)}q&&(e.canvasWidth=s.vertical?E.height:E.width),o._textDivProperties.set(p,e),o._isReadableStream&&o._layoutText(p)}d(w,"appendText");function S(o){const{div:E,scale:b,properties:p,ctx:e,prevFontSize:t,prevFontFamily:r}=o,{style:s}=E;let m="";if(p.canvasWidth!==0&&p.hasText){const{fontFamily:P}=s,{canvasWidth:h,fontSize:F}=p;(t!==F||r!==P)&&(e.font=`${F*b}px ${P}`,o.prevFontSize=F,o.prevFontFamily=P);const{width:J}=e.measureText(E.textContent);J>0&&(m=`scaleX(${h*b/J})`)}p.angle!==0&&(m=`rotate(${p.angle}deg) ${m}`),m.length>0&&(s.transform=m)}d(S,"layout");function g(o){if(o._canceled)return;const E=o._textDivs,b=o._capability;if(E.length>ue){b.resolve();return}if(!o._isReadableStream)for(const e of E)o._layoutText(e);b.resolve()}d(g,"render");class i{constructor({textContentSource:E,container:b,viewport:p,textDivs:e,textDivProperties:t,textContentItemsStr:r,isOffscreenCanvasSupported:s}){var J;this._textContentSource=E,this._isReadableStream=E instanceof ReadableStream,this._container=this._rootContainer=b,this._textDivs=e||[],this._textContentItemsStr=r||[],this._isOffscreenCanvasSupported=s,this._fontInspectorEnabled=!!((J=globalThis.FontInspector)!=null&&J.enabled),this._reader=null,this._textDivProperties=t||new WeakMap,this._canceled=!1,this._capability=(0,x.createPromiseCapability)(),this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:p.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:f(0,s)};const{pageWidth:m,pageHeight:P,pageX:h,pageY:F}=p.rawDims;this._transform=[1,0,0,-1,-h,F+P],this._pageWidth=m,this._pageHeight=P,(0,B.setLayerDimensions)(b,p),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new x.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new x.AbortException("TextLayer task cancelled."))}_processItems(E,b){for(const p of E){if(p.str===void 0){if(p.type==="beginMarkedContentProps"||p.type==="beginMarkedContent"){const e=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),p.id!==null&&this._container.setAttribute("id",`${p.id}`),e.append(this._container)}else p.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(p.str),w(this,p,b)}}_layoutText(E){const b=this._layoutTextParams.properties=this._textDivProperties.get(E);if(this._layoutTextParams.div=E,S(this._layoutTextParams),b.hasText&&this._container.append(E),b.hasEOL){const p=document.createElement("br");p.setAttribute("role","presentation"),this._container.append(p)}}_render(){const E=(0,x.createPromiseCapability)();let b=Object.create(null);if(this._isReadableStream){const p=d(()=>{this._reader.read().then(({value:e,done:t})=>{if(t){E.resolve();return}Object.assign(b,e.styles),this._processItems(e.items,b),p()},E.reject)},"pump");this._reader=this._textContentSource.getReader(),p()}else if(this._textContentSource){const{items:p,styles:e}=this._textContentSource;this._processItems(p,e),E.resolve()}else throw new Error('No "textContentSource" parameter specified.');E.promise.then(()=>{b=null,g(this)},this._capability.reject)}}d(i,"TextLayerRenderTask"),C.TextLayerRenderTask=i;function c(o){!o.textContentSource&&(o.textContent||o.textContentStream)&&((0,B.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),o.textContentSource=o.textContent||o.textContentStream);const{container:E,viewport:b}=o,p=getComputedStyle(E),e=p.getPropertyValue("visibility"),t=parseFloat(p.getPropertyValue("--scale-factor"));e==="visible"&&(!t||Math.abs(t-b.scale)>1e-15)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const r=new i(o);return r._render(),r}d(c,"renderTextLayer");function n({container:o,viewport:E,textDivs:b,textDivProperties:p,isOffscreenCanvasSupported:e,mustRotate:t=!0,mustRescale:r=!0}){if(t&&(0,B.setLayerDimensions)(o,{rotation:E.rotation}),r){const s=f(0,e),P={prevFontSize:null,prevFontFamily:null,div:null,scale:E.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:s};for(const h of b)P.properties=p.get(h),P.div=h,S(P)}}d(n,"updateTextLayer")},(ae,C,de)=>{var f,l,w,S,g,i,c,n,o,Ot,b,Ei,e,Dt,r,Nt;Object.defineProperty(C,"__esModule",{value:!0}),C.AnnotationEditorLayer=void 0;var x=de(1),B=de(5),ue=de(28),G=de(29),L=de(6);const m=class{constructor(h){Z(this,o);Z(this,b);Z(this,e);Z(this,r);Z(this,f,void 0);Z(this,l,!1);Z(this,w,this.pointerup.bind(this));Z(this,S,this.pointerdown.bind(this));Z(this,g,new Map);Z(this,i,!1);Z(this,c,!1);Z(this,n,void 0);m._initialized||(m._initialized=!0,ue.FreeTextEditor.initialize(h.l10n),G.InkEditor.initialize(h.l10n)),h.uiManager.registerEditorTypes([ue.FreeTextEditor,G.InkEditor]),ve(this,n,h.uiManager),this.pageIndex=h.pageIndex,this.div=h.div,ve(this,f,h.accessibilityManager),u(this,n).addLayer(this)}get isEmpty(){return u(this,g).size===0}updateToolbar(h){u(this,n).updateToolbar(h)}updateMode(h=u(this,n).getMode()){ee(this,r,Nt).call(this),h===x.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),u(this,n).unselectAll(),h!==x.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",h===x.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",h===x.AnnotationEditorType.INK),this.div.hidden=!1)}addInkEditorIfNeeded(h){if(!h&&u(this,n).getMode()!==x.AnnotationEditorType.INK)return;if(!h){for(const J of u(this,g).values())if(J.isEmpty()){J.setInBackground();return}}ee(this,e,Dt).call(this,{offsetX:0,offsetY:0}).setInBackground()}setEditingState(h){u(this,n).setEditingState(h)}addCommands(h){u(this,n).addCommands(h)}enable(){this.div.style.pointerEvents="auto";for(const h of u(this,g).values())h.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const h of u(this,g).values())h.disableEditing();ee(this,r,Nt).call(this),this.isEmpty&&(this.div.hidden=!0)}setActiveEditor(h){u(this,n).getActive()!==h&&u(this,n).setActiveEditor(h)}enableClick(){this.div.addEventListener("pointerdown",u(this,S)),this.div.addEventListener("pointerup",u(this,w))}disableClick(){this.div.removeEventListener("pointerdown",u(this,S)),this.div.removeEventListener("pointerup",u(this,w))}attach(h){u(this,g).set(h.id,h)}detach(h){var F;u(this,g).delete(h.id),(F=u(this,f))==null||F.removePointerInTextLayer(h.contentDiv)}remove(h){u(this,n).removeEditor(h),this.detach(h),h.div.style.display="none",setTimeout(()=>{h.div.style.display="",h.div.remove(),h.isAttachedToDOM=!1,document.activeElement===document.body&&u(this,n).focusMainContainer()},0),u(this,c)||this.addInkEditorIfNeeded(!1)}add(h){if(ee(this,o,Ot).call(this,h),u(this,n).addEditor(h),this.attach(h),!h.isAttachedToDOM){const F=h.render();this.div.append(F),h.isAttachedToDOM=!0}this.moveEditorInDOM(h),h.onceAdded(),u(this,n).addToAnnotationStorage(h)}moveEditorInDOM(h){var F;(F=u(this,f))==null||F.moveElementInDOM(this.div,h.div,h.contentDiv,!0)}addOrRebuild(h){h.needsToBeRebuilt()?h.rebuild():this.add(h)}addANewEditor(h){const F=d(()=>{this.addOrRebuild(h)},"cmd"),J=d(()=>{h.remove()},"undo");this.addCommands({cmd:F,undo:J,mustExec:!0})}addUndoableEditor(h){const F=d(()=>{this.addOrRebuild(h)},"cmd"),J=d(()=>{h.remove()},"undo");this.addCommands({cmd:F,undo:J,mustExec:!1})}getNextId(){return u(this,n).getId()}deserialize(h){switch(h.annotationType){case x.AnnotationEditorType.FREETEXT:return ue.FreeTextEditor.deserialize(h,this,u(this,n));case x.AnnotationEditorType.INK:return G.InkEditor.deserialize(h,this,u(this,n))}return null}setSelected(h){u(this,n).setSelected(h)}toggleSelected(h){u(this,n).toggleSelected(h)}isSelected(h){return u(this,n).isSelected(h)}unselect(h){u(this,n).unselect(h)}pointerup(h){const{isMac:F}=x.FeatureTest.platform;if(!(h.button!==0||h.ctrlKey&&F)&&h.target===this.div&&u(this,i)){if(ve(this,i,!1),!u(this,l)){ve(this,l,!0);return}ee(this,e,Dt).call(this,h)}}pointerdown(h){const{isMac:F}=x.FeatureTest.platform;if(h.button!==0||h.ctrlKey&&F||h.target!==this.div)return;ve(this,i,!0);const J=u(this,n).getActive();ve(this,l,!J||J.isEmpty())}drop(h){const F=h.dataTransfer.getData("text/plain"),J=u(this,n).getEditor(F);if(!J)return;h.preventDefault(),h.dataTransfer.dropEffect="move",ee(this,o,Ot).call(this,J);const le=this.div.getBoundingClientRect(),q=h.clientX-le.x,re=h.clientY-le.y;J.translate(q-J.startX,re-J.startY),this.moveEditorInDOM(J),J.div.focus()}dragover(h){h.preventDefault()}destroy(){var h,F;((h=u(this,n).getActive())==null?void 0:h.parent)===this&&u(this,n).setActiveEditor(null);for(const J of u(this,g).values())(F=u(this,f))==null||F.removePointerInTextLayer(J.contentDiv),J.setParent(null),J.isAttachedToDOM=!1,J.div.remove();this.div=null,u(this,g).clear(),u(this,n).removeLayer(this)}render({viewport:h}){this.viewport=h,(0,L.setLayerDimensions)(this.div,h),(0,B.bindEvents)(this,this.div,["dragover","drop"]);for(const F of u(this,n).getEditors(this.pageIndex))this.add(F);this.updateMode()}update({viewport:h}){u(this,n).commitOrRemove(),this.viewport=h,(0,L.setLayerDimensions)(this.div,{rotation:h.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:h,pageHeight:F}=this.viewport.rawDims;return[h,F]}};let I=m;d(I,"AnnotationEditorLayer"),f=new WeakMap,l=new WeakMap,w=new WeakMap,S=new WeakMap,g=new WeakMap,i=new WeakMap,c=new WeakMap,n=new WeakMap,o=new WeakSet,Ot=d(function(h){var F;h.parent!==this&&(this.attach(h),(F=h.parent)==null||F.detach(h),h.setParent(this),h.div&&h.isAttachedToDOM&&(h.div.remove(),this.div.append(h.div)))},"#changeParent"),b=new WeakSet,Ei=d(function(h){switch(u(this,n).getMode()){case x.AnnotationEditorType.FREETEXT:return new ue.FreeTextEditor(h);case x.AnnotationEditorType.INK:return new G.InkEditor(h)}return null},"#createNewEditor"),e=new WeakSet,Dt=d(function(h){const F=this.getNextId(),J=ee(this,b,Ei).call(this,{parent:this,id:F,x:h.offsetX,y:h.offsetY,uiManager:u(this,n)});return J&&this.add(J),J},"#createAndAddNewEditor"),r=new WeakSet,Nt=d(function(){ve(this,c,!0);for(const h of u(this,g).values())h.isEmpty()&&h.remove();ve(this,c,!1)},"#cleanup"),Ue(I,"_initialized",!1),C.AnnotationEditorLayer=I},(ae,C,de)=>{var L,I,f,l,w,S,g,i,c,n,Pi,E,Ci,p,wi,t,Bt;Object.defineProperty(C,"__esModule",{value:!0}),C.FreeTextEditor=void 0;var x=de(1),B=de(5),ue=de(4);const s=class extends ue.AnnotationEditor{constructor(h){super({...h,name:"freeTextEditor"});Z(this,n);Z(this,E);Z(this,p);Z(this,t);Z(this,L,this.editorDivBlur.bind(this));Z(this,I,this.editorDivFocus.bind(this));Z(this,f,this.editorDivInput.bind(this));Z(this,l,this.editorDivKeydown.bind(this));Z(this,w,void 0);Z(this,S,"");Z(this,g,`${this.id}-editor`);Z(this,i,!1);Z(this,c,void 0);ve(this,w,h.color||s._defaultColor||ue.AnnotationEditor._defaultLineColor),ve(this,c,h.fontSize||s._defaultFontSize)}static initialize(h){this._l10nPromise=new Map(["free_text2_default_content","editor_free_text2_aria_label"].map(J=>[J,h.get(J)]));const F=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(F.getPropertyValue("--freetext-padding"))}static updateDefaultParams(h,F){switch(h){case x.AnnotationEditorParamsType.FREETEXT_SIZE:s._defaultFontSize=F;break;case x.AnnotationEditorParamsType.FREETEXT_COLOR:s._defaultColor=F;break}}updateParams(h,F){switch(h){case x.AnnotationEditorParamsType.FREETEXT_SIZE:ee(this,n,Pi).call(this,F);break;case x.AnnotationEditorParamsType.FREETEXT_COLOR:ee(this,E,Ci).call(this,F);break}}static get defaultPropertiesToUpdate(){return[[x.AnnotationEditorParamsType.FREETEXT_SIZE,s._defaultFontSize],[x.AnnotationEditorParamsType.FREETEXT_COLOR,s._defaultColor||ue.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[x.AnnotationEditorParamsType.FREETEXT_SIZE,u(this,c)],[x.AnnotationEditorParamsType.FREETEXT_COLOR,u(this,w)]]}getInitialTranslation(){const h=this.parentScale;return[-s._internalPadding*h,-(s._internalPadding+u(this,c))*h]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(x.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",u(this,l)),this.editorDiv.addEventListener("focus",u(this,I)),this.editorDiv.addEventListener("blur",u(this,L)),this.editorDiv.addEventListener("input",u(this,f)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",u(this,g)),this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",u(this,l)),this.editorDiv.removeEventListener("focus",u(this,I)),this.editorDiv.removeEventListener("blur",u(this,L)),this.editorDiv.removeEventListener("input",u(this,f)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(h){super.focusin(h),h.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing"),super.remove()}commit(){this.isInEditMode()&&(super.commit(),u(this,i)||(ve(this,i,!0),this.parent.addUndoableEditor(this)),this.disableEditMode(),ve(this,S,ee(this,p,wi).call(this).trimEnd()),ee(this,t,Bt).call(this))}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(h){this.enableEditMode(),this.editorDiv.focus()}keydown(h){h.target===this.div&&h.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(h){s._keyboardManager.exec(this,h)}editorDivFocus(h){this.isEditing=!0}editorDivBlur(h){this.isEditing=!1}editorDivInput(h){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let h,F;this.width&&(h=this.x,F=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",u(this,g)),this.enableEditing(),s._l10nPromise.get("editor_free_text2_aria_label").then(le=>{var q;return(q=this.editorDiv)==null?void 0:q.setAttribute("aria-label",le)}),s._l10nPromise.get("free_text2_default_content").then(le=>{var q;return(q=this.editorDiv)==null?void 0:q.setAttribute("default-content",le)}),this.editorDiv.contentEditable=!0;const{style:J}=this.editorDiv;if(J.fontSize=`calc(${u(this,c)}px * var(--scale-factor))`,J.color=u(this,w),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,B.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[le,q]=this.parentDimensions;this.setAt(h*le,F*q,this.width*le,this.height*q);for(const re of u(this,S).split(`
`)){const fe=document.createElement("div");fe.append(re?document.createTextNode(re):document.createElement("br")),this.editorDiv.append(fe)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(h,F,J){const le=super.deserialize(h,F,J);return ve(le,c,h.fontSize),ve(le,w,x.Util.makeHexColor(...h.color)),ve(le,S,h.value),le}serialize(){if(this.isEmpty())return null;const h=s._internalPadding*this.parentScale,F=this.getRect(h,h),J=ue.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:u(this,w));return{annotationType:x.AnnotationEditorType.FREETEXT,color:J,fontSize:u(this,c),value:u(this,S),pageIndex:this.pageIndex,rect:F,rotation:this.rotation}}};let G=s;d(G,"FreeTextEditor"),L=new WeakMap,I=new WeakMap,f=new WeakMap,l=new WeakMap,w=new WeakMap,S=new WeakMap,g=new WeakMap,i=new WeakMap,c=new WeakMap,n=new WeakSet,Pi=d(function(h){const F=d(le=>{this.editorDiv.style.fontSize=`calc(${le}px * var(--scale-factor))`,this.translate(0,-(le-u(this,c))*this.parentScale),ve(this,c,le),ee(this,t,Bt).call(this)},"setFontsize"),J=u(this,c);this.addCommands({cmd:()=>{F(h)},undo:()=>{F(J)},mustExec:!0,type:x.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},"#updateFontSize"),E=new WeakSet,Ci=d(function(h){const F=u(this,w);this.addCommands({cmd:()=>{ve(this,w,this.editorDiv.style.color=h)},undo:()=>{ve(this,w,this.editorDiv.style.color=F)},mustExec:!0,type:x.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},"#updateColor"),p=new WeakSet,wi=d(function(){const h=this.editorDiv.getElementsByTagName("div");if(h.length===0)return this.editorDiv.innerText;const F=[];for(const J of h)F.push(J.innerText.replace(/\r\n?|\n/,""));return F.join(`
`)},"#extractText"),t=new WeakSet,Bt=d(function(){const[h,F]=this.parentDimensions;let J;if(this.isAttachedToDOM)J=this.div.getBoundingClientRect();else{const{currentLayer:le,div:q}=this,re=q.style.display;q.style.display="hidden",le.div.append(this.div),J=q.getBoundingClientRect(),q.remove(),q.style.display=re}this.width=J.width/h,this.height=J.height/F},"#setEditorDimensions"),Ue(G,"_freeTextDefaultContent",""),Ue(G,"_l10nPromise"),Ue(G,"_internalPadding",0),Ue(G,"_defaultColor",null),Ue(G,"_defaultFontSize",10),Ue(G,"_keyboardManager",new B.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],s.prototype.commitOrRemove]])),Ue(G,"_type","freetext"),C.FreeTextEditor=G},(ae,C,de)=>{var f,l,w,S,g,i,c,n,o,E,b,p,e,t,r,Ti,m,xi,h,Mi,J,Ri,q,Vt,fe,ki,me,Li,oe,Ii,A,Ke,R,Ut,H,bt,D,vt,te,at,N,jt,_,yt,k,Ht,$,Fi,X,Oi,pe,Di,_e,Wt,Pe,At,T,ot,M,$t;Object.defineProperty(C,"__esModule",{value:!0}),C.InkEditor=void 0,Object.defineProperty(C,"fitCurve",{enumerable:!0,get:function(){return ue.fitCurve}});var x=de(1),B=de(4),ue=de(30),G=de(5);const L=16,j=class extends B.AnnotationEditor{constructor(ie){super({...ie,name:"inkEditor"});Z(this,r);Z(this,m);Z(this,h);Z(this,J);Z(this,q);Z(this,fe);Z(this,me);Z(this,oe);Z(this,A);Z(this,R);Z(this,H);Z(this,D);Z(this,te);Z(this,N);Z(this,_);Z(this,$);Z(this,X);Z(this,pe);Z(this,_e);Z(this,Pe);Z(this,T);Z(this,M);Z(this,f,0);Z(this,l,0);Z(this,w,0);Z(this,S,this.canvasPointermove.bind(this));Z(this,g,this.canvasPointerleave.bind(this));Z(this,i,this.canvasPointerup.bind(this));Z(this,c,this.canvasPointerdown.bind(this));Z(this,n,!1);Z(this,o,!1);Z(this,E,null);Z(this,b,null);Z(this,p,0);Z(this,e,0);Z(this,t,null);this.color=ie.color||null,this.thickness=ie.thickness||null,this.opacity=ie.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(ie){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink2_aria_label"].map(ye=>[ye,ie.get(ye)]))}static updateDefaultParams(ie,ye){switch(ie){case x.AnnotationEditorParamsType.INK_THICKNESS:j._defaultThickness=ye;break;case x.AnnotationEditorParamsType.INK_COLOR:j._defaultColor=ye;break;case x.AnnotationEditorParamsType.INK_OPACITY:j._defaultOpacity=ye/100;break}}updateParams(ie,ye){switch(ie){case x.AnnotationEditorParamsType.INK_THICKNESS:ee(this,r,Ti).call(this,ye);break;case x.AnnotationEditorParamsType.INK_COLOR:ee(this,m,xi).call(this,ye);break;case x.AnnotationEditorParamsType.INK_OPACITY:ee(this,h,Mi).call(this,ye);break}}static get defaultPropertiesToUpdate(){return[[x.AnnotationEditorParamsType.INK_THICKNESS,j._defaultThickness],[x.AnnotationEditorParamsType.INK_COLOR,j._defaultColor||B.AnnotationEditor._defaultLineColor],[x.AnnotationEditorParamsType.INK_OPACITY,Math.round(j._defaultOpacity*100)]]}get propertiesToUpdate(){return[[x.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||j._defaultThickness],[x.AnnotationEditorParamsType.INK_COLOR,this.color||j._defaultColor||B.AnnotationEditor._defaultLineColor],[x.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??j._defaultOpacity))]]}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(ee(this,H,bt).call(this),ee(this,D,vt).call(this)),this.isAttachedToDOM||(this.parent.add(this),ee(this,te,at).call(this)),ee(this,T,ot).call(this))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,u(this,b).disconnect(),ve(this,b,null),super.remove())}setParent(ie){!this.parent&&ie?this._uiManager.removeShouldRescale(this):this.parent&&ie===null&&this._uiManager.addShouldRescale(this),super.setParent(ie)}onScaleChanging(){const[ie,ye]=this.parentDimensions,Me=this.width*ie,ge=this.height*ye;this.setDimensions(Me,ge)}enableEditMode(){u(this,n)||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",u(this,c)),this.canvas.addEventListener("pointerup",u(this,i)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",u(this,c)),this.canvas.removeEventListener("pointerup",u(this,i)))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){u(this,n)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),ve(this,n,!0),this.div.classList.add("disabled"),ee(this,T,ot).call(this,!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus({preventScroll:!0}))}focusin(ie){super.focusin(ie),this.enableEditMode()}canvasPointerdown(ie){ie.button!==0||!this.isInEditMode()||u(this,n)||(this.setInForeground(),ie.type!=="mouse"&&this.div.focus(),ie.stopPropagation(),this.canvas.addEventListener("pointerleave",u(this,g)),this.canvas.addEventListener("pointermove",u(this,S)),ee(this,fe,ki).call(this,ie.offsetX,ie.offsetY))}canvasPointermove(ie){ie.stopPropagation(),ee(this,me,Li).call(this,ie.offsetX,ie.offsetY)}canvasPointerup(ie){ie.button===0&&this.isInEditMode()&&this.currentPath.length!==0&&(ie.stopPropagation(),ee(this,R,Ut).call(this,ie),this.setInBackground())}canvasPointerleave(ie){ee(this,R,Ut).call(this,ie),this.setInBackground()}render(){if(this.div)return this.div;let ie,ye;this.width&&(ie=this.x,ye=this.y),super.render(),j._l10nPromise.get("editor_ink2_aria_label").then(xe=>{var we;return(we=this.div)==null?void 0:we.setAttribute("aria-label",xe)});const[Me,ge,Ae,Ce]=ee(this,J,Ri).call(this);if(this.setAt(Me,ge,0,0),this.setDims(Ae,Ce),ee(this,H,bt).call(this),this.width){const[xe,we]=this.parentDimensions;this.setAt(ie*xe,ye*we,this.width*xe,this.height*we),ve(this,o,!0),ee(this,te,at).call(this),this.setDims(this.width*xe,this.height*we),ee(this,A,Ke).call(this),ee(this,M,$t).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return ee(this,D,vt).call(this),this.div}setDimensions(ie,ye){const Me=Math.round(ie),ge=Math.round(ye);if(u(this,p)===Me&&u(this,e)===ge)return;ve(this,p,Me),ve(this,e,ge),this.canvas.style.visibility="hidden",u(this,f)&&Math.abs(u(this,f)-ie/ye)>.01&&(ye=Math.ceil(ie/u(this,f)),this.setDims(ie,ye));const[Ae,Ce]=this.parentDimensions;this.width=ie/Ae,this.height=ye/Ce,u(this,n)&&ee(this,N,jt).call(this,ie,ye),ee(this,te,at).call(this),ee(this,A,Ke).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(ie,ye,Me){var Ie,Oe;const ge=super.deserialize(ie,ye,Me);ge.thickness=ie.thickness,ge.color=x.Util.makeHexColor(...ie.color),ge.opacity=ie.opacity;const[Ae,Ce]=ge.pageDimensions,xe=ge.width*Ae,we=ge.height*Ce,Le=ge.parentScale,ke=ie.thickness/2;ve(ge,f,xe/we),ve(ge,n,!0),ve(ge,p,Math.round(xe)),ve(ge,e,Math.round(we));for(const{bezier:De}of ie.paths){const Ve=[];ge.paths.push(Ve);let Ne=Le*(De[0]-ke),Be=Le*(we-De[1]-ke);for(let $e=2,ze=De.length;$e<ze;$e+=6){const Qe=Le*(De[$e]-ke),Je=Le*(we-De[$e+1]-ke),it=Le*(De[$e+2]-ke),nt=Le*(we-De[$e+3]-ke),We=Le*(De[$e+4]-ke),ct=Le*(we-De[$e+5]-ke);Ve.push([[Ne,Be],[Qe,Je],[it,nt],[We,ct]]),Ne=We,Be=ct}const je=ee(this,k,Ht).call(this,Ve);ge.bezierPath2D.push(je)}const Fe=ee(Ie=ge,_e,Wt).call(Ie);return ve(ge,w,Math.max(L,Fe[2]-Fe[0])),ve(ge,l,Math.max(L,Fe[3]-Fe[1])),ee(Oe=ge,N,jt).call(Oe,xe,we),ge}serialize(){if(this.isEmpty())return null;const ie=this.getRect(0,0),ye=this.rotation%180===0?ie[3]-ie[1]:ie[2]-ie[0],Me=B.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:x.AnnotationEditorType.INK,color:Me,thickness:this.thickness,opacity:this.opacity,paths:ee(this,$,Fi).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,ye),pageIndex:this.pageIndex,rect:ie,rotation:this.rotation}}};let I=j;d(I,"InkEditor"),f=new WeakMap,l=new WeakMap,w=new WeakMap,S=new WeakMap,g=new WeakMap,i=new WeakMap,c=new WeakMap,n=new WeakMap,o=new WeakMap,E=new WeakMap,b=new WeakMap,p=new WeakMap,e=new WeakMap,t=new WeakMap,r=new WeakSet,Ti=d(function(ie){const ye=this.thickness;this.addCommands({cmd:()=>{this.thickness=ie,ee(this,T,ot).call(this)},undo:()=>{this.thickness=ye,ee(this,T,ot).call(this)},mustExec:!0,type:x.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},"#updateThickness"),m=new WeakSet,xi=d(function(ie){const ye=this.color;this.addCommands({cmd:()=>{this.color=ie,ee(this,A,Ke).call(this)},undo:()=>{this.color=ye,ee(this,A,Ke).call(this)},mustExec:!0,type:x.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},"#updateColor"),h=new WeakSet,Mi=d(function(ie){ie/=100;const ye=this.opacity;this.addCommands({cmd:()=>{this.opacity=ie,ee(this,A,Ke).call(this)},undo:()=>{this.opacity=ye,ee(this,A,Ke).call(this)},mustExec:!0,type:x.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},"#updateOpacity"),J=new WeakSet,Ri=d(function(){const{parentRotation:ie,parentDimensions:[ye,Me]}=this;switch(ie){case 90:return[0,Me,Me,ye];case 180:return[ye,Me,ye,Me];case 270:return[ye,0,Me,ye];default:return[0,0,ye,Me]}},"#getInitialBBox"),q=new WeakSet,Vt=d(function(){const{ctx:ie,color:ye,opacity:Me,thickness:ge,parentScale:Ae,scaleFactor:Ce}=this;ie.lineWidth=ge*Ae/Ce,ie.lineCap="round",ie.lineJoin="round",ie.miterLimit=10,ie.strokeStyle=`${ye}${(0,G.opacityToHex)(Me)}`},"#setStroke"),fe=new WeakSet,ki=d(function(ie,ye){this.isEditing=!0,u(this,o)||(ve(this,o,!0),ee(this,te,at).call(this),this.thickness||(this.thickness=j._defaultThickness),this.color||(this.color=j._defaultColor||B.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=j._defaultOpacity)),this.currentPath.push([ie,ye]),ve(this,E,null),ee(this,q,Vt).call(this),this.ctx.beginPath(),this.ctx.moveTo(ie,ye),ve(this,t,()=>{u(this,t)&&(u(this,E)&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):ee(this,A,Ke).call(this),this.ctx.lineTo(...u(this,E)),ve(this,E,null),this.ctx.stroke()),window.requestAnimationFrame(u(this,t)))}),window.requestAnimationFrame(u(this,t))},"#startDrawing"),me=new WeakSet,Li=d(function(ie,ye){const[Me,ge]=this.currentPath.at(-1);ie===Me&&ye===ge||(this.currentPath.push([ie,ye]),ve(this,E,[ie,ye]))},"#draw"),oe=new WeakSet,Ii=d(function(ie,ye){var Le;this.ctx.closePath(),ve(this,t,null),ie=Math.min(Math.max(ie,0),this.canvas.width),ye=Math.min(Math.max(ye,0),this.canvas.height);const[Me,ge]=this.currentPath.at(-1);(ie!==Me||ye!==ge)&&this.currentPath.push([ie,ye]);let Ae;if(this.currentPath.length!==1)Ae=(0,ue.fitCurve)(this.currentPath,30,null);else{const ke=[ie,ye];Ae=[[ke,ke.slice(),ke.slice(),ke]]}const Ce=ee(Le=j,k,Ht).call(Le,Ae);this.currentPath.length=0;const xe=d(()=>{this.paths.push(Ae),this.bezierPath2D.push(Ce),this.rebuild()},"cmd"),we=d(()=>{this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(ee(this,H,bt).call(this),ee(this,D,vt).call(this)),ee(this,T,ot).call(this))},"undo");this.addCommands({cmd:xe,undo:we,mustExec:!0})},"#stopDrawing"),A=new WeakSet,Ke=d(function(){if(this.isEmpty()){ee(this,_,yt).call(this);return}ee(this,q,Vt).call(this);const{canvas:ie,ctx:ye}=this;ye.setTransform(1,0,0,1,0,0),ye.clearRect(0,0,ie.width,ie.height),ee(this,_,yt).call(this);for(const Me of this.bezierPath2D)ye.stroke(Me)},"#redraw"),R=new WeakSet,Ut=d(function(ie){ee(this,oe,Ii).call(this,ie.offsetX,ie.offsetY),this.canvas.removeEventListener("pointerleave",u(this,g)),this.canvas.removeEventListener("pointermove",u(this,S)),this.addToAnnotationStorage()},"#endDrawing"),H=new WeakSet,bt=d(function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",j._l10nPromise.get("editor_ink_canvas_aria_label").then(ie=>{var ye;return(ye=this.canvas)==null?void 0:ye.setAttribute("aria-label",ie)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},"#createCanvas"),D=new WeakSet,vt=d(function(){ve(this,b,new ResizeObserver(ie=>{const ye=ie[0].contentRect;ye.width&&ye.height&&this.setDimensions(ye.width,ye.height)})),u(this,b).observe(this.div)},"#createObserver"),te=new WeakSet,at=d(function(){if(!u(this,o))return;const[ie,ye]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*ie),this.canvas.height=Math.ceil(this.height*ye),ee(this,_,yt).call(this)},"#setCanvasDims"),N=new WeakSet,jt=d(function(ie,ye){const Me=ee(this,Pe,At).call(this),ge=(ie-Me)/u(this,w),Ae=(ye-Me)/u(this,l);this.scaleFactor=Math.min(ge,Ae)},"#setScaleFactor"),_=new WeakSet,yt=d(function(){const ie=ee(this,Pe,At).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+ie,this.translationY*this.scaleFactor+ie)},"#updateTransform"),k=new WeakSet,Ht=d(function(ie){const ye=new Path2D;for(let Me=0,ge=ie.length;Me<ge;Me++){const[Ae,Ce,xe,we]=ie[Me];Me===0&&ye.moveTo(...Ae),ye.bezierCurveTo(Ce[0],Ce[1],xe[0],xe[1],we[0],we[1])}return ye},"#buildPath2D"),$=new WeakSet,Fi=d(function(ie,ye,Me,ge){const Ce=[],xe=this.thickness/2;let we,Le;for(const ke of this.paths){we=[],Le=[];for(let Fe=0,Ie=ke.length;Fe<Ie;Fe++){const[Oe,De,Ve,Ne]=ke[Fe],Be=ie*(Oe[0]+ye)+xe,je=ge-ie*(Oe[1]+Me)-xe,$e=ie*(De[0]+ye)+xe,ze=ge-ie*(De[1]+Me)-xe,Qe=ie*(Ve[0]+ye)+xe,Je=ge-ie*(Ve[1]+Me)-xe,it=ie*(Ne[0]+ye)+xe,nt=ge-ie*(Ne[1]+Me)-xe;Fe===0&&(we.push(Be,je),Le.push(Be,je)),we.push($e,ze,Qe,Je,it,nt),ee(this,X,Oi).call(this,Be,je,$e,ze,Qe,Je,it,nt,4,Le)}Ce.push({bezier:we,points:Le})}return Ce},"#serializePaths"),X=new WeakSet,Oi=d(function(ie,ye,Me,ge,Ae,Ce,xe,we,Le,ke){if(ee(this,pe,Di).call(this,ie,ye,Me,ge,Ae,Ce,xe,we)){ke.push(xe,we);return}for(let Fe=1;Fe<Le-1;Fe++){const Ie=Fe/Le,Oe=1-Ie;let De=Ie*ie+Oe*Me,Ve=Ie*ye+Oe*ge,Ne=Ie*Me+Oe*Ae,Be=Ie*ge+Oe*Ce;const je=Ie*Ae+Oe*xe,$e=Ie*Ce+Oe*we;De=Ie*De+Oe*Ne,Ve=Ie*Ve+Oe*Be,Ne=Ie*Ne+Oe*je,Be=Ie*Be+Oe*$e,De=Ie*De+Oe*Ne,Ve=Ie*Ve+Oe*Be,ke.push(De,Ve)}ke.push(xe,we)},"#extractPointsOnBezier"),pe=new WeakSet,Di=d(function(ie,ye,Me,ge,Ae,Ce,xe,we){const ke=(3*Me-2*ie-xe)**2,Fe=(3*ge-2*ye-we)**2,Ie=(3*Ae-ie-2*xe)**2,Oe=(3*Ce-ye-2*we)**2;return Math.max(ke,Ie)+Math.max(Fe,Oe)<=10},"#isAlmostFlat"),_e=new WeakSet,Wt=d(function(){let ie=1/0,ye=-1/0,Me=1/0,ge=-1/0;for(const Ae of this.paths)for(const[Ce,xe,we,Le]of Ae){const ke=x.Util.bezierBoundingBox(...Ce,...xe,...we,...Le);ie=Math.min(ie,ke[0]),Me=Math.min(Me,ke[1]),ye=Math.max(ye,ke[2]),ge=Math.max(ge,ke[3])}return[ie,Me,ye,ge]},"#getBbox"),Pe=new WeakSet,At=d(function(){return u(this,n)?Math.ceil(this.thickness*this.parentScale):0},"#getPadding"),T=new WeakSet,ot=d(function(ie=!1){if(this.isEmpty())return;if(!u(this,n)){ee(this,A,Ke).call(this);return}const ye=ee(this,_e,Wt).call(this),Me=ee(this,Pe,At).call(this);ve(this,w,Math.max(L,ye[2]-ye[0])),ve(this,l,Math.max(L,ye[3]-ye[1]));const ge=Math.ceil(Me+u(this,w)*this.scaleFactor),Ae=Math.ceil(Me+u(this,l)*this.scaleFactor),[Ce,xe]=this.parentDimensions;this.width=ge/Ce,this.height=Ae/xe,ve(this,f,ge/Ae),ee(this,M,$t).call(this);const we=this.translationX,Le=this.translationY;this.translationX=-ye[0],this.translationY=-ye[1],ee(this,te,at).call(this),ee(this,A,Ke).call(this),ve(this,p,ge),ve(this,e,Ae),this.setDims(ge,Ae);const ke=ie?Me/this.scaleFactor/2:0;this.translate(we-this.translationX-ke,Le-this.translationY-ke)},"#fitToContent"),M=new WeakSet,$t=d(function(){const{style:ie}=this.div;u(this,f)>=1?(ie.minHeight=`${L}px`,ie.minWidth=`${Math.round(u(this,f)*L)}px`):(ie.minWidth=`${L}px`,ie.minHeight=`${Math.round(L/u(this,f))}px`)},"#setMinDims"),Z(I,k),Ue(I,"_defaultColor",null),Ue(I,"_defaultOpacity",1),Ue(I,"_defaultThickness",1),Ue(I,"_l10nPromise"),Ue(I,"_type","ink"),C.InkEditor=I},(ae,C,de)=>{Object.defineProperty(C,"__esModule",{value:!0}),C.fitCurve=void 0;const x=de(31);C.fitCurve=x},ae=>{function C(i,c,n){if(!Array.isArray(i))throw new TypeError("First argument should be an array");if(i.forEach(p=>{if(!Array.isArray(p)||p.some(e=>typeof e!="number")||p.length!==i[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),i=i.filter((p,e)=>e===0||!p.every((t,r)=>t===i[e-1][r])),i.length<2)return[];const o=i.length,E=w(i[1],i[0]),b=w(i[o-2],i[o-1]);return de(i,E,b,c,n)}d(C,"fitCurve");function de(i,c,n,o,E){var p,e,t,r,s,m,P,h,F,J,le,q,re;if(i.length===2)return q=S.vectorLen(S.subtract(i[0],i[1]))/3,p=[i[0],S.addArrays(i[0],S.mulItems(c,q)),S.addArrays(i[1],S.mulItems(n,q)),i[1]],[p];if(e=L(i),[p,r,m]=x(i,e,e,c,n,E),r===0||r<o)return[p];if(r<o*o)for(t=e,s=r,P=m,re=0;re<20;re++){if(t=ue(p,i,t),[p,r,m]=x(i,e,t,c,n,E),r<o)return[p];if(m===P){let fe=r/s;if(fe>.9999&&fe<1.0001)break}s=r,P=m}return le=[],h=S.subtract(i[m-1],i[m+1]),h.every(fe=>fe===0)&&(h=S.subtract(i[m-1],i[m]),[h[0],h[1]]=[-h[1],h[0]]),F=S.normalize(h),J=S.mulItems(F,-1),le=le.concat(de(i.slice(0,m+1),c,F,o,E)),le=le.concat(de(i.slice(m),J,n,o,E)),le}d(de,"fitCubic");function x(i,c,n,o,E,b){var p,e,t;return p=B(i,n,o,E),[e,t]=I(i,p,c),b&&b({bez:p,points:i,params:c,maxErr:e,maxPoint:t}),[p,e,t]}d(x,"generateAndReport");function B(i,c,n,o){var E,b,p,e,t,r,s,m,P,h,F,J,le,q,re,fe,K,me=i[0],Ee=i[i.length-1];for(E=[me,null,null,Ee],b=S.zeros_Xx2x2(c.length),le=0,q=c.length;le<q;le++)fe=c[le],K=1-fe,p=b[le],p[0]=S.mulItems(n,3*fe*(K*K)),p[1]=S.mulItems(o,3*K*(fe*fe));for(e=[[0,0],[0,0]],t=[0,0],le=0,q=i.length;le<q;le++)fe=c[le],p=b[le],e[0][0]+=S.dot(p[0],p[0]),e[0][1]+=S.dot(p[0],p[1]),e[1][0]+=S.dot(p[0],p[1]),e[1][1]+=S.dot(p[1],p[1]),re=S.subtract(i[le],g.q([me,me,Ee,Ee],fe)),t[0]+=S.dot(p[0],re),t[1]+=S.dot(p[1],re);return r=e[0][0]*e[1][1]-e[1][0]*e[0][1],s=e[0][0]*t[1]-e[1][0]*t[0],m=t[0]*e[1][1]-t[1]*e[0][1],P=r===0?0:m/r,h=r===0?0:s/r,J=S.vectorLen(S.subtract(me,Ee)),F=1e-6*J,P<F||h<F?(E[1]=S.addArrays(me,S.mulItems(n,J/3)),E[2]=S.addArrays(Ee,S.mulItems(o,J/3))):(E[1]=S.addArrays(me,S.mulItems(n,P)),E[2]=S.addArrays(Ee,S.mulItems(o,h))),E}d(B,"generateBezier");function ue(i,c,n){return n.map((o,E)=>G(i,c[E],o))}d(ue,"reparameterize");function G(i,c,n){var o=S.subtract(g.q(i,n),c),E=g.qprime(i,n),b=S.mulMatrix(o,E),p=S.sum(S.squareItems(E))+2*S.mulMatrix(o,g.qprimeprime(i,n));return p===0?n:n-b/p}d(G,"newtonRaphsonRootFind");function L(i){var c=[],n,o,E;return i.forEach((b,p)=>{n=p?o+S.vectorLen(S.subtract(b,E)):0,c.push(n),o=n,E=b}),c=c.map(b=>b/o),c}d(L,"chordLengthParameterize");function I(i,c,n){var o,E,b,p,e,t,r,s;E=0,b=Math.floor(i.length/2);const m=f(c,10);for(e=0,t=i.length;e<t;e++)r=i[e],s=l(c,n[e],m,10),p=S.subtract(g.q(c,s),r),o=p[0]*p[0]+p[1]*p[1],o>E&&(E=o,b=e);return[E,b]}d(I,"computeMaxError");var f=d(function(i,c){for(var n,o=[0],E=i[0],b=0,p=1;p<=c;p++)n=g.q(i,p/c),b+=S.vectorLen(S.subtract(n,E)),o.push(b),E=n;return o=o.map(e=>e/b),o},"mapTtoRelativeDistances");function l(i,c,n,o){if(c<0)return 0;if(c>1)return 1;for(var E,b,p,e,t,r=1;r<=o;r++)if(c<=n[r]){e=(r-1)/o,p=r/o,b=n[r-1],E=n[r],t=(c-b)/(E-b)*(p-e)+e;break}return t}d(l,"find_t");function w(i,c){return S.normalize(S.subtract(i,c))}d(w,"createTangent");class S{static zeros_Xx2x2(c){for(var n=[];c--;)n.push([0,0]);return n}static mulItems(c,n){return c.map(o=>o*n)}static mulMatrix(c,n){return c.reduce((o,E,b)=>o+E*n[b],0)}static subtract(c,n){return c.map((o,E)=>o-n[E])}static addArrays(c,n){return c.map((o,E)=>o+n[E])}static addItems(c,n){return c.map(o=>o+n)}static sum(c){return c.reduce((n,o)=>n+o)}static dot(c,n){return S.mulMatrix(c,n)}static vectorLen(c){return Math.hypot(...c)}static divItems(c,n){return c.map(o=>o/n)}static squareItems(c){return c.map(n=>n*n)}static normalize(c){return this.divItems(c,this.vectorLen(c))}}d(S,"maths");class g{static q(c,n){var o=1-n,E=S.mulItems(c[0],o*o*o),b=S.mulItems(c[1],3*o*o*n),p=S.mulItems(c[2],3*o*n*n),e=S.mulItems(c[3],n*n*n);return S.addArrays(S.addArrays(E,b),S.addArrays(p,e))}static qprime(c,n){var o=1-n,E=S.mulItems(S.subtract(c[1],c[0]),3*o*o),b=S.mulItems(S.subtract(c[2],c[1]),6*o*n),p=S.mulItems(S.subtract(c[3],c[2]),3*n*n);return S.addArrays(S.addArrays(E,b),p)}static qprimeprime(c,n){return S.addArrays(S.mulItems(S.addArrays(S.subtract(c[2],S.mulItems(c[1],2)),c[0]),6*(1-n)),S.mulItems(S.addArrays(S.subtract(c[3],S.mulItems(c[2],2)),c[1]),6*n))}}d(g,"bezier"),ae.exports=C,ae.exports.fitCubic=de,ae.exports.createTangent=w},(ae,C,de)=>{var A,tt,R,Ni,ne,zt,Y,Gt;Object.defineProperty(C,"__esModule",{value:!0}),C.AnnotationLayer=void 0;var x=de(1),B=de(6),ue=de(3),G=de(33),L=de(34);const I=1e3,f=9,l=new WeakSet;function w(N){return{width:N[2]-N[0],height:N[3]-N[1]}}d(w,"getRectDims");class S{static create(a){switch(a.data.annotationType){case x.AnnotationType.LINK:return new i(a);case x.AnnotationType.TEXT:return new c(a);case x.AnnotationType.WIDGET:switch(a.data.fieldType){case"Tx":return new o(a);case"Btn":return a.data.radioButton?new b(a):a.data.checkBox?new E(a):new p(a);case"Ch":return new e(a)}return new n(a);case x.AnnotationType.POPUP:return new t(a);case x.AnnotationType.FREETEXT:return new s(a);case x.AnnotationType.LINE:return new m(a);case x.AnnotationType.SQUARE:return new P(a);case x.AnnotationType.CIRCLE:return new h(a);case x.AnnotationType.POLYLINE:return new F(a);case x.AnnotationType.CARET:return new le(a);case x.AnnotationType.INK:return new q(a);case x.AnnotationType.POLYGON:return new J(a);case x.AnnotationType.HIGHLIGHT:return new re(a);case x.AnnotationType.UNDERLINE:return new fe(a);case x.AnnotationType.SQUIGGLY:return new K(a);case x.AnnotationType.STRIKEOUT:return new me(a);case x.AnnotationType.STAMP:return new Ee(a);case x.AnnotationType.FILEATTACHMENT:return new oe(a);default:return new g(a)}}}d(S,"AnnotationElementFactory");class g{constructor(a,{isRenderable:_=!1,ignoreBorder:y=!1,createQuadrilaterals:k=!1}={}){this.isRenderable=_,this.data=a.data,this.layer=a.layer,this.page=a.page,this.viewport=a.viewport,this.linkService=a.linkService,this.downloadManager=a.downloadManager,this.imageResourcesPath=a.imageResourcesPath,this.renderForms=a.renderForms,this.svgFactory=a.svgFactory,this.annotationStorage=a.annotationStorage,this.enableScripting=a.enableScripting,this.hasJSActions=a.hasJSActions,this._fieldObjects=a.fieldObjects,_&&(this.container=this._createContainer(y)),k&&(this.quadrilaterals=this._createQuadrilaterals(y))}_createContainer(a=!1){const{data:_,page:y,viewport:k}=this,U=document.createElement("section");U.setAttribute("data-annotation-id",_.id),_.noRotate&&U.classList.add("norotate");const{pageWidth:$,pageHeight:he,pageX:X,pageY:Q}=k.rawDims,{width:pe,height:ce}=w(_.rect),_e=x.Util.normalizeRect([_.rect[0],y.view[3]-_.rect[1]+y.view[1],_.rect[2],y.view[3]-_.rect[3]+y.view[1]]);if(!a&&_.borderStyle.width>0){U.style.borderWidth=`${_.borderStyle.width}px`;const Pe=_.borderStyle.horizontalCornerRadius,Re=_.borderStyle.verticalCornerRadius;if(Pe>0||Re>0){const se=`calc(${Pe}px * var(--scale-factor)) / calc(${Re}px * var(--scale-factor))`;U.style.borderRadius=se}else if(this instanceof b){const se=`calc(${pe}px * var(--scale-factor)) / calc(${ce}px * var(--scale-factor))`;U.style.borderRadius=se}switch(_.borderStyle.style){case x.AnnotationBorderStyleType.SOLID:U.style.borderStyle="solid";break;case x.AnnotationBorderStyleType.DASHED:U.style.borderStyle="dashed";break;case x.AnnotationBorderStyleType.BEVELED:(0,x.warn)("Unimplemented border style: beveled");break;case x.AnnotationBorderStyleType.INSET:(0,x.warn)("Unimplemented border style: inset");break;case x.AnnotationBorderStyleType.UNDERLINE:U.style.borderBottomStyle="solid";break}const T=_.borderColor||null;T?U.style.borderColor=x.Util.makeHexColor(T[0]|0,T[1]|0,T[2]|0):U.style.borderWidth=0}U.style.left=`${100*(_e[0]-X)/$}%`,U.style.top=`${100*(_e[1]-Q)/he}%`;const{rotation:Se}=_;return _.hasOwnCanvas||Se===0?(U.style.width=`${100*pe/$}%`,U.style.height=`${100*ce/he}%`):this.setRotation(Se,U),U}setRotation(a,_=this.container){const{pageWidth:y,pageHeight:k}=this.viewport.rawDims,{width:U,height:$}=w(this.data.rect);let he,X;a%180===0?(he=100*U/y,X=100*$/k):(he=100*$/y,X=100*U/k),_.style.width=`${he}%`,_.style.height=`${X}%`,_.setAttribute("data-main-rotation",(360-a)%360)}get _commonActions(){const a=d((_,y,k)=>{const U=k.detail[_];k.target.style[y]=G.ColorConverters[`${U[0]}_HTML`](U.slice(1))},"setColor");return(0,x.shadow)(this,"_commonActions",{display:_=>{const y=_.detail.display%2===1;this.container.style.visibility=y?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:y,print:_.detail.display===0||_.detail.display===3})},print:_=>{this.annotationStorage.setValue(this.data.id,{print:_.detail.print})},hidden:_=>{this.container.style.visibility=_.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:_.detail.hidden})},focus:_=>{setTimeout(()=>_.target.focus({preventScroll:!1}),0)},userName:_=>{_.target.title=_.detail.userName},readonly:_=>{_.detail.readonly?_.target.setAttribute("readonly",""):_.target.removeAttribute("readonly")},required:_=>{this._setRequired(_.target,_.detail.required)},bgColor:_=>{a("bgColor","backgroundColor",_)},fillColor:_=>{a("fillColor","backgroundColor",_)},fgColor:_=>{a("fgColor","color",_)},textColor:_=>{a("textColor","color",_)},borderColor:_=>{a("borderColor","borderColor",_)},strokeColor:_=>{a("strokeColor","borderColor",_)},rotation:_=>{const y=_.detail.rotation;this.setRotation(y),this.annotationStorage.setValue(this.data.id,{rotation:y})}})}_dispatchEventFromSandbox(a,_){const y=this._commonActions;for(const k of Object.keys(_.detail)){const U=a[k]||y[k];U==null||U(_)}}_setDefaultPropertiesFromJS(a){if(!this.enableScripting)return;const _=this.annotationStorage.getRawValue(this.data.id);if(!_)return;const y=this._commonActions;for(const[k,U]of Object.entries(_)){const $=y[k];if($){const he={detail:{[k]:U},target:a};$(he),delete _[k]}}}_createQuadrilaterals(a=!1){if(!this.data.quadPoints)return null;const _=[],y=this.data.rect;for(const k of this.data.quadPoints)this.data.rect=[k[2].x,k[2].y,k[1].x,k[1].y],_.push(this._createContainer(a));return this.data.rect=y,_}_createPopup(a,_){let y=this.container;this.quadrilaterals&&(a=a||this.quadrilaterals,y=this.quadrilaterals[0]),a||(a=document.createElement("div"),a.classList.add("popupTriggerArea"),y.append(a));const U=new r({container:y,trigger:a,color:_.color,titleObj:_.titleObj,modificationDate:_.modificationDate,contentsObj:_.contentsObj,richText:_.richText,hideWrapper:!0}).render();U.style.left="100%",y.append(U)}_renderQuadrilaterals(a){for(const _ of this.quadrilaterals)_.classList.add(a);return this.quadrilaterals}render(){(0,x.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(a,_=null){const y=[];if(this._fieldObjects){const k=this._fieldObjects[a];if(k)for(const{page:U,id:$,exportValues:he}of k){if(U===-1||$===_)continue;const X=typeof he=="string"?he:null,Q=document.querySelector(`[data-element-id="${$}"]`);if(Q&&!l.has(Q)){(0,x.warn)(`_getElementsByName - element not allowed: ${$}`);continue}y.push({id:$,exportValue:X,domElement:Q})}return y}for(const k of document.getElementsByName(a)){const{exportValue:U}=k,$=k.getAttribute("data-element-id");$!==_&&l.has(k)&&y.push({id:$,exportValue:U,domElement:k})}return y}}d(g,"AnnotationElement");class i extends g{constructor(_,y=null){super(_,{isRenderable:!0,ignoreBorder:!!(y!=null&&y.ignoreBorder),createQuadrilaterals:!0});Z(this,A);Z(this,R);this.isTooltipOnly=_.data.isTooltipOnly}render(){const{data:_,linkService:y}=this,k=document.createElement("a");k.setAttribute("data-element-id",_.id);let U=!1;return _.url?(y.addLinkAttributes(k,_.url,_.newWindow),U=!0):_.action?(this._bindNamedAction(k,_.action),U=!0):_.attachment?(this._bindAttachment(k,_.attachment),U=!0):_.setOCGState?(ee(this,R,Ni).call(this,k,_.setOCGState),U=!0):_.dest?(this._bindLink(k,_.dest),U=!0):(_.actions&&(_.actions.Action||_.actions["Mouse Up"]||_.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(k,_),U=!0),_.resetForm?(this._bindResetFormAction(k,_.resetForm),U=!0):this.isTooltipOnly&&!U&&(this._bindLink(k,""),U=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map(($,he)=>{const X=he===0?k:k.cloneNode();return $.append(X),$}):(this.container.classList.add("linkAnnotation"),U&&this.container.append(k),this.container)}_bindLink(_,y){_.href=this.linkService.getDestinationHash(y),_.onclick=()=>(y&&this.linkService.goToDestination(y),!1),(y||y==="")&&ee(this,A,tt).call(this)}_bindNamedAction(_,y){_.href=this.linkService.getAnchorUrl(""),_.onclick=()=>(this.linkService.executeNamedAction(y),!1),ee(this,A,tt).call(this)}_bindAttachment(_,y){_.href=this.linkService.getAnchorUrl(""),_.onclick=()=>{var k;return(k=this.downloadManager)==null||k.openOrDownloadData(this.container,y.content,y.filename),!1},ee(this,A,tt).call(this)}_bindJSAction(_,y){_.href=this.linkService.getAnchorUrl("");const k=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const U of Object.keys(y.actions)){const $=k.get(U);$&&(_[$]=()=>{var he;return(he=this.linkService.eventBus)==null||he.dispatch("dispatcheventinsandbox",{source:this,detail:{id:y.id,name:U}}),!1})}_.onclick||(_.onclick=()=>!1),ee(this,A,tt).call(this)}_bindResetFormAction(_,y){const k=_.onclick;if(k||(_.href=this.linkService.getAnchorUrl("")),ee(this,A,tt).call(this),!this._fieldObjects){(0,x.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),k||(_.onclick=()=>!1);return}_.onclick=()=>{var ce;k==null||k();const{fields:U,refs:$,include:he}=y,X=[];if(U.length!==0||$.length!==0){const _e=new Set($);for(const Se of U){const Pe=this._fieldObjects[Se]||[];for(const{id:Re}of Pe)_e.add(Re)}for(const Se of Object.values(this._fieldObjects))for(const Pe of Se)_e.has(Pe.id)===he&&X.push(Pe)}else for(const _e of Object.values(this._fieldObjects))X.push(..._e);const Q=this.annotationStorage,pe=[];for(const _e of X){const{id:Se}=_e;switch(pe.push(Se),_e.type){case"text":{const Re=_e.defaultValue||"";Q.setValue(Se,{value:Re});break}case"checkbox":case"radiobutton":{const Re=_e.defaultValue===_e.exportValues;Q.setValue(Se,{value:Re});break}case"combobox":case"listbox":{const Re=_e.defaultValue||"";Q.setValue(Se,{value:Re});break}default:continue}const Pe=document.querySelector(`[data-element-id="${Se}"]`);if(Pe){if(!l.has(Pe)){(0,x.warn)(`_bindResetFormAction - element not allowed: ${Se}`);continue}}else continue;Pe.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((ce=this.linkService.eventBus)==null||ce.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:pe,name:"ResetForm"}})),!1}}}d(i,"LinkAnnotationElement"),A=new WeakSet,tt=d(function(){this.container.setAttribute("data-internal-link","")},"#setInternalLink"),R=new WeakSet,Ni=d(function(_,y){_.href=this.linkService.getAnchorUrl(""),_.onclick=()=>(this.linkService.executeSetOCGState(y),!1),ee(this,A,tt).call(this)},"#bindSetOCGState");class c extends g{constructor(a){var y,k,U;const _=!!(a.data.hasPopup||(y=a.data.titleObj)!=null&&y.str||(k=a.data.contentsObj)!=null&&k.str||(U=a.data.richText)!=null&&U.str);super(a,{isRenderable:_})}render(){this.container.classList.add("textAnnotation");const a=document.createElement("img");return a.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",a.alt="[{{type}} Annotation]",a.dataset.l10nId="text_annotation_type",a.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(a,this.data),this.container.append(a),this.container}}d(c,"TextAnnotationElement");class n extends g{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(a){const{isWin:_,isMac:y}=x.FeatureTest.platform;return _&&a.ctrlKey||y&&a.metaKey}_setEventListener(a,_,y,k){_.includes("mouse")?a.addEventListener(_,U=>{var $;($=this.linkService.eventBus)==null||$.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:y,value:k(U),shift:U.shiftKey,modifier:this._getKeyModifier(U)}})}):a.addEventListener(_,U=>{var $;($=this.linkService.eventBus)==null||$.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:y,value:k(U)}})})}_setEventListeners(a,_,y){var k;for(const[U,$]of _)($==="Action"||(k=this.data.actions)!=null&&k[$])&&this._setEventListener(a,U,$,y)}_setBackgroundColor(a){const _=this.data.backgroundColor||null;a.style.backgroundColor=_===null?"transparent":x.Util.makeHexColor(_[0],_[1],_[2])}_setTextStyle(a){const _=["left","center","right"],{fontColor:y}=this.data.defaultAppearanceData,k=this.data.defaultAppearanceData.fontSize||f,U=a.style;let $;const he=2,X=d(Q=>Math.round(10*Q)/10,"roundToOneDecimal");if(this.data.multiLine){const Q=Math.abs(this.data.rect[3]-this.data.rect[1]-he),pe=Math.round(Q/(x.LINE_FACTOR*k))||1,ce=Q/pe;$=Math.min(k,X(ce/x.LINE_FACTOR))}else{const Q=Math.abs(this.data.rect[3]-this.data.rect[1]-he);$=Math.min(k,X(Q/x.LINE_FACTOR))}U.fontSize=`calc(${$}px * var(--scale-factor))`,U.color=x.Util.makeHexColor(y[0],y[1],y[2]),this.data.textAlignment!==null&&(U.textAlign=_[this.data.textAlignment])}_setRequired(a,_){_?a.setAttribute("required",!0):a.removeAttribute("required"),a.setAttribute("aria-required",_)}}d(n,"WidgetAnnotationElement");class o extends n{constructor(a){const _=a.renderForms||!a.data.hasAppearance&&!!a.data.fieldValue;super(a,{isRenderable:_})}setPropertyOnSiblings(a,_,y,k){const U=this.annotationStorage;for(const $ of this._getElementsByName(a.name,a.id))$.domElement&&($.domElement[_]=y),U.setValue($.id,{[k]:y})}render(){var k;const a=this.annotationStorage,_=this.data.id;this.container.classList.add("textWidgetAnnotation");let y=null;if(this.renderForms){const U=a.getValue(_,{value:this.data.fieldValue});let $=U.formattedValue||U.value||"";const he=a.getValue(_,{charLimit:this.data.maxLen}).charLimit;he&&$.length>he&&($=$.slice(0,he));const X={userValue:$,formattedValue:null,lastCommittedValue:null,commitKey:1};this.data.multiLine?(y=document.createElement("textarea"),y.textContent=$,this.data.doNotScroll&&(y.style.overflowY="hidden")):(y=document.createElement("input"),y.type="text",y.setAttribute("value",$),this.data.doNotScroll&&(y.style.overflowX="hidden")),l.add(y),y.setAttribute("data-element-id",_),y.disabled=this.data.readOnly,y.name=this.data.fieldName,y.tabIndex=I,this._setRequired(y,this.data.required),he&&(y.maxLength=he),y.addEventListener("input",pe=>{a.setValue(_,{value:pe.target.value}),this.setPropertyOnSiblings(y,"value",pe.target.value,"value")}),y.addEventListener("resetform",pe=>{const ce=this.data.defaultFieldValue??"";y.value=X.userValue=ce,X.formattedValue=null});let Q=d(pe=>{const{formattedValue:ce}=X;ce!=null&&(pe.target.value=ce),pe.target.scrollLeft=0},"blurListener");if(this.enableScripting&&this.hasJSActions){y.addEventListener("focus",ce=>{const{target:_e}=ce;X.userValue&&(_e.value=X.userValue),X.lastCommittedValue=_e.value,X.commitKey=1}),y.addEventListener("updatefromsandbox",ce=>{const _e={value(Se){X.userValue=Se.detail.value??"",a.setValue(_,{value:X.userValue.toString()}),Se.target.value=X.userValue},formattedValue(Se){const{formattedValue:Pe}=Se.detail;X.formattedValue=Pe,Pe!=null&&Se.target!==document.activeElement&&(Se.target.value=Pe),a.setValue(_,{formattedValue:Pe})},selRange(Se){Se.target.setSelectionRange(...Se.detail.selRange)},charLimit:Se=>{var se;const{charLimit:Pe}=Se.detail,{target:Re}=Se;if(Pe===0){Re.removeAttribute("maxLength");return}Re.setAttribute("maxLength",Pe);let T=X.userValue;!T||T.length<=Pe||(T=T.slice(0,Pe),Re.value=X.userValue=T,a.setValue(_,{value:T}),(se=this.linkService.eventBus)==null||se.dispatch("dispatcheventinsandbox",{source:this,detail:{id:_,name:"Keystroke",value:T,willCommit:!0,commitKey:1,selStart:Re.selectionStart,selEnd:Re.selectionEnd}}))}};this._dispatchEventFromSandbox(_e,ce)}),y.addEventListener("keydown",ce=>{var Pe;X.commitKey=1;let _e=-1;if(ce.key==="Escape"?_e=0:ce.key==="Enter"&&!this.data.multiLine?_e=2:ce.key==="Tab"&&(X.commitKey=3),_e===-1)return;const{value:Se}=ce.target;X.lastCommittedValue!==Se&&(X.lastCommittedValue=Se,X.userValue=Se,(Pe=this.linkService.eventBus)==null||Pe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:_,name:"Keystroke",value:Se,willCommit:!0,commitKey:_e,selStart:ce.target.selectionStart,selEnd:ce.target.selectionEnd}}))});const pe=Q;Q=null,y.addEventListener("blur",ce=>{var Se;if(!ce.relatedTarget)return;const{value:_e}=ce.target;X.userValue=_e,X.lastCommittedValue!==_e&&((Se=this.linkService.eventBus)==null||Se.dispatch("dispatcheventinsandbox",{source:this,detail:{id:_,name:"Keystroke",value:_e,willCommit:!0,commitKey:X.commitKey,selStart:ce.target.selectionStart,selEnd:ce.target.selectionEnd}})),pe(ce)}),(k=this.data.actions)!=null&&k.Keystroke&&y.addEventListener("beforeinput",ce=>{var O;X.lastCommittedValue=null;const{data:_e,target:Se}=ce,{value:Pe,selectionStart:Re,selectionEnd:T}=Se;let se=Re,M=T;switch(ce.inputType){case"deleteWordBackward":{const j=Pe.substring(0,Re).match(/\w*[^\w]*$/);j&&(se-=j[0].length);break}case"deleteWordForward":{const j=Pe.substring(Re).match(/^[^\w]*\w*/);j&&(M+=j[0].length);break}case"deleteContentBackward":Re===T&&(se-=1);break;case"deleteContentForward":Re===T&&(M+=1);break}ce.preventDefault(),(O=this.linkService.eventBus)==null||O.dispatch("dispatcheventinsandbox",{source:this,detail:{id:_,name:"Keystroke",value:Pe,change:_e||"",willCommit:!1,selStart:se,selEnd:M}})}),this._setEventListeners(y,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],ce=>ce.target.value)}if(Q&&y.addEventListener("blur",Q),this.data.comb){const ce=(this.data.rect[2]-this.data.rect[0])/he;y.classList.add("comb"),y.style.letterSpacing=`calc(${ce}px * var(--scale-factor) - 1ch)`}}else y=document.createElement("div"),y.textContent=this.data.fieldValue,y.style.verticalAlign="middle",y.style.display="table-cell";return this._setTextStyle(y),this._setBackgroundColor(y),this._setDefaultPropertiesFromJS(y),this.container.append(y),this.container}}d(o,"TextWidgetAnnotationElement");class E extends n{constructor(a){super(a,{isRenderable:a.renderForms})}render(){const a=this.annotationStorage,_=this.data,y=_.id;let k=a.getValue(y,{value:_.exportValue===_.fieldValue}).value;typeof k=="string"&&(k=k!=="Off",a.setValue(y,{value:k})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const U=document.createElement("input");return l.add(U),U.setAttribute("data-element-id",y),U.disabled=_.readOnly,this._setRequired(U,this.data.required),U.type="checkbox",U.name=_.fieldName,k&&U.setAttribute("checked",!0),U.setAttribute("exportValue",_.exportValue),U.tabIndex=I,U.addEventListener("change",$=>{const{name:he,checked:X}=$.target;for(const Q of this._getElementsByName(he,y)){const pe=X&&Q.exportValue===_.exportValue;Q.domElement&&(Q.domElement.checked=pe),a.setValue(Q.id,{value:pe})}a.setValue(y,{value:X})}),U.addEventListener("resetform",$=>{const he=_.defaultFieldValue||"Off";$.target.checked=he===_.exportValue}),this.enableScripting&&this.hasJSActions&&(U.addEventListener("updatefromsandbox",$=>{const he={value(X){X.target.checked=X.detail.value!=="Off",a.setValue(y,{value:X.target.checked})}};this._dispatchEventFromSandbox(he,$)}),this._setEventListeners(U,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],$=>$.target.checked)),this._setBackgroundColor(U),this._setDefaultPropertiesFromJS(U),this.container.append(U),this.container}}d(E,"CheckboxWidgetAnnotationElement");class b extends n{constructor(a){super(a,{isRenderable:a.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const a=this.annotationStorage,_=this.data,y=_.id;let k=a.getValue(y,{value:_.fieldValue===_.buttonValue}).value;typeof k=="string"&&(k=k!==_.buttonValue,a.setValue(y,{value:k}));const U=document.createElement("input");if(l.add(U),U.setAttribute("data-element-id",y),U.disabled=_.readOnly,this._setRequired(U,this.data.required),U.type="radio",U.name=_.fieldName,k&&U.setAttribute("checked",!0),U.tabIndex=I,U.addEventListener("change",$=>{const{name:he,checked:X}=$.target;for(const Q of this._getElementsByName(he,y))a.setValue(Q.id,{value:!1});a.setValue(y,{value:X})}),U.addEventListener("resetform",$=>{const he=_.defaultFieldValue;$.target.checked=he!=null&&he===_.buttonValue}),this.enableScripting&&this.hasJSActions){const $=_.buttonValue;U.addEventListener("updatefromsandbox",he=>{const X={value:Q=>{const pe=$===Q.detail.value;for(const ce of this._getElementsByName(Q.target.name)){const _e=pe&&ce.id===y;ce.domElement&&(ce.domElement.checked=_e),a.setValue(ce.id,{value:_e})}}};this._dispatchEventFromSandbox(X,he)}),this._setEventListeners(U,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],he=>he.target.checked)}return this._setBackgroundColor(U),this._setDefaultPropertiesFromJS(U),this.container.append(U),this.container}}d(b,"RadioButtonWidgetAnnotationElement");class p extends i{constructor(a){super(a,{ignoreBorder:a.data.hasAppearance})}render(){const a=super.render();a.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(a.title=this.data.alternativeText);const _=a.lastChild;return this.enableScripting&&this.hasJSActions&&_&&(this._setDefaultPropertiesFromJS(_),_.addEventListener("updatefromsandbox",y=>{this._dispatchEventFromSandbox({},y)})),a}}d(p,"PushButtonWidgetAnnotationElement");class e extends n{constructor(a){super(a,{isRenderable:a.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const a=this.annotationStorage,_=this.data.id,y=a.getValue(_,{value:this.data.fieldValue}),k=document.createElement("select");l.add(k),k.setAttribute("data-element-id",_),k.disabled=this.data.readOnly,this._setRequired(k,this.data.required),k.name=this.data.fieldName,k.tabIndex=I;let U=this.data.combo&&this.data.options.length>0;this.data.combo||(k.size=this.data.options.length,this.data.multiSelect&&(k.multiple=!0)),k.addEventListener("resetform",pe=>{const ce=this.data.defaultFieldValue;for(const _e of k.options)_e.selected=_e.value===ce});for(const pe of this.data.options){const ce=document.createElement("option");ce.textContent=pe.displayValue,ce.value=pe.exportValue,y.value.includes(pe.exportValue)&&(ce.setAttribute("selected",!0),U=!1),k.append(ce)}let $=null;if(U){const pe=document.createElement("option");pe.value=" ",pe.setAttribute("hidden",!0),pe.setAttribute("selected",!0),k.prepend(pe),$=d(()=>{pe.remove(),k.removeEventListener("input",$),$=null},"removeEmptyEntry"),k.addEventListener("input",$)}const he=d(pe=>{const ce=pe?"value":"textContent",{options:_e,multiple:Se}=k;return Se?Array.prototype.filter.call(_e,Pe=>Pe.selected).map(Pe=>Pe[ce]):_e.selectedIndex===-1?null:_e[_e.selectedIndex][ce]},"getValue");let X=he(!1);const Q=d(pe=>{const ce=pe.target.options;return Array.prototype.map.call(ce,_e=>({displayValue:_e.textContent,exportValue:_e.value}))},"getItems");return this.enableScripting&&this.hasJSActions?(k.addEventListener("updatefromsandbox",pe=>{const ce={value(_e){$==null||$();const Se=_e.detail.value,Pe=new Set(Array.isArray(Se)?Se:[Se]);for(const Re of k.options)Re.selected=Pe.has(Re.value);a.setValue(_,{value:he(!0)}),X=he(!1)},multipleSelection(_e){k.multiple=!0},remove(_e){const Se=k.options,Pe=_e.detail.remove;Se[Pe].selected=!1,k.remove(Pe),Se.length>0&&Array.prototype.findIndex.call(Se,T=>T.selected)===-1&&(Se[0].selected=!0),a.setValue(_,{value:he(!0),items:Q(_e)}),X=he(!1)},clear(_e){for(;k.length!==0;)k.remove(0);a.setValue(_,{value:null,items:[]}),X=he(!1)},insert(_e){const{index:Se,displayValue:Pe,exportValue:Re}=_e.detail.insert,T=k.children[Se],se=document.createElement("option");se.textContent=Pe,se.value=Re,T?T.before(se):k.append(se),a.setValue(_,{value:he(!0),items:Q(_e)}),X=he(!1)},items(_e){const{items:Se}=_e.detail;for(;k.length!==0;)k.remove(0);for(const Pe of Se){const{displayValue:Re,exportValue:T}=Pe,se=document.createElement("option");se.textContent=Re,se.value=T,k.append(se)}k.options.length>0&&(k.options[0].selected=!0),a.setValue(_,{value:he(!0),items:Q(_e)}),X=he(!1)},indices(_e){const Se=new Set(_e.detail.indices);for(const Pe of _e.target.options)Pe.selected=Se.has(Pe.index);a.setValue(_,{value:he(!0)}),X=he(!1)},editable(_e){_e.target.disabled=!_e.detail.editable}};this._dispatchEventFromSandbox(ce,pe)}),k.addEventListener("input",pe=>{var _e;const ce=he(!0);a.setValue(_,{value:ce}),pe.preventDefault(),(_e=this.linkService.eventBus)==null||_e.dispatch("dispatcheventinsandbox",{source:this,detail:{id:_,name:"Keystroke",value:X,changeEx:ce,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(k,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],pe=>pe.target.value)):k.addEventListener("input",function(pe){a.setValue(_,{value:he(!0)})}),this.data.combo&&this._setTextStyle(k),this._setBackgroundColor(k),this._setDefaultPropertiesFromJS(k),this.container.append(k),this.container}}d(e,"ChoiceWidgetAnnotationElement");const H=class extends g{constructor(a){var k,U,$;const{data:_}=a,y=!H.IGNORE_TYPES.has(_.parentType)&&!!((k=_.titleObj)!=null&&k.str||(U=_.contentsObj)!=null&&U.str||($=_.richText)!=null&&$.str);super(a,{isRenderable:y})}render(){this.container.classList.add("popupAnnotation");const a=this.layer.querySelectorAll(`[data-annotation-id="${this.data.parentId}"]`);if(a.length===0)return this.container;const _=new r({container:this.container,trigger:Array.from(a),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),y=this.page,k=x.Util.normalizeRect([this.data.parentRect[0],y.view[3]-this.data.parentRect[1]+y.view[1],this.data.parentRect[2],y.view[3]-this.data.parentRect[3]+y.view[1]]),U=k[0]+this.data.parentRect[2]-this.data.parentRect[0],$=k[1],{pageWidth:he,pageHeight:X,pageX:Q,pageY:pe}=this.viewport.rawDims;return this.container.style.left=`${100*(U-Q)/he}%`,this.container.style.top=`${100*($-pe)/X}%`,this.container.append(_.render()),this.container}};let t=H;d(t,"PopupAnnotationElement"),Ue(t,"IGNORE_TYPES",new Set(["Line","Square","Circle","PolyLine","Polygon","Ink"]));class r{constructor(a){this.container=a.container,this.trigger=a.trigger,this.color=a.color,this.titleObj=a.titleObj,this.modificationDate=a.modificationDate,this.contentsObj=a.contentsObj,this.richText=a.richText,this.hideWrapper=a.hideWrapper||!1,this.pinned=!1}render(){var he,X;const _=document.createElement("div");_.classList.add("popupWrapper"),this.hideElement=this.hideWrapper?_:this.container,this.hideElement.hidden=!0;const y=document.createElement("div");y.classList.add("popup");const k=this.color;if(k){const Q=.7*(255-k[0])+k[0],pe=.7*(255-k[1])+k[1],ce=.7*(255-k[2])+k[2];y.style.backgroundColor=x.Util.makeHexColor(Q|0,pe|0,ce|0)}const U=document.createElement("h1");U.dir=this.titleObj.dir,U.textContent=this.titleObj.str,y.append(U);const $=B.PDFDateString.toDateObject(this.modificationDate);if($){const Q=document.createElement("span");Q.classList.add("popupDate"),Q.textContent="{{date}}, {{time}}",Q.dataset.l10nId="annotation_date_string",Q.dataset.l10nArgs=JSON.stringify({date:$.toLocaleDateString(),time:$.toLocaleTimeString()}),y.append(Q)}if((he=this.richText)!=null&&he.str&&(!((X=this.contentsObj)!=null&&X.str)||this.contentsObj.str===this.richText.str))L.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:y}),y.lastChild.classList.add("richText","popupContent");else{const Q=this._formatContents(this.contentsObj);y.append(Q)}Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const Q of this.trigger)Q.addEventListener("click",this._toggle.bind(this)),Q.addEventListener("mouseover",this._show.bind(this,!1)),Q.addEventListener("mouseout",this._hide.bind(this,!1));return y.addEventListener("click",this._hide.bind(this,!0)),_.append(y),_}_formatContents({str:a,dir:_}){const y=document.createElement("p");y.classList.add("popupContent"),y.dir=_;const k=a.split(/(?:\r\n?|\n)/);for(let U=0,$=k.length;U<$;++U){const he=k[U];y.append(document.createTextNode(he)),U<$-1&&y.append(document.createElement("br"))}return y}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(a=!1){a&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(a=!0){a&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}d(r,"PopupElement");class s extends g{constructor(a){var y,k,U;const _=!!(a.data.hasPopup||(y=a.data.titleObj)!=null&&y.str||(k=a.data.contentsObj)!=null&&k.str||(U=a.data.richText)!=null&&U.str);super(a,{isRenderable:_,ignoreBorder:!0}),this.textContent=a.data.textContent}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const a=document.createElement("div");a.classList.add("annotationTextContent"),a.setAttribute("role","comment");for(const _ of this.textContent){const y=document.createElement("span");y.textContent=_,a.append(y)}this.container.append(a)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}d(s,"FreeTextAnnotationElement");class m extends g{constructor(a){var y,k,U;const _=!!(a.data.hasPopup||(y=a.data.titleObj)!=null&&y.str||(k=a.data.contentsObj)!=null&&k.str||(U=a.data.richText)!=null&&U.str);super(a,{isRenderable:_,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const a=this.data,{width:_,height:y}=w(a.rect),k=this.svgFactory.create(_,y,!0),U=this.svgFactory.createElement("svg:line");return U.setAttribute("x1",a.rect[2]-a.lineCoordinates[0]),U.setAttribute("y1",a.rect[3]-a.lineCoordinates[1]),U.setAttribute("x2",a.rect[2]-a.lineCoordinates[2]),U.setAttribute("y2",a.rect[3]-a.lineCoordinates[3]),U.setAttribute("stroke-width",a.borderStyle.width||1),U.setAttribute("stroke","transparent"),U.setAttribute("fill","transparent"),k.append(U),this.container.append(k),this._createPopup(U,a),this.container}}d(m,"LineAnnotationElement");class P extends g{constructor(a){var y,k,U;const _=!!(a.data.hasPopup||(y=a.data.titleObj)!=null&&y.str||(k=a.data.contentsObj)!=null&&k.str||(U=a.data.richText)!=null&&U.str);super(a,{isRenderable:_,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const a=this.data,{width:_,height:y}=w(a.rect),k=this.svgFactory.create(_,y,!0),U=a.borderStyle.width,$=this.svgFactory.createElement("svg:rect");return $.setAttribute("x",U/2),$.setAttribute("y",U/2),$.setAttribute("width",_-U),$.setAttribute("height",y-U),$.setAttribute("stroke-width",U||1),$.setAttribute("stroke","transparent"),$.setAttribute("fill","transparent"),k.append($),this.container.append(k),this._createPopup($,a),this.container}}d(P,"SquareAnnotationElement");class h extends g{constructor(a){var y,k,U;const _=!!(a.data.hasPopup||(y=a.data.titleObj)!=null&&y.str||(k=a.data.contentsObj)!=null&&k.str||(U=a.data.richText)!=null&&U.str);super(a,{isRenderable:_,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const a=this.data,{width:_,height:y}=w(a.rect),k=this.svgFactory.create(_,y,!0),U=a.borderStyle.width,$=this.svgFactory.createElement("svg:ellipse");return $.setAttribute("cx",_/2),$.setAttribute("cy",y/2),$.setAttribute("rx",_/2-U/2),$.setAttribute("ry",y/2-U/2),$.setAttribute("stroke-width",U||1),$.setAttribute("stroke","transparent"),$.setAttribute("fill","transparent"),k.append($),this.container.append(k),this._createPopup($,a),this.container}}d(h,"CircleAnnotationElement");class F extends g{constructor(a){var y,k,U;const _=!!(a.data.hasPopup||(y=a.data.titleObj)!=null&&y.str||(k=a.data.contentsObj)!=null&&k.str||(U=a.data.richText)!=null&&U.str);super(a,{isRenderable:_,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const a=this.data,{width:_,height:y}=w(a.rect),k=this.svgFactory.create(_,y,!0);let U=[];for(const he of a.vertices){const X=he.x-a.rect[0],Q=a.rect[3]-he.y;U.push(X+","+Q)}U=U.join(" ");const $=this.svgFactory.createElement(this.svgElementName);return $.setAttribute("points",U),$.setAttribute("stroke-width",a.borderStyle.width||1),$.setAttribute("stroke","transparent"),$.setAttribute("fill","transparent"),k.append($),this.container.append(k),this._createPopup($,a),this.container}}d(F,"PolylineAnnotationElement");class J extends F{constructor(a){super(a),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}d(J,"PolygonAnnotationElement");class le extends g{constructor(a){var y,k,U;const _=!!(a.data.hasPopup||(y=a.data.titleObj)!=null&&y.str||(k=a.data.contentsObj)!=null&&k.str||(U=a.data.richText)!=null&&U.str);super(a,{isRenderable:_,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),this.data.hasPopup||this._createPopup(null,this.data),this.container}}d(le,"CaretAnnotationElement");class q extends g{constructor(a){var y,k,U;const _=!!(a.data.hasPopup||(y=a.data.titleObj)!=null&&y.str||(k=a.data.contentsObj)!=null&&k.str||(U=a.data.richText)!=null&&U.str);super(a,{isRenderable:_,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const a=this.data,{width:_,height:y}=w(a.rect),k=this.svgFactory.create(_,y,!0);for(const U of a.inkLists){let $=[];for(const X of U){const Q=X.x-a.rect[0],pe=a.rect[3]-X.y;$.push(`${Q},${pe}`)}$=$.join(" ");const he=this.svgFactory.createElement(this.svgElementName);he.setAttribute("points",$),he.setAttribute("stroke-width",a.borderStyle.width||1),he.setAttribute("stroke","transparent"),he.setAttribute("fill","transparent"),this._createPopup(he,a),k.append(he)}return this.container.append(k),this.container}}d(q,"InkAnnotationElement");class re extends g{constructor(a){var y,k,U;const _=!!(a.data.hasPopup||(y=a.data.titleObj)!=null&&y.str||(k=a.data.contentsObj)!=null&&k.str||(U=a.data.richText)!=null&&U.str);super(a,{isRenderable:_,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.classList.add("highlightAnnotation"),this.container)}}d(re,"HighlightAnnotationElement");class fe extends g{constructor(a){var y,k,U;const _=!!(a.data.hasPopup||(y=a.data.titleObj)!=null&&y.str||(k=a.data.contentsObj)!=null&&k.str||(U=a.data.richText)!=null&&U.str);super(a,{isRenderable:_,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.classList.add("underlineAnnotation"),this.container)}}d(fe,"UnderlineAnnotationElement");class K extends g{constructor(a){var y,k,U;const _=!!(a.data.hasPopup||(y=a.data.titleObj)!=null&&y.str||(k=a.data.contentsObj)!=null&&k.str||(U=a.data.richText)!=null&&U.str);super(a,{isRenderable:_,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.classList.add("squigglyAnnotation"),this.container)}}d(K,"SquigglyAnnotationElement");class me extends g{constructor(a){var y,k,U;const _=!!(a.data.hasPopup||(y=a.data.titleObj)!=null&&y.str||(k=a.data.contentsObj)!=null&&k.str||(U=a.data.richText)!=null&&U.str);super(a,{isRenderable:_,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.classList.add("strikeoutAnnotation"),this.container)}}d(me,"StrikeOutAnnotationElement");class Ee extends g{constructor(a){var y,k,U;const _=!!(a.data.hasPopup||(y=a.data.titleObj)!=null&&y.str||(k=a.data.contentsObj)!=null&&k.str||(U=a.data.richText)!=null&&U.str);super(a,{isRenderable:_,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),this.data.hasPopup||this._createPopup(null,this.data),this.container}}d(Ee,"StampAnnotationElement");class oe extends g{constructor(a){var k;super(a,{isRenderable:!0});const{filename:_,content:y}=this.data.file;this.filename=(0,B.getFilenameFromUrl)(_,!0),this.content=y,(k=this.linkService.eventBus)==null||k.dispatch("fileattachmentannotation",{source:this,filename:_,content:y})}render(){var _,y;this.container.classList.add("fileAttachmentAnnotation");let a;return this.data.hasAppearance?a=document.createElement("div"):(a=document.createElement("img"),a.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(this.data.name)?"paperclip":"pushpin"}.svg`),a.classList.add("popupTriggerArea"),a.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&((_=this.data.titleObj)!=null&&_.str||(y=this.data.contentsObj)!=null&&y.str||this.data.richText)&&this._createPopup(a,this.data),this.container.append(a),this.container}_download(){var a;(a=this.downloadManager)==null||a.openOrDownloadData(this.container,this.content,this.filename)}}d(oe,"FileAttachmentAnnotationElement");const V=class{static render(a){var X,Q;const{annotations:_,div:y,viewport:k,accessibilityManager:U}=a;(0,B.setLayerDimensions)(y,k);const $={data:null,layer:y,page:a.page,viewport:k,linkService:a.linkService,downloadManager:a.downloadManager,imageResourcesPath:a.imageResourcesPath||"",renderForms:a.renderForms!==!1,svgFactory:new B.DOMSVGFactory,annotationStorage:a.annotationStorage||new ue.AnnotationStorage,enableScripting:a.enableScripting===!0,hasJSActions:a.hasJSActions,fieldObjects:a.fieldObjects};let he=0;for(const pe of _){if(pe.noHTML)continue;if(pe.annotationType!==x.AnnotationType.POPUP){const{width:Se,height:Pe}=w(pe.rect);if(Se<=0||Pe<=0)continue}$.data=pe;const ce=S.create($);if(!ce.isRenderable)continue;const _e=ce.render();if(pe.hidden&&(_e.style.visibility="hidden"),Array.isArray(_e))for(const Se of _e)Se.style.zIndex=he++,ee(X=V,ne,zt).call(X,Se,pe.id,y,U);else _e.style.zIndex=he++,ce instanceof t?y.prepend(_e):ee(Q=V,ne,zt).call(Q,_e,pe.id,y,U)}ee(this,Y,Gt).call(this,y,a.annotationCanvasMap)}static update(a){const{annotationCanvasMap:_,div:y,viewport:k}=a;(0,B.setLayerDimensions)(y,{rotation:k.rotation}),ee(this,Y,Gt).call(this,y,_),y.hidden=!1}};let W=V;d(W,"AnnotationLayer"),ne=new WeakSet,zt=d(function(a,_,y,k){const U=a.firstChild||a;U.id=`${B.AnnotationPrefix}${_}`,y.append(a),k==null||k.moveElementInDOM(y,a,U,!1)},"#appendElement"),Y=new WeakSet,Gt=d(function(a,_){if(_){for(const[y,k]of _){const U=a.querySelector(`[data-annotation-id="${y}"]`);if(!U)continue;const{firstChild:$}=U;$?$.nodeName==="CANVAS"?$.replaceWith(k):$.before(k):U.append(k)}_.clear()}},"#setAnnotationCanvasMap"),Z(W,ne),Z(W,Y),C.AnnotationLayer=W},(ae,C)=>{Object.defineProperty(C,"__esModule",{value:!0}),C.ColorConverters=void 0;function de(B){return Math.floor(Math.max(0,Math.min(1,B))*255).toString(16).padStart(2,"0")}d(de,"makeColorComp");class x{static CMYK_G([ue,G,L,I]){return["G",1-Math.min(1,.3*ue+.59*L+.11*G+I)]}static G_CMYK([ue]){return["CMYK",0,0,0,1-ue]}static G_RGB([ue]){return["RGB",ue,ue,ue]}static G_HTML([ue]){const G=de(ue);return`#${G}${G}${G}`}static RGB_G([ue,G,L]){return["G",.3*ue+.59*G+.11*L]}static RGB_HTML([ue,G,L]){const I=de(ue),f=de(G),l=de(L);return`#${I}${f}${l}`}static T_HTML(){return"#00000000"}static CMYK_RGB([ue,G,L,I]){return["RGB",1-Math.min(1,ue+I),1-Math.min(1,L+I),1-Math.min(1,G+I)]}static CMYK_HTML(ue){const G=this.CMYK_RGB(ue).slice(1);return this.RGB_HTML(G)}static RGB_CMYK([ue,G,L]){const I=1-ue,f=1-G,l=1-L,w=Math.min(I,f,l);return["CMYK",I,f,l,w]}}d(x,"ColorConverters"),C.ColorConverters=x},(ae,C,de)=>{Object.defineProperty(C,"__esModule",{value:!0}),C.XfaLayer=void 0;var x=de(19);class B{static setupStorage(G,L,I,f,l){const w=f.getValue(L,{value:null});switch(I.name){case"textarea":if(w.value!==null&&(G.textContent=w.value),l==="print")break;G.addEventListener("input",S=>{f.setValue(L,{value:S.target.value})});break;case"input":if(I.attributes.type==="radio"||I.attributes.type==="checkbox"){if(w.value===I.attributes.xfaOn?G.setAttribute("checked",!0):w.value===I.attributes.xfaOff&&G.removeAttribute("checked"),l==="print")break;G.addEventListener("change",S=>{f.setValue(L,{value:S.target.checked?S.target.getAttribute("xfaOn"):S.target.getAttribute("xfaOff")})})}else{if(w.value!==null&&G.setAttribute("value",w.value),l==="print")break;G.addEventListener("input",S=>{f.setValue(L,{value:S.target.value})})}break;case"select":if(w.value!==null)for(const S of I.children)S.attributes.value===w.value&&(S.attributes.selected=!0);G.addEventListener("input",S=>{const g=S.target.options,i=g.selectedIndex===-1?"":g[g.selectedIndex].value;f.setValue(L,{value:i})});break}}static setAttributes({html:G,element:L,storage:I=null,intent:f,linkService:l}){const{attributes:w}=L,S=G instanceof HTMLAnchorElement;w.type==="radio"&&(w.name=`${w.name}-${f}`);for(const[g,i]of Object.entries(w))if(i!=null)switch(g){case"class":i.length&&G.setAttribute(g,i.join(" "));break;case"dataId":break;case"id":G.setAttribute("data-element-id",i);break;case"style":Object.assign(G.style,i);break;case"textContent":G.textContent=i;break;default:(!S||g!=="href"&&g!=="newWindow")&&G.setAttribute(g,i)}S&&l.addLinkAttributes(G,w.href,w.newWindow),I&&w.dataId&&this.setupStorage(G,w.dataId,L,I)}static render(G){var c;const L=G.annotationStorage,I=G.linkService,f=G.xfaHtml,l=G.intent||"display",w=document.createElement(f.name);f.attributes&&this.setAttributes({html:w,element:f,intent:l,linkService:I});const S=[[f,-1,w]],g=G.div;if(g.append(w),G.viewport){const n=`matrix(${G.viewport.transform.join(",")})`;g.style.transform=n}l!=="richText"&&g.setAttribute("class","xfaLayer xfaFont");const i=[];for(;S.length>0;){const[n,o,E]=S.at(-1);if(o+1===n.children.length){S.pop();continue}const b=n.children[++S.at(-1)[1]];if(b===null)continue;const{name:p}=b;if(p==="#text"){const t=document.createTextNode(b.value);i.push(t),E.append(t);continue}let e;if((c=b==null?void 0:b.attributes)!=null&&c.xmlns?e=document.createElementNS(b.attributes.xmlns,p):e=document.createElement(p),E.append(e),b.attributes&&this.setAttributes({html:e,element:b,storage:L,intent:l,linkService:I}),b.children&&b.children.length>0)S.push([b,-1,e]);else if(b.value){const t=document.createTextNode(b.value);x.XfaText.shouldBuildText(p)&&i.push(t),e.append(t)}}for(const n of g.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))n.setAttribute("readOnly",!0);return{textDivs:i}}static update(G){const L=`matrix(${G.viewport.transform.join(",")})`;G.div.style.transform=L,G.div.hidden=!1}}d(B,"XfaLayer"),C.XfaLayer=B},(ae,C,de)=>{Object.defineProperty(C,"__esModule",{value:!0}),C.SVGGraphics=void 0;var x=de(6),B=de(1),ue=de(10);let G=d(class{constructor(){(0,B.unreachable)("Not implemented: SVGGraphics")}},"SVGGraphics");C.SVGGraphics=G;{let c=function(e){let t=[];const r=[];for(const s of e){if(s.fn==="save"){t.push({fnId:92,fn:"group",items:[]}),r.push(t),t=t.at(-1).items;continue}s.fn==="restore"?t=r.pop():t.push(s)}return t},n=function(e){if(Number.isInteger(e))return e.toString();const t=e.toFixed(10);let r=t.length-1;if(t[r]!=="0")return t;do r--;while(t[r]==="0");return t.substring(0,t[r]==="."?r:r+1)},o=function(e){if(e[4]===0&&e[5]===0){if(e[1]===0&&e[2]===0)return e[0]===1&&e[3]===1?"":`scale(${n(e[0])} ${n(e[3])})`;if(e[0]===e[3]&&e[1]===-e[2]){const t=Math.acos(e[0])*180/Math.PI;return`rotate(${n(t)})`}}else if(e[0]===1&&e[1]===0&&e[2]===0&&e[3]===1)return`translate(${n(e[4])} ${n(e[5])})`;return`matrix(${n(e[0])} ${n(e[1])} ${n(e[2])} ${n(e[3])} ${n(e[4])} ${n(e[5])})`};d(c,"opListToTree"),d(n,"pf"),d(o,"pm");const L={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},I="http://www.w3.org/XML/1998/namespace",f="http://www.w3.org/1999/xlink",l=["butt","round","square"],w=["miter","round","bevel"],S=d(function(e,t="",r=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!r)return URL.createObjectURL(new Blob([e],{type:t}));const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let m=`data:${t};base64,`;for(let P=0,h=e.length;P<h;P+=3){const F=e[P]&255,J=e[P+1]&255,le=e[P+2]&255,q=F>>2,re=(F&3)<<4|J>>4,fe=P+1<h?(J&15)<<2|le>>6:64,K=P+2<h?le&63:64;m+=s[q]+s[re]+s[fe]+s[K]}return m},"createObjectURL"),g=function(){const e=new Uint8Array([137,80,78,71,13,10,26,10]),t=12,r=new Int32Array(256);for(let le=0;le<256;le++){let q=le;for(let re=0;re<8;re++)q&1?q=3988292384^q>>1&2147483647:q=q>>1&2147483647;r[le]=q}function s(le,q,re){let fe=-1;for(let K=q;K<re;K++){const me=(fe^le[K])&255,Ee=r[me];fe=fe>>>8^Ee}return fe^-1}d(s,"crc32");function m(le,q,re,fe){let K=fe;const me=q.length;re[K]=me>>24&255,re[K+1]=me>>16&255,re[K+2]=me>>8&255,re[K+3]=me&255,K+=4,re[K]=le.charCodeAt(0)&255,re[K+1]=le.charCodeAt(1)&255,re[K+2]=le.charCodeAt(2)&255,re[K+3]=le.charCodeAt(3)&255,K+=4,re.set(q,K),K+=q.length;const Ee=s(re,fe+4,K);re[K]=Ee>>24&255,re[K+1]=Ee>>16&255,re[K+2]=Ee>>8&255,re[K+3]=Ee&255}d(m,"writePngChunk");function P(le,q,re){let fe=1,K=0;for(let me=q;me<re;++me)fe=(fe+(le[me]&255))%65521,K=(K+fe)%65521;return K<<16|fe}d(P,"adler32");function h(le){if(!ue.isNodeJS)return F(le);try{let q;parseInt(process.versions.node)>=8?q=le:q=Buffer.from(le);const re=require$$5.deflateSync(q,{level:9});return re instanceof Uint8Array?re:new Uint8Array(re)}catch(q){(0,B.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+q)}return F(le)}d(h,"deflateSync");function F(le){let q=le.length;const re=65535,fe=Math.ceil(q/re),K=new Uint8Array(2+q+fe*5+4);let me=0;K[me++]=120,K[me++]=156;let Ee=0;for(;q>re;)K[me++]=0,K[me++]=255,K[me++]=255,K[me++]=0,K[me++]=0,K.set(le.subarray(Ee,Ee+re),me),me+=re,Ee+=re,q-=re;K[me++]=1,K[me++]=q&255,K[me++]=q>>8&255,K[me++]=~q&65535&255,K[me++]=(~q&65535)>>8&255,K.set(le.subarray(Ee),me),me+=le.length-Ee;const oe=P(le,0,le.length);return K[me++]=oe>>24&255,K[me++]=oe>>16&255,K[me++]=oe>>8&255,K[me++]=oe&255,K}d(F,"deflateSyncUncompressed");function J(le,q,re,fe){const K=le.width,me=le.height;let Ee,oe,W;const A=le.data;switch(q){case B.ImageKind.GRAYSCALE_1BPP:oe=0,Ee=1,W=K+7>>3;break;case B.ImageKind.RGB_24BPP:oe=2,Ee=8,W=K*3;break;case B.ImageKind.RGBA_32BPP:oe=6,Ee=8,W=K*4;break;default:throw new Error("invalid format")}const v=new Uint8Array((1+W)*me);let R=0,z=0;for(let V=0;V<me;++V)v[R++]=0,v.set(A.subarray(z,z+W),R),z+=W,R+=W;if(q===B.ImageKind.GRAYSCALE_1BPP&&fe){R=0;for(let V=0;V<me;V++){R++;for(let N=0;N<W;N++)v[R++]^=255}}const H=new Uint8Array([K>>24&255,K>>16&255,K>>8&255,K&255,me>>24&255,me>>16&255,me>>8&255,me&255,Ee,oe,0,0,0]),ne=h(v),D=e.length+t*3+H.length+ne.length,Y=new Uint8Array(D);let te=0;return Y.set(e,te),te+=e.length,m("IHDR",H,Y,te),te+=t+H.length,m("IDATA",ne,Y,te),te+=t+ne.length,m("IEND",new Uint8Array(0),Y,te),S(Y,"image/png",re)}return d(J,"encode"),d(function(q,re,fe){const K=q.kind===void 0?B.ImageKind.GRAYSCALE_1BPP:q.kind;return J(q,K,re,fe)},"convertImgDataToPng")}();class i{constructor(){this.fontSizeScale=1,this.fontWeight=L.fontWeight,this.fontSize=0,this.textMatrix=B.IDENTITY_MATRIX,this.fontMatrix=B.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=B.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=L.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(t,r){this.x=t,this.y=r}}d(i,"SVGExtraState");let E=0,b=0,p=0;C.SVGGraphics=G=d(class{constructor(e,t,r=!1){(0,x.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new x.DOMSVGFactory,this.current=new i,this.transformMatrix=B.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=e,this.objs=t,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!r,this._operatorIdMapping=[];for(const s in B.OPS)this._operatorIdMapping[B.OPS[s]]=s}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}save(){this.transformStack.push(this.transformMatrix);const e=this.current;this.extraStack.push(e),this.current=e.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(e){this.save(),this.executeOpTree(e),this.restore()}loadDependencies(e){const t=e.fnArray,r=e.argsArray;for(let s=0,m=t.length;s<m;s++)if(t[s]===B.OPS.dependency)for(const P of r[s]){const h=P.startsWith("g_")?this.commonObjs:this.objs,F=new Promise(J=>{h.get(P,J)});this.current.dependencies.push(F)}return Promise.all(this.current.dependencies)}transform(e,t,r,s,m,P){const h=[e,t,r,s,m,P];this.transformMatrix=B.Util.transform(this.transformMatrix,h),this.tgrp=null}getSVG(e,t){this.viewport=t;const r=this._initialize(t);return this.loadDependencies(e).then(()=>(this.transformMatrix=B.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(e)),r))}convertOpList(e){const t=this._operatorIdMapping,r=e.argsArray,s=e.fnArray,m=[];for(let P=0,h=s.length;P<h;P++){const F=s[P];m.push({fnId:F,fn:t[F],args:r[P]})}return c(m)}executeOpTree(e){for(const t of e){const r=t.fn,s=t.fnId,m=t.args;switch(s|0){case B.OPS.beginText:this.beginText();break;case B.OPS.dependency:break;case B.OPS.setLeading:this.setLeading(m);break;case B.OPS.setLeadingMoveText:this.setLeadingMoveText(m[0],m[1]);break;case B.OPS.setFont:this.setFont(m);break;case B.OPS.showText:this.showText(m[0]);break;case B.OPS.showSpacedText:this.showText(m[0]);break;case B.OPS.endText:this.endText();break;case B.OPS.moveText:this.moveText(m[0],m[1]);break;case B.OPS.setCharSpacing:this.setCharSpacing(m[0]);break;case B.OPS.setWordSpacing:this.setWordSpacing(m[0]);break;case B.OPS.setHScale:this.setHScale(m[0]);break;case B.OPS.setTextMatrix:this.setTextMatrix(m[0],m[1],m[2],m[3],m[4],m[5]);break;case B.OPS.setTextRise:this.setTextRise(m[0]);break;case B.OPS.setTextRenderingMode:this.setTextRenderingMode(m[0]);break;case B.OPS.setLineWidth:this.setLineWidth(m[0]);break;case B.OPS.setLineJoin:this.setLineJoin(m[0]);break;case B.OPS.setLineCap:this.setLineCap(m[0]);break;case B.OPS.setMiterLimit:this.setMiterLimit(m[0]);break;case B.OPS.setFillRGBColor:this.setFillRGBColor(m[0],m[1],m[2]);break;case B.OPS.setStrokeRGBColor:this.setStrokeRGBColor(m[0],m[1],m[2]);break;case B.OPS.setStrokeColorN:this.setStrokeColorN(m);break;case B.OPS.setFillColorN:this.setFillColorN(m);break;case B.OPS.shadingFill:this.shadingFill(m[0]);break;case B.OPS.setDash:this.setDash(m[0],m[1]);break;case B.OPS.setRenderingIntent:this.setRenderingIntent(m[0]);break;case B.OPS.setFlatness:this.setFlatness(m[0]);break;case B.OPS.setGState:this.setGState(m[0]);break;case B.OPS.fill:this.fill();break;case B.OPS.eoFill:this.eoFill();break;case B.OPS.stroke:this.stroke();break;case B.OPS.fillStroke:this.fillStroke();break;case B.OPS.eoFillStroke:this.eoFillStroke();break;case B.OPS.clip:this.clip("nonzero");break;case B.OPS.eoClip:this.clip("evenodd");break;case B.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case B.OPS.paintImageXObject:this.paintImageXObject(m[0]);break;case B.OPS.paintInlineImageXObject:this.paintInlineImageXObject(m[0]);break;case B.OPS.paintImageMaskXObject:this.paintImageMaskXObject(m[0]);break;case B.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(m[0],m[1]);break;case B.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case B.OPS.closePath:this.closePath();break;case B.OPS.closeStroke:this.closeStroke();break;case B.OPS.closeFillStroke:this.closeFillStroke();break;case B.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case B.OPS.nextLine:this.nextLine();break;case B.OPS.transform:this.transform(m[0],m[1],m[2],m[3],m[4],m[5]);break;case B.OPS.constructPath:this.constructPath(m[0],m[1]);break;case B.OPS.endPath:this.endPath();break;case 92:this.group(t.items);break;default:(0,B.warn)(`Unimplemented operator ${r}`);break}}}setWordSpacing(e){this.current.wordSpacing=e}setCharSpacing(e){this.current.charSpacing=e}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(e,t,r,s,m,P){const h=this.current;h.textMatrix=h.lineMatrix=[e,t,r,s,m,P],h.textMatrixScale=Math.hypot(e,t),h.x=h.lineX=0,h.y=h.lineY=0,h.xcoords=[],h.ycoords=[],h.tspan=this.svgFactory.createElement("svg:tspan"),h.tspan.setAttributeNS(null,"font-family",h.fontFamily),h.tspan.setAttributeNS(null,"font-size",`${n(h.fontSize)}px`),h.tspan.setAttributeNS(null,"y",n(-h.y)),h.txtElement=this.svgFactory.createElement("svg:text"),h.txtElement.append(h.tspan)}beginText(){const e=this.current;e.x=e.lineX=0,e.y=e.lineY=0,e.textMatrix=B.IDENTITY_MATRIX,e.lineMatrix=B.IDENTITY_MATRIX,e.textMatrixScale=1,e.tspan=this.svgFactory.createElement("svg:tspan"),e.txtElement=this.svgFactory.createElement("svg:text"),e.txtgrp=this.svgFactory.createElement("svg:g"),e.xcoords=[],e.ycoords=[]}moveText(e,t){const r=this.current;r.x=r.lineX+=e,r.y=r.lineY+=t,r.xcoords=[],r.ycoords=[],r.tspan=this.svgFactory.createElement("svg:tspan"),r.tspan.setAttributeNS(null,"font-family",r.fontFamily),r.tspan.setAttributeNS(null,"font-size",`${n(r.fontSize)}px`),r.tspan.setAttributeNS(null,"y",n(-r.y))}showText(e){const t=this.current,r=t.font,s=t.fontSize;if(s===0)return;const m=t.fontSizeScale,P=t.charSpacing,h=t.wordSpacing,F=t.fontDirection,J=t.textHScale*F,le=r.vertical,q=le?1:-1,re=r.defaultVMetrics,fe=s*t.fontMatrix[0];let K=0;for(const oe of e){if(oe===null){K+=F*h;continue}else if(typeof oe=="number"){K+=q*oe*s/1e3;continue}const W=(oe.isSpace?h:0)+P,A=oe.fontChar;let v,R,z=oe.width;if(le){let ne;const D=oe.vmetric||re;ne=oe.vmetric?D[1]:z*.5,ne=-ne*fe;const Y=D[2]*fe;z=D?-D[0]:z,v=ne/m,R=(K+Y)/m}else v=K/m,R=0;(oe.isInFont||r.missingFile)&&(t.xcoords.push(t.x+v),le&&t.ycoords.push(-t.y+R),t.tspan.textContent+=A);let H;le?H=z*fe-W*F:H=z*fe+W*F,K+=H}t.tspan.setAttributeNS(null,"x",t.xcoords.map(n).join(" ")),le?t.tspan.setAttributeNS(null,"y",t.ycoords.map(n).join(" ")):t.tspan.setAttributeNS(null,"y",n(-t.y)),le?t.y-=K:t.x+=K*J,t.tspan.setAttributeNS(null,"font-family",t.fontFamily),t.tspan.setAttributeNS(null,"font-size",`${n(t.fontSize)}px`),t.fontStyle!==L.fontStyle&&t.tspan.setAttributeNS(null,"font-style",t.fontStyle),t.fontWeight!==L.fontWeight&&t.tspan.setAttributeNS(null,"font-weight",t.fontWeight);const me=t.textRenderingMode&B.TextRenderingMode.FILL_STROKE_MASK;if(me===B.TextRenderingMode.FILL||me===B.TextRenderingMode.FILL_STROKE?(t.fillColor!==L.fillColor&&t.tspan.setAttributeNS(null,"fill",t.fillColor),t.fillAlpha<1&&t.tspan.setAttributeNS(null,"fill-opacity",t.fillAlpha)):t.textRenderingMode===B.TextRenderingMode.ADD_TO_PATH?t.tspan.setAttributeNS(null,"fill","transparent"):t.tspan.setAttributeNS(null,"fill","none"),me===B.TextRenderingMode.STROKE||me===B.TextRenderingMode.FILL_STROKE){const oe=1/(t.textMatrixScale||1);this._setStrokeAttributes(t.tspan,oe)}let Ee=t.textMatrix;t.textRise!==0&&(Ee=Ee.slice(),Ee[5]+=t.textRise),t.txtElement.setAttributeNS(null,"transform",`${o(Ee)} scale(${n(J)}, -1)`),t.txtElement.setAttributeNS(I,"xml:space","preserve"),t.txtElement.append(t.tspan),t.txtgrp.append(t.txtElement),this._ensureTransformGroup().append(t.txtElement)}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}addFontStyle(e){if(!e.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const t=S(e.data,e.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${e.loadedName}"; src: url(${t}); }
`}setFont(e){const t=this.current,r=this.commonObjs.get(e[0]);let s=e[1];t.font=r,this.embedFonts&&!r.missingFile&&!this.embeddedFonts[r.loadedName]&&(this.addFontStyle(r),this.embeddedFonts[r.loadedName]=r),t.fontMatrix=r.fontMatrix||B.FONT_IDENTITY_MATRIX;let m="normal";r.black?m="900":r.bold&&(m="bold");const P=r.italic?"italic":"normal";s<0?(s=-s,t.fontDirection=-1):t.fontDirection=1,t.fontSize=s,t.fontFamily=r.loadedName,t.fontWeight=m,t.fontStyle=P,t.tspan=this.svgFactory.createElement("svg:tspan"),t.tspan.setAttributeNS(null,"y",n(-t.y)),t.xcoords=[],t.ycoords=[]}endText(){var t;const e=this.current;e.textRenderingMode&B.TextRenderingMode.ADD_TO_PATH_FLAG&&((t=e.txtElement)!=null&&t.hasChildNodes())&&(e.element=e.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(e){e>0&&(this.current.lineWidth=e)}setLineCap(e){this.current.lineCap=l[e]}setLineJoin(e){this.current.lineJoin=w[e]}setMiterLimit(e){this.current.miterLimit=e}setStrokeAlpha(e){this.current.strokeAlpha=e}setStrokeRGBColor(e,t,r){this.current.strokeColor=B.Util.makeHexColor(e,t,r)}setFillAlpha(e){this.current.fillAlpha=e}setFillRGBColor(e,t,r){this.current.fillColor=B.Util.makeHexColor(e,t,r),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(e){this.current.strokeColor=this._makeColorN_Pattern(e)}setFillColorN(e){this.current.fillColor=this._makeColorN_Pattern(e)}shadingFill(e){const t=this.viewport.width,r=this.viewport.height,s=B.Util.inverseTransform(this.transformMatrix),m=B.Util.applyTransform([0,0],s),P=B.Util.applyTransform([0,r],s),h=B.Util.applyTransform([t,0],s),F=B.Util.applyTransform([t,r],s),J=Math.min(m[0],P[0],h[0],F[0]),le=Math.min(m[1],P[1],h[1],F[1]),q=Math.max(m[0],P[0],h[0],F[0]),re=Math.max(m[1],P[1],h[1],F[1]),fe=this.svgFactory.createElement("svg:rect");fe.setAttributeNS(null,"x",J),fe.setAttributeNS(null,"y",le),fe.setAttributeNS(null,"width",q-J),fe.setAttributeNS(null,"height",re-le),fe.setAttributeNS(null,"fill",this._makeShadingPattern(e)),this.current.fillAlpha<1&&fe.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(fe)}_makeColorN_Pattern(e){return e[0]==="TilingPattern"?this._makeTilingPattern(e):this._makeShadingPattern(e)}_makeTilingPattern(e){const t=e[1],r=e[2],s=e[3]||B.IDENTITY_MATRIX,[m,P,h,F]=e[4],J=e[5],le=e[6],q=e[7],re=`shading${p++}`,[fe,K,me,Ee]=B.Util.normalizeRect([...B.Util.applyTransform([m,P],s),...B.Util.applyTransform([h,F],s)]),[oe,W]=B.Util.singularValueDecompose2dScale(s),A=J*oe,v=le*W,R=this.svgFactory.createElement("svg:pattern");R.setAttributeNS(null,"id",re),R.setAttributeNS(null,"patternUnits","userSpaceOnUse"),R.setAttributeNS(null,"width",A),R.setAttributeNS(null,"height",v),R.setAttributeNS(null,"x",`${fe}`),R.setAttributeNS(null,"y",`${K}`);const z=this.svg,H=this.transformMatrix,ne=this.current.fillColor,D=this.current.strokeColor,Y=this.svgFactory.create(me-fe,Ee-K);if(this.svg=Y,this.transformMatrix=s,q===2){const te=B.Util.makeHexColor(...t);this.current.fillColor=te,this.current.strokeColor=te}return this.executeOpTree(this.convertOpList(r)),this.svg=z,this.transformMatrix=H,this.current.fillColor=ne,this.current.strokeColor=D,R.append(Y.childNodes[0]),this.defs.append(R),`url(#${re})`}_makeShadingPattern(e){switch(typeof e=="string"&&(e=this.objs.get(e)),e[0]){case"RadialAxial":const t=`shading${p++}`,r=e[3];let s;switch(e[1]){case"axial":const m=e[4],P=e[5];s=this.svgFactory.createElement("svg:linearGradient"),s.setAttributeNS(null,"id",t),s.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),s.setAttributeNS(null,"x1",m[0]),s.setAttributeNS(null,"y1",m[1]),s.setAttributeNS(null,"x2",P[0]),s.setAttributeNS(null,"y2",P[1]);break;case"radial":const h=e[4],F=e[5],J=e[6],le=e[7];s=this.svgFactory.createElement("svg:radialGradient"),s.setAttributeNS(null,"id",t),s.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),s.setAttributeNS(null,"cx",F[0]),s.setAttributeNS(null,"cy",F[1]),s.setAttributeNS(null,"r",le),s.setAttributeNS(null,"fx",h[0]),s.setAttributeNS(null,"fy",h[1]),s.setAttributeNS(null,"fr",J);break;default:throw new Error(`Unknown RadialAxial type: ${e[1]}`)}for(const m of r){const P=this.svgFactory.createElement("svg:stop");P.setAttributeNS(null,"offset",m[0]),P.setAttributeNS(null,"stop-color",m[1]),s.append(P)}return this.defs.append(s),`url(#${t})`;case"Mesh":return(0,B.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${e[0]}`)}}setDash(e,t){this.current.dashArray=e,this.current.dashPhase=t}constructPath(e,t){const r=this.current;let s=r.x,m=r.y,P=[],h=0;for(const F of e)switch(F|0){case B.OPS.rectangle:s=t[h++],m=t[h++];const J=t[h++],le=t[h++],q=s+J,re=m+le;P.push("M",n(s),n(m),"L",n(q),n(m),"L",n(q),n(re),"L",n(s),n(re),"Z");break;case B.OPS.moveTo:s=t[h++],m=t[h++],P.push("M",n(s),n(m));break;case B.OPS.lineTo:s=t[h++],m=t[h++],P.push("L",n(s),n(m));break;case B.OPS.curveTo:s=t[h+4],m=t[h+5],P.push("C",n(t[h]),n(t[h+1]),n(t[h+2]),n(t[h+3]),n(s),n(m)),h+=6;break;case B.OPS.curveTo2:P.push("C",n(s),n(m),n(t[h]),n(t[h+1]),n(t[h+2]),n(t[h+3])),s=t[h+2],m=t[h+3],h+=4;break;case B.OPS.curveTo3:s=t[h+2],m=t[h+3],P.push("C",n(t[h]),n(t[h+1]),n(s),n(m),n(s),n(m)),h+=4;break;case B.OPS.closePath:P.push("Z");break}P=P.join(" "),r.path&&e.length>0&&e[0]!==B.OPS.rectangle&&e[0]!==B.OPS.moveTo?P=r.path.getAttributeNS(null,"d")+P:(r.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(r.path)),r.path.setAttributeNS(null,"d",P),r.path.setAttributeNS(null,"fill","none"),r.element=r.path,r.setCurrentPoint(s,m)}endPath(){const e=this.current;if(e.path=null,!this.pendingClip)return;if(!e.element){this.pendingClip=null;return}const t=`clippath${E++}`,r=this.svgFactory.createElement("svg:clipPath");r.setAttributeNS(null,"id",t),r.setAttributeNS(null,"transform",o(this.transformMatrix));const s=e.element.cloneNode(!0);if(this.pendingClip==="evenodd"?s.setAttributeNS(null,"clip-rule","evenodd"):s.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,r.append(s),this.defs.append(r),e.activeClipUrl){e.clipGroup=null;for(const m of this.extraStack)m.clipGroup=null;r.setAttributeNS(null,"clip-path",e.activeClipUrl)}e.activeClipUrl=`url(#${t})`,this.tgrp=null}clip(e){this.pendingClip=e}closePath(){const e=this.current;if(e.path){const t=`${e.path.getAttributeNS(null,"d")}Z`;e.path.setAttributeNS(null,"d",t)}}setLeading(e){this.current.leading=-e}setTextRise(e){this.current.textRise=e}setTextRenderingMode(e){this.current.textRenderingMode=e}setHScale(e){this.current.textHScale=e/100}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,r]of e)switch(t){case"LW":this.setLineWidth(r);break;case"LC":this.setLineCap(r);break;case"LJ":this.setLineJoin(r);break;case"ML":this.setMiterLimit(r);break;case"D":this.setDash(r[0],r[1]);break;case"RI":this.setRenderingIntent(r);break;case"FL":this.setFlatness(r);break;case"Font":this.setFont(r);break;case"CA":this.setStrokeAlpha(r);break;case"ca":this.setFillAlpha(r);break;default:(0,B.warn)(`Unimplemented graphic state operator ${t}`);break}}fill(){const e=this.current;e.element&&(e.element.setAttributeNS(null,"fill",e.fillColor),e.element.setAttributeNS(null,"fill-opacity",e.fillAlpha),this.endPath())}stroke(){const e=this.current;e.element&&(this._setStrokeAttributes(e.element),e.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(e,t=1){const r=this.current;let s=r.dashArray;t!==1&&s.length>0&&(s=s.map(function(m){return t*m})),e.setAttributeNS(null,"stroke",r.strokeColor),e.setAttributeNS(null,"stroke-opacity",r.strokeAlpha),e.setAttributeNS(null,"stroke-miterlimit",n(r.miterLimit)),e.setAttributeNS(null,"stroke-linecap",r.lineCap),e.setAttributeNS(null,"stroke-linejoin",r.lineJoin),e.setAttributeNS(null,"stroke-width",n(t*r.lineWidth)+"px"),e.setAttributeNS(null,"stroke-dasharray",s.map(n).join(" ")),e.setAttributeNS(null,"stroke-dashoffset",n(t*r.dashPhase)+"px")}eoFill(){var e;(e=this.current.element)==null||e.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var e;(e=this.current.element)==null||e.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const e=this.svgFactory.createElement("svg:rect");e.setAttributeNS(null,"x","0"),e.setAttributeNS(null,"y","0"),e.setAttributeNS(null,"width","1px"),e.setAttributeNS(null,"height","1px"),e.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(e)}paintImageXObject(e){const t=this.getObject(e);if(!t){(0,B.warn)(`Dependent image with object ID ${e} is not ready yet`);return}this.paintInlineImageXObject(t)}paintInlineImageXObject(e,t){const r=e.width,s=e.height,m=g(e,this.forceDataSchema,!!t),P=this.svgFactory.createElement("svg:rect");P.setAttributeNS(null,"x","0"),P.setAttributeNS(null,"y","0"),P.setAttributeNS(null,"width",n(r)),P.setAttributeNS(null,"height",n(s)),this.current.element=P,this.clip("nonzero");const h=this.svgFactory.createElement("svg:image");h.setAttributeNS(f,"xlink:href",m),h.setAttributeNS(null,"x","0"),h.setAttributeNS(null,"y",n(-s)),h.setAttributeNS(null,"width",n(r)+"px"),h.setAttributeNS(null,"height",n(s)+"px"),h.setAttributeNS(null,"transform",`scale(${n(1/r)} ${n(-1/s)})`),t?t.append(h):this._ensureTransformGroup().append(h)}paintImageMaskXObject(e){const t=this.getObject(e.data,e);if(t.bitmap){(0,B.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const r=this.current,s=t.width,m=t.height,P=r.fillColor;r.maskId=`mask${b++}`;const h=this.svgFactory.createElement("svg:mask");h.setAttributeNS(null,"id",r.maskId);const F=this.svgFactory.createElement("svg:rect");F.setAttributeNS(null,"x","0"),F.setAttributeNS(null,"y","0"),F.setAttributeNS(null,"width",n(s)),F.setAttributeNS(null,"height",n(m)),F.setAttributeNS(null,"fill",P),F.setAttributeNS(null,"mask",`url(#${r.maskId})`),this.defs.append(h),this._ensureTransformGroup().append(F),this.paintInlineImageXObject(t,h)}paintFormXObjectBegin(e,t){if(Array.isArray(e)&&e.length===6&&this.transform(e[0],e[1],e[2],e[3],e[4],e[5]),t){const r=t[2]-t[0],s=t[3]-t[1],m=this.svgFactory.createElement("svg:rect");m.setAttributeNS(null,"x",t[0]),m.setAttributeNS(null,"y",t[1]),m.setAttributeNS(null,"width",n(r)),m.setAttributeNS(null,"height",n(s)),this.current.element=m,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(e){const t=this.svgFactory.create(e.width,e.height),r=this.svgFactory.createElement("svg:defs");t.append(r),this.defs=r;const s=this.svgFactory.createElement("svg:g");return s.setAttributeNS(null,"transform",o(e.transform)),t.append(s),this.svg=s,t}_ensureClipGroup(){if(!this.current.clipGroup){const e=this.svgFactory.createElement("svg:g");e.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(e),this.current.clipGroup=e}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",o(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}},"SVGGraphics")}}],__webpack_module_cache__={};function __w_pdfjs_require__(ae){var C=__webpack_module_cache__[ae];if(C!==void 0)return C.exports;var de=__webpack_module_cache__[ae]={exports:{}};return __webpack_modules__[ae](de,de.exports,__w_pdfjs_require__),de.exports}d(__w_pdfjs_require__,"__w_pdfjs_require__");var __webpack_exports__={};return(()=>{var ae=__webpack_exports__;Object.defineProperty(ae,"__esModule",{value:!0}),Object.defineProperty(ae,"AbortException",{enumerable:!0,get:function(){return C.AbortException}}),Object.defineProperty(ae,"AnnotationEditorLayer",{enumerable:!0,get:function(){return ue.AnnotationEditorLayer}}),Object.defineProperty(ae,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return C.AnnotationEditorParamsType}}),Object.defineProperty(ae,"AnnotationEditorType",{enumerable:!0,get:function(){return C.AnnotationEditorType}}),Object.defineProperty(ae,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return G.AnnotationEditorUIManager}}),Object.defineProperty(ae,"AnnotationLayer",{enumerable:!0,get:function(){return L.AnnotationLayer}}),Object.defineProperty(ae,"AnnotationMode",{enumerable:!0,get:function(){return C.AnnotationMode}}),Object.defineProperty(ae,"CMapCompressionType",{enumerable:!0,get:function(){return C.CMapCompressionType}}),Object.defineProperty(ae,"FeatureTest",{enumerable:!0,get:function(){return C.FeatureTest}}),Object.defineProperty(ae,"GlobalWorkerOptions",{enumerable:!0,get:function(){return I.GlobalWorkerOptions}}),Object.defineProperty(ae,"InvalidPDFException",{enumerable:!0,get:function(){return C.InvalidPDFException}}),Object.defineProperty(ae,"MissingPDFException",{enumerable:!0,get:function(){return C.MissingPDFException}}),Object.defineProperty(ae,"OPS",{enumerable:!0,get:function(){return C.OPS}}),Object.defineProperty(ae,"PDFDataRangeTransport",{enumerable:!0,get:function(){return de.PDFDataRangeTransport}}),Object.defineProperty(ae,"PDFDateString",{enumerable:!0,get:function(){return x.PDFDateString}}),Object.defineProperty(ae,"PDFWorker",{enumerable:!0,get:function(){return de.PDFWorker}}),Object.defineProperty(ae,"PasswordResponses",{enumerable:!0,get:function(){return C.PasswordResponses}}),Object.defineProperty(ae,"PermissionFlag",{enumerable:!0,get:function(){return C.PermissionFlag}}),Object.defineProperty(ae,"PixelsPerInch",{enumerable:!0,get:function(){return x.PixelsPerInch}}),Object.defineProperty(ae,"RenderingCancelledException",{enumerable:!0,get:function(){return x.RenderingCancelledException}}),Object.defineProperty(ae,"SVGGraphics",{enumerable:!0,get:function(){return f.SVGGraphics}}),Object.defineProperty(ae,"UnexpectedResponseException",{enumerable:!0,get:function(){return C.UnexpectedResponseException}}),Object.defineProperty(ae,"Util",{enumerable:!0,get:function(){return C.Util}}),Object.defineProperty(ae,"VerbosityLevel",{enumerable:!0,get:function(){return C.VerbosityLevel}}),Object.defineProperty(ae,"XfaLayer",{enumerable:!0,get:function(){return l.XfaLayer}}),Object.defineProperty(ae,"build",{enumerable:!0,get:function(){return de.build}}),Object.defineProperty(ae,"createPromiseCapability",{enumerable:!0,get:function(){return C.createPromiseCapability}}),Object.defineProperty(ae,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return C.createValidAbsoluteUrl}}),Object.defineProperty(ae,"getDocument",{enumerable:!0,get:function(){return de.getDocument}}),Object.defineProperty(ae,"getFilenameFromUrl",{enumerable:!0,get:function(){return x.getFilenameFromUrl}}),Object.defineProperty(ae,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return x.getPdfFilenameFromUrl}}),Object.defineProperty(ae,"getXfaPageViewport",{enumerable:!0,get:function(){return x.getXfaPageViewport}}),Object.defineProperty(ae,"isDataScheme",{enumerable:!0,get:function(){return x.isDataScheme}}),Object.defineProperty(ae,"isPdfFile",{enumerable:!0,get:function(){return x.isPdfFile}}),Object.defineProperty(ae,"loadScript",{enumerable:!0,get:function(){return x.loadScript}}),Object.defineProperty(ae,"renderTextLayer",{enumerable:!0,get:function(){return B.renderTextLayer}}),Object.defineProperty(ae,"setLayerDimensions",{enumerable:!0,get:function(){return x.setLayerDimensions}}),Object.defineProperty(ae,"shadow",{enumerable:!0,get:function(){return C.shadow}}),Object.defineProperty(ae,"updateTextLayer",{enumerable:!0,get:function(){return B.updateTextLayer}}),Object.defineProperty(ae,"version",{enumerable:!0,get:function(){return de.version}});var C=__w_pdfjs_require__(1),de=__w_pdfjs_require__(2),x=__w_pdfjs_require__(6),B=__w_pdfjs_require__(26),ue=__w_pdfjs_require__(27),G=__w_pdfjs_require__(5),L=__w_pdfjs_require__(32),I=__w_pdfjs_require__(14),f=__w_pdfjs_require__(35),l=__w_pdfjs_require__(34)})(),__webpack_exports__})())})(pdf);var pdf_viewerExports={},pdf_viewer$1={get exports(){return pdf_viewerExports},set exports(ae){pdf_viewerExports=ae}};(function(ae,C){d(function(x,B){ae.exports=B()},"webpackUniversalModuleDefinition")(globalThis,()=>(()=>{var de=[,(G,L,I)=>{var c,n,Xt,E,Bi;Object.defineProperty(L,"__esModule",{value:!0}),L.SimpleLinkService=L.PDFLinkService=L.LinkTarget=void 0;var f=I(2);const l="noopener noreferrer nofollow",w={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4};L.LinkTarget=w;function S(e,{url:t,target:r,rel:s,enabled:m=!0}={}){if(!t||typeof t!="string")throw new Error('A valid "url" parameter must provided.');const P=(0,f.removeNullCharacters)(t);m?e.href=e.title=P:(e.href="",e.title=`Disabled: ${P}`,e.onclick=()=>!1);let h="";switch(r){case w.NONE:break;case w.SELF:h="_self";break;case w.BLANK:h="_blank";break;case w.PARENT:h="_parent";break;case w.TOP:h="_top";break}e.target=h,e.rel=typeof s=="string"?s:l}d(S,"addLinkAttributes");const p=class{constructor({eventBus:t,externalLinkTarget:r=null,externalLinkRel:s=null,ignoreDestinationZoom:m=!1}={}){Z(this,n);Z(this,c,new Map);this.eventBus=t,this.externalLinkTarget=r,this.externalLinkRel=s,this.externalLinkEnabled=!0,this._ignoreDestinationZoom=m,this.baseUrl=null,this.pdfDocument=null,this.pdfViewer=null,this.pdfHistory=null}setDocument(t,r=null){this.baseUrl=r,this.pdfDocument=t,u(this,c).clear()}setViewer(t){this.pdfViewer=t}setHistory(t){this.pdfHistory=t}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return this.pdfViewer.currentPageNumber}set page(t){this.pdfViewer.currentPageNumber=t}get rotation(){return this.pdfViewer.pagesRotation}set rotation(t){this.pdfViewer.pagesRotation=t}get isInPresentationMode(){return this.pdfViewer.isInPresentationMode}async goToDestination(t){if(!this.pdfDocument)return;let r,s;if(typeof t=="string"?(r=t,s=await this.pdfDocument.getDestination(t)):(r=null,s=await t),!Array.isArray(s)){console.error(`PDFLinkService.goToDestination: "${s}" is not a valid destination array, for dest="${t}".`);return}ee(this,n,Xt).call(this,t,r,s)}goToPage(t){if(!this.pdfDocument)return;const r=typeof t=="string"&&this.pdfViewer.pageLabelToPageNumber(t)||t|0;if(!(Number.isInteger(r)&&r>0&&r<=this.pagesCount)){console.error(`PDFLinkService.goToPage: "${t}" is not a valid page.`);return}this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.pushPage(r)),this.pdfViewer.scrollPageIntoView({pageNumber:r})}addLinkAttributes(t,r,s=!1){S(t,{url:r,target:s?w.BLANK:this.externalLinkTarget,rel:this.externalLinkRel,enabled:this.externalLinkEnabled})}getDestinationHash(t){if(typeof t=="string"){if(t.length>0)return this.getAnchorUrl("#"+escape(t))}else if(Array.isArray(t)){const r=JSON.stringify(t);if(r.length>0)return this.getAnchorUrl("#"+escape(r))}return this.getAnchorUrl("")}getAnchorUrl(t){return this.baseUrl?this.baseUrl+t:t}setHash(t){var m;if(!this.pdfDocument)return;let r,s;if(t.includes("=")){const P=(0,f.parseQueryString)(t);if(P.has("search")&&this.eventBus.dispatch("findfromurlhash",{source:this,query:P.get("search").replaceAll('"',""),phraseSearch:P.get("phrase")==="true"}),P.has("page")&&(r=P.get("page")|0||1),P.has("zoom")){const h=P.get("zoom").split(","),F=h[0],J=parseFloat(F);F.includes("Fit")?F==="Fit"||F==="FitB"?s=[null,{name:F}]:F==="FitH"||F==="FitBH"||F==="FitV"||F==="FitBV"?s=[null,{name:F},h.length>1?h[1]|0:null]:F==="FitR"?h.length!==5?console.error('PDFLinkService.setHash: Not enough parameters for "FitR".'):s=[null,{name:F},h[1]|0,h[2]|0,h[3]|0,h[4]|0]:console.error(`PDFLinkService.setHash: "${F}" is not a valid zoom value.`):s=[null,{name:"XYZ"},h.length>1?h[1]|0:null,h.length>2?h[2]|0:null,J?J/100:F]}s?this.pdfViewer.scrollPageIntoView({pageNumber:r||this.page,destArray:s,allowNegativeOffset:!0}):r&&(this.page=r),P.has("pagemode")&&this.eventBus.dispatch("pagemode",{source:this,mode:P.get("pagemode")}),P.has("nameddest")&&this.goToDestination(P.get("nameddest"))}else{s=unescape(t);try{s=JSON.parse(s),Array.isArray(s)||(s=s.toString())}catch{}if(typeof s=="string"||ee(m=p,E,Bi).call(m,s)){this.goToDestination(s);return}console.error(`PDFLinkService.setHash: "${unescape(t)}" is not a valid destination.`)}}executeNamedAction(t){var r,s;switch(t){case"GoBack":(r=this.pdfHistory)==null||r.back();break;case"GoForward":(s=this.pdfHistory)==null||s.forward();break;case"NextPage":this.pdfViewer.nextPage();break;case"PrevPage":this.pdfViewer.previousPage();break;case"LastPage":this.page=this.pagesCount;break;case"FirstPage":this.page=1;break}this.eventBus.dispatch("namedaction",{source:this,action:t})}async executeSetOCGState(t){const r=this.pdfDocument,s=await this.pdfViewer.optionalContentConfigPromise;if(r!==this.pdfDocument)return;let m;for(const P of t.state){switch(P){case"ON":case"OFF":case"Toggle":m=P;continue}switch(m){case"ON":s.setVisibility(P,!0);break;case"OFF":s.setVisibility(P,!1);break;case"Toggle":const h=s.getGroup(P);h&&s.setVisibility(P,!h.visible);break}}this.pdfViewer.optionalContentConfigPromise=Promise.resolve(s)}cachePageRef(t,r){if(!r)return;const s=r.gen===0?`${r.num}R`:`${r.num}R${r.gen}`;u(this,c).set(s,t)}_cachedPageNumber(t){if(!t)return null;const r=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return u(this,c).get(r)||null}isPageVisible(t){return this.pdfViewer.isPageVisible(t)}isPageCached(t){return this.pdfViewer.isPageCached(t)}};let g=p;d(g,"PDFLinkService"),c=new WeakMap,n=new WeakSet,Xt=d(function(t,r=null,s){const m=s[0];let P;if(typeof m=="object"&&m!==null){if(P=this._cachedPageNumber(m),!P){this.pdfDocument.getPageIndex(m).then(h=>{this.cachePageRef(h+1,m),ee(this,n,Xt).call(this,t,r,s)}).catch(()=>{console.error(`PDFLinkService.#goToDestinationHelper: "${m}" is not a valid page reference, for dest="${t}".`)});return}}else if(Number.isInteger(m))P=m+1;else{console.error(`PDFLinkService.#goToDestinationHelper: "${m}" is not a valid destination reference, for dest="${t}".`);return}if(!P||P<1||P>this.pagesCount){console.error(`PDFLinkService.#goToDestinationHelper: "${P}" is not a valid page number, for dest="${t}".`);return}this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.push({namedDest:r,explicitDest:s,pageNumber:P})),this.pdfViewer.scrollPageIntoView({pageNumber:P,destArray:s,ignoreDestinationZoom:this._ignoreDestinationZoom})},"#goToDestinationHelper"),E=new WeakSet,Bi=d(function(t){if(!Array.isArray(t))return!1;const r=t.length;if(r<2)return!1;const s=t[0];if(!(typeof s=="object"&&Number.isInteger(s.num)&&Number.isInteger(s.gen))&&!(Number.isInteger(s)&&s>=0))return!1;const m=t[1];if(!(typeof m=="object"&&typeof m.name=="string"))return!1;let P=!0;switch(m.name){case"XYZ":if(r!==5)return!1;break;case"Fit":case"FitB":return r===2;case"FitH":case"FitBH":case"FitV":case"FitBV":if(r!==3)return!1;break;case"FitR":if(r!==6)return!1;P=!1;break;default:return!1}for(let h=2;h<r;h++){const F=t[h];if(!(typeof F=="number"||P&&F===null))return!1}return!0},"#isValidExplicitDestination"),Z(g,E),L.PDFLinkService=g;class i{constructor(){this.externalLinkEnabled=!0}get pagesCount(){return 0}get page(){return 0}set page(t){}get rotation(){return 0}set rotation(t){}get isInPresentationMode(){return!1}async goToDestination(t){}goToPage(t){}addLinkAttributes(t,r,s=!1){S(t,{url:r,enabled:this.externalLinkEnabled})}getDestinationHash(t){return"#"}getAnchorUrl(t){return"#"}setHash(t){}executeNamedAction(t){}executeSetOCGState(t){}cachePageRef(t,r){}isPageVisible(t){return!0}isPageCached(t){return!0}}d(i,"SimpleLinkService"),L.SimpleLinkService=i},(G,L)=>{var y,k,U,$,he;Object.defineProperty(L,"__esModule",{value:!0}),L.animationStarted=L.VERTICAL_PADDING=L.UNKNOWN_SCALE=L.TextLayerMode=L.SpreadMode=L.SidebarView=L.ScrollMode=L.SCROLLBAR_PADDING=L.RenderingStates=L.RendererType=L.ProgressBar=L.PresentationModeState=L.OutputScale=L.MIN_SCALE=L.MAX_SCALE=L.MAX_AUTO_SCALE=L.DEFAULT_SCALE_VALUE=L.DEFAULT_SCALE_DELTA=L.DEFAULT_SCALE=L.CursorTool=L.AutoPrintRegExp=void 0,L.apiPageLayoutToViewerModes=a,L.apiPageModeToSidebarView=_,L.approximateFraction=fe,L.backtrackBeforeAllVisibleElements=Ee,L.binarySearchFirstItem=re,L.docStyle=void 0,L.getActiveOrFocusedElement=N,L.getPageSizeInches=me,L.getVisibleElements=oe,L.isPortraitOrientation=ne,L.isValidRotation=R,L.isValidScrollMode=z,L.isValidSpreadMode=H,L.noContextMenuHandler=W,L.normalizeWheelEventDelta=v,L.normalizeWheelEventDirection=A,L.parseQueryString=J,L.removeNullCharacters=q,L.roundToDivide=K,L.scrollIntoView=h,L.watchScroll=F;const I="auto";L.DEFAULT_SCALE_VALUE=I;const f=1;L.DEFAULT_SCALE=f;const l=1.1;L.DEFAULT_SCALE_DELTA=l;const w=.1;L.MIN_SCALE=w;const S=10;L.MAX_SCALE=S;const g=0;L.UNKNOWN_SCALE=g;const i=1.25;L.MAX_AUTO_SCALE=i;const c=40;L.SCROLLBAR_PADDING=c;const n=5;L.VERTICAL_PADDING=n;const o={INITIAL:0,RUNNING:1,PAUSED:2,FINISHED:3};L.RenderingStates=o;const E={UNKNOWN:0,NORMAL:1,CHANGING:2,FULLSCREEN:3};L.PresentationModeState=E;const b={UNKNOWN:-1,NONE:0,THUMBS:1,OUTLINE:2,ATTACHMENTS:3,LAYERS:4};L.SidebarView=b;const p={CANVAS:"canvas",SVG:"svg"};L.RendererType=p;const e={DISABLE:0,ENABLE:1};L.TextLayerMode=e;const t={UNKNOWN:-1,VERTICAL:0,HORIZONTAL:1,WRAPPED:2,PAGE:3};L.ScrollMode=t;const r={UNKNOWN:-1,NONE:0,ODD:1,EVEN:2};L.SpreadMode=r;const s={SELECT:0,HAND:1,ZOOM:2};L.CursorTool=s;const m=/\bprint\s*\(/;L.AutoPrintRegExp=m;class P{constructor(){const Q=window.devicePixelRatio||1;this.sx=Q,this.sy=Q}get scaled(){return this.sx!==1||this.sy!==1}}d(P,"OutputScale"),L.OutputScale=P;function h(X,Q,pe=!1){let ce=X.offsetParent;if(!ce){console.error("offsetParent is not set -- cannot scroll");return}let _e=X.offsetTop+X.clientTop,Se=X.offsetLeft+X.clientLeft;for(;ce.clientHeight===ce.scrollHeight&&ce.clientWidth===ce.scrollWidth||pe&&(ce.classList.contains("markedContent")||getComputedStyle(ce).overflow==="hidden");)if(_e+=ce.offsetTop,Se+=ce.offsetLeft,ce=ce.offsetParent,!ce)return;Q&&(Q.top!==void 0&&(_e+=Q.top),Q.left!==void 0&&(Se+=Q.left,ce.scrollLeft=Se)),ce.scrollTop=_e}d(h,"scrollIntoView");function F(X,Q){const pe=d(function(Se){_e||(_e=window.requestAnimationFrame(d(function(){_e=null;const Re=X.scrollLeft,T=ce.lastX;Re!==T&&(ce.right=Re>T),ce.lastX=Re;const se=X.scrollTop,M=ce.lastY;se!==M&&(ce.down=se>M),ce.lastY=se,Q(ce)},"viewAreaElementScrolled")))},"debounceScroll"),ce={right:!0,down:!0,lastX:X.scrollLeft,lastY:X.scrollTop,_eventHandler:pe};let _e=null;return X.addEventListener("scroll",pe,!0),ce}d(F,"watchScroll");function J(X){const Q=new Map;for(const[pe,ce]of new URLSearchParams(X))Q.set(pe.toLowerCase(),ce);return Q}d(J,"parseQueryString");const le=/[\x01-\x1F]/g;function q(X,Q=!1){return typeof X!="string"?(console.error("The argument must be a string."),X):(Q&&(X=X.replaceAll(le," ")),X.replaceAll("\0",""))}d(q,"removeNullCharacters");function re(X,Q,pe=0){let ce=pe,_e=X.length-1;if(_e<0||!Q(X[_e]))return X.length;if(Q(X[ce]))return ce;for(;ce<_e;){const Se=ce+_e>>1,Pe=X[Se];Q(Pe)?_e=Se:ce=Se+1}return ce}d(re,"binarySearchFirstItem");function fe(X){if(Math.floor(X)===X)return[X,1];const Q=1/X,pe=8;if(Q>pe)return[1,pe];if(Math.floor(Q)===Q)return[1,Q];const ce=X>1?Q:X;let _e=0,Se=1,Pe=1,Re=1;for(;;){const se=_e+Pe,M=Se+Re;if(M>pe)break;ce<=se/M?(Pe=se,Re=M):(_e=se,Se=M)}let T;return ce-_e/Se<Pe/Re-ce?T=ce===X?[_e,Se]:[Se,_e]:T=ce===X?[Pe,Re]:[Re,Pe],T}d(fe,"approximateFraction");function K(X,Q){const pe=X%Q;return pe===0?X:Math.round(X-pe+Q)}d(K,"roundToDivide");function me({view:X,userUnit:Q,rotate:pe}){const[ce,_e,Se,Pe]=X,Re=pe%180!==0,T=(Se-ce)/72*Q,se=(Pe-_e)/72*Q;return{width:Re?se:T,height:Re?T:se}}d(me,"getPageSizeInches");function Ee(X,Q,pe){if(X<2)return X;let ce=Q[X].div,_e=ce.offsetTop+ce.clientTop;_e>=pe&&(ce=Q[X-1].div,_e=ce.offsetTop+ce.clientTop);for(let Se=X-2;Se>=0&&(ce=Q[Se].div,!(ce.offsetTop+ce.clientTop+ce.clientHeight<=_e));--Se)X=Se;return X}d(Ee,"backtrackBeforeAllVisibleElements");function oe({scrollEl:X,views:Q,sortByVisibility:pe=!1,horizontal:ce=!1,rtl:_e=!1}){const Se=X.scrollTop,Pe=Se+X.clientHeight,Re=X.scrollLeft,T=Re+X.clientWidth;function se(ge){const Ae=ge.div;return Ae.offsetTop+Ae.clientTop+Ae.clientHeight>Se}d(se,"isElementBottomAfterViewTop");function M(ge){const Ae=ge.div,Ce=Ae.offsetLeft+Ae.clientLeft,xe=Ce+Ae.clientWidth;return _e?Ce<T:xe>Re}d(M,"isElementNextAfterViewHorizontally");const O=[],j=new Set,be=Q.length;let Te=re(Q,ce?M:se);Te>0&&Te<be&&!ce&&(Te=Ee(Te,Q,Se));let ie=ce?T:-1;for(let ge=Te;ge<be;ge++){const Ae=Q[ge],Ce=Ae.div,xe=Ce.offsetLeft+Ce.clientLeft,we=Ce.offsetTop+Ce.clientTop,Le=Ce.clientWidth,ke=Ce.clientHeight,Fe=xe+Le,Ie=we+ke;if(ie===-1)Ie>=Pe&&(ie=Ie);else if((ce?xe:we)>ie)break;if(Ie<=Se||we>=Pe||Fe<=Re||xe>=T)continue;const Oe=Math.max(0,Se-we)+Math.max(0,Ie-Pe),De=Math.max(0,Re-xe)+Math.max(0,Fe-T),Ve=(ke-Oe)/ke,Ne=(Le-De)/Le,Be=Ve*Ne*100|0;O.push({id:Ae.id,x:xe,y:we,view:Ae,percent:Be,widthPercent:Ne*100|0}),j.add(Ae.id)}const ye=O[0],Me=O.at(-1);return pe&&O.sort(function(ge,Ae){const Ce=ge.percent-Ae.percent;return Math.abs(Ce)>.001?-Ce:ge.id-Ae.id}),{first:ye,last:Me,views:O,ids:j}}d(oe,"getVisibleElements");function W(X){X.preventDefault()}d(W,"noContextMenuHandler");function A(X){let Q=Math.hypot(X.deltaX,X.deltaY);const pe=Math.atan2(X.deltaY,X.deltaX);return-.25*Math.PI<pe&&pe<.75*Math.PI&&(Q=-Q),Q}d(A,"normalizeWheelEventDirection");function v(X){const Q=X.deltaMode;let pe=A(X);const ce=30,_e=30;return Q===WheelEvent.DOM_DELTA_PIXEL?pe/=ce*_e:Q===WheelEvent.DOM_DELTA_LINE&&(pe/=_e),pe}d(v,"normalizeWheelEventDelta");function R(X){return Number.isInteger(X)&&X%90===0}d(R,"isValidRotation");function z(X){return Number.isInteger(X)&&Object.values(t).includes(X)&&X!==t.UNKNOWN}d(z,"isValidScrollMode");function H(X){return Number.isInteger(X)&&Object.values(r).includes(X)&&X!==r.UNKNOWN}d(H,"isValidSpreadMode");function ne(X){return X.width<=X.height}d(ne,"isPortraitOrientation");const D=new Promise(function(X){window.requestAnimationFrame(X)});L.animationStarted=D;const Y=document.documentElement.style;L.docStyle=Y;function te(X,Q,pe){return Math.min(Math.max(X,Q),pe)}d(te,"clamp");class V{constructor(Q){Z(this,y,null);Z(this,k,null);Z(this,U,0);Z(this,$,null);Z(this,he,!0);ve(this,y,Q.classList),ve(this,$,Q.style)}get percent(){return u(this,U)}set percent(Q){if(ve(this,U,te(Q,0,100)),isNaN(Q)){u(this,y).add("indeterminate");return}u(this,y).remove("indeterminate"),u(this,$).setProperty("--progressBar-percent",`${u(this,U)}%`)}setWidth(Q){if(!Q)return;const ce=Q.parentNode.offsetWidth-Q.offsetWidth;ce>0&&u(this,$).setProperty("--progressBar-end-offset",`${ce}px`)}setDisableAutoFetch(Q=5e3){isNaN(u(this,U))||(u(this,k)&&clearTimeout(u(this,k)),this.show(),ve(this,k,setTimeout(()=>{ve(this,k,null),this.hide()},Q)))}hide(){u(this,he)&&(ve(this,he,!1),u(this,y).add("hidden"))}show(){u(this,he)||(ve(this,he,!0),u(this,y).remove("hidden"))}}d(V,"ProgressBar"),y=new WeakMap,k=new WeakMap,U=new WeakMap,$=new WeakMap,he=new WeakMap,L.ProgressBar=V;function N(){let X=document,Q=X.activeElement||X.querySelector(":focus");for(;Q!=null&&Q.shadowRoot;)X=Q.shadowRoot,Q=X.activeElement||X.querySelector(":focus");return Q}d(N,"getActiveOrFocusedElement");function a(X){let Q=t.VERTICAL,pe=r.NONE;switch(X){case"SinglePage":Q=t.PAGE;break;case"OneColumn":break;case"TwoPageLeft":Q=t.PAGE;case"TwoColumnLeft":pe=r.ODD;break;case"TwoPageRight":Q=t.PAGE;case"TwoColumnRight":pe=r.EVEN;break}return{scrollMode:Q,spreadMode:pe}}d(a,"apiPageLayoutToViewerModes");function _(X){switch(X){case"UseNone":return b.NONE;case"UseThumbs":return b.THUMBS;case"UseOutlines":return b.OUTLINE;case"UseAttachments":return b.ATTACHMENTS;case"UseOC":return b.LAYERS}return b.NONE}d(_,"apiPageModeToSidebarView")},(G,L,I)=>{var g,i,c,qt;Object.defineProperty(L,"__esModule",{value:!0}),L.AnnotationLayerBuilder=void 0;var f=I(4),l=I(5),w=I(2);class S{constructor({pageDiv:E,pdfPage:b,linkService:p,downloadManager:e,annotationStorage:t=null,imageResourcesPath:r="",renderForms:s=!0,l10n:m=l.NullL10n,enableScripting:P=!1,hasJSActionsPromise:h=null,fieldObjectsPromise:F=null,annotationCanvasMap:J=null,accessibilityManager:le=null}){Z(this,c);Z(this,g,0);Z(this,i,null);this.pageDiv=E,this.pdfPage=b,this.linkService=p,this.downloadManager=e,this.imageResourcesPath=r,this.renderForms=s,this.l10n=m,this.annotationStorage=t,this.enableScripting=P,this._hasJSActionsPromise=h||Promise.resolve(!1),this._fieldObjectsPromise=F||Promise.resolve(null),this._annotationCanvasMap=J,this._accessibilityManager=le,this.div=null,this._cancelled=!1,this._eventBus=p.eventBus}async render(E,b="display"){var r;if(this.div){if(this._cancelled||u(this,g)===0)return;f.AnnotationLayer.update({viewport:E.clone({dontFlip:!0}),div:this.div,annotationCanvasMap:this._annotationCanvasMap});return}const[p,e,t]=await Promise.all([this.pdfPage.getAnnotations({intent:b}),this._hasJSActionsPromise,this._fieldObjectsPromise]);if(!this._cancelled){if(ve(this,g,p.length),this.div=document.createElement("div"),this.div.className="annotationLayer",this.pageDiv.append(this.div),u(this,g)===0){this.hide();return}f.AnnotationLayer.render({viewport:E.clone({dontFlip:!0}),div:this.div,annotations:p,page:this.pdfPage,imageResourcesPath:this.imageResourcesPath,renderForms:this.renderForms,linkService:this.linkService,downloadManager:this.downloadManager,annotationStorage:this.annotationStorage,enableScripting:this.enableScripting,hasJSActions:e,fieldObjects:t,annotationCanvasMap:this._annotationCanvasMap,accessibilityManager:this._accessibilityManager}),this.l10n.translate(this.div),this.linkService.isInPresentationMode&&ee(this,c,qt).call(this,w.PresentationModeState.FULLSCREEN),u(this,i)||(ve(this,i,s=>{ee(this,c,qt).call(this,s.state)}),(r=this._eventBus)==null||r._on("presentationmodechanged",u(this,i)))}}cancel(){var E;this._cancelled=!0,u(this,i)&&((E=this._eventBus)==null||E._off("presentationmodechanged",u(this,i)),ve(this,i,null))}hide(){this.div&&(this.div.hidden=!0)}}d(S,"AnnotationLayerBuilder"),g=new WeakMap,i=new WeakMap,c=new WeakSet,qt=d(function(E){if(!this.div)return;let b=!1;switch(E){case w.PresentationModeState.FULLSCREEN:b=!0;break;case w.PresentationModeState.NORMAL:break;default:return}for(const p of this.div.childNodes)p.hasAttribute("data-internal-link")||(p.inert=b)},"#updatePresentationModeState"),L.AnnotationLayerBuilder=S},G=>{let L;typeof window<"u"&&window["pdfjs-dist/build/pdf"]?L=window["pdfjs-dist/build/pdf"]:L=pdfExports,G.exports=L},(G,L)=>{Object.defineProperty(L,"__esModule",{value:!0}),L.NullL10n=void 0,L.fixupLangCode=w,L.getL10nFallback=f;const I={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image"};I.print_progress_percent="{{progress}}%";function f(i,c){switch(i){case"find_match_count":i=`find_match_count[${c.total===1?"one":"other"}]`;break;case"find_match_count_limit":i=`find_match_count_limit[${c.limit===1?"one":"other"}]`;break}return I[i]||""}d(f,"getL10nFallback");const l={en:"en-US",es:"es-ES",fy:"fy-NL",ga:"ga-IE",gu:"gu-IN",hi:"hi-IN",hy:"hy-AM",nb:"nb-NO",ne:"ne-NP",nn:"nn-NO",pa:"pa-IN",pt:"pt-PT",sv:"sv-SE",zh:"zh-CN"};function w(i){return l[i==null?void 0:i.toLowerCase()]||i}d(w,"fixupLangCode");function S(i,c){return c?i.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(n,o)=>o in c?c[o]:"{{"+o+"}}"):i}d(S,"formatL10nValue");const g={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(i,c=null,n=f(i,c)){return S(n,c)},async translate(i){}};L.NullL10n=g},(G,L,I)=>{var S;Object.defineProperty(L,"__esModule",{value:!0}),L.DownloadManager=void 0;var f=I(4);function l(g,i){const c=document.createElement("a");if(!c.click)throw new Error('DownloadManager: "a.click()" is not supported.');c.href=g,c.target="_parent","download"in c&&(c.download=i),(document.body||document.documentElement).append(c),c.click(),c.remove()}d(l,"download");class w{constructor(){Z(this,S,new WeakMap)}downloadUrl(i,c){if(!(0,f.createValidAbsoluteUrl)(i,"http://example.com")){console.error(`downloadUrl - not a valid URL: ${i}`);return}l(i+"#pdfjs.action=download",c)}downloadData(i,c,n){const o=URL.createObjectURL(new Blob([i],{type:n}));l(o,c)}openOrDownloadData(i,c,n){const E=(0,f.isPdfFile)(n)?"application/pdf":"";return this.downloadData(c,n,E),!1}download(i,c,n){const o=URL.createObjectURL(i);l(o,n)}}d(w,"DownloadManager"),S=new WeakMap,L.DownloadManager=w},(G,L)=>{var S;Object.defineProperty(L,"__esModule",{value:!0}),L.WaitOnType=L.EventBus=L.AutomationEventBus=void 0,L.waitOnEventOrTimeout=f;const I={EVENT:"event",TIMEOUT:"timeout"};L.WaitOnType=I;function f({target:g,name:i,delay:c=0}){return new Promise(function(n,o){if(typeof g!="object"||!(i&&typeof i=="string")||!(Number.isInteger(c)&&c>=0))throw new Error("waitOnEventOrTimeout - invalid parameters.");function E(t){g instanceof l?g._off(i,b):g.removeEventListener(i,b),e&&clearTimeout(e),n(t)}d(E,"handler");const b=E.bind(null,I.EVENT);g instanceof l?g._on(i,b):g.addEventListener(i,b);const p=E.bind(null,I.TIMEOUT),e=setTimeout(p,c)})}d(f,"waitOnEventOrTimeout");class l{constructor(){Z(this,S,Object.create(null))}on(i,c,n=null){this._on(i,c,{external:!0,once:n==null?void 0:n.once})}off(i,c,n=null){this._off(i,c,{external:!0,once:n==null?void 0:n.once})}dispatch(i,c){const n=u(this,S)[i];if(!n||n.length===0)return;let o;for(const{listener:E,external:b,once:p}of n.slice(0)){if(p&&this._off(i,E),b){(o||(o=[])).push(E);continue}E(c)}if(o){for(const E of o)E(c);o=null}}_on(i,c,n=null){var E;((E=u(this,S))[i]||(E[i]=[])).push({listener:c,external:(n==null?void 0:n.external)===!0,once:(n==null?void 0:n.once)===!0})}_off(i,c,n=null){const o=u(this,S)[i];if(o){for(let E=0,b=o.length;E<b;E++)if(o[E].listener===c){o.splice(E,1);return}}}}d(l,"EventBus"),S=new WeakMap,L.EventBus=l;class w extends l{dispatch(i,c){throw new Error("Not implemented: AutomationEventBus.dispatch")}}d(w,"AutomationEventBus"),L.AutomationEventBus=w},(G,L,I)=>{Object.defineProperty(L,"__esModule",{value:!0}),L.GenericL10n=void 0,I(9);var f=I(5);const l=document.webL10n;class w{constructor(g){this._lang=g,this._ready=new Promise((i,c)=>{l.setLanguage((0,f.fixupLangCode)(g),()=>{i(l)})})}async getLanguage(){return(await this._ready).getLanguage()}async getDirection(){return(await this._ready).getDirection()}async get(g,i=null,c=(0,f.getL10nFallback)(g,i)){return(await this._ready).get(g,i,c)}async translate(g){return(await this._ready).translate(g)}}d(w,"GenericL10n"),L.GenericL10n=w},()=>{document.webL10n=function(G,L,I){var f={},l="",w="textContent",S="",g={},i="loading",c=!0;function n(){return L.querySelectorAll('link[type="application/l10n"]')}d(n,"getL10nResourceLinks");function o(){var q=L.querySelector('script[type="application/l10n"]');return q?JSON.parse(q.innerHTML):null}d(o,"getL10nDictionary");function E(q){return q?q.querySelectorAll("*[data-l10n-id]"):[]}d(E,"getTranslatableChildren");function b(q){if(!q)return{};var re=q.getAttribute("data-l10n-id"),fe=q.getAttribute("data-l10n-args"),K={};if(fe)try{K=JSON.parse(fe)}catch{console.warn("could not parse arguments for #"+re)}return{id:re,args:K}}d(b,"getL10nAttributes");function p(q,re,fe){re=re||d(function(Ee){},"_onSuccess"),fe=fe||d(function(){},"_onFailure");var K=new XMLHttpRequest;K.open("GET",q,c),K.overrideMimeType&&K.overrideMimeType("text/plain; charset=utf-8"),K.onreadystatechange=function(){K.readyState==4&&(K.status==200||K.status===0?re(K.responseText):fe())},K.onerror=fe,K.ontimeout=fe;try{K.send(null)}catch{fe()}}d(p,"xhrLoadText");function e(q,re,fe,K){var me=q.replace(/[^\/]*$/,"")||"./";function Ee(W){return W.lastIndexOf("\\")<0?W:W.replace(/\\\\/g,"\\").replace(/\\n/g,`
`).replace(/\\r/g,"\r").replace(/\\t/g,"	").replace(/\\b/g,"\b").replace(/\\f/g,"\f").replace(/\\{/g,"{").replace(/\\}/g,"}").replace(/\\"/g,'"').replace(/\\'/g,"'")}d(Ee,"evalString");function oe(W,A){var v={},R=/^\s*|\s*$/,z=/^\s*#|^\s*$/,H=/^\s*\[(.*)\]\s*$/,ne=/^\s*@import\s+url\((.*)\)\s*$/i,D=/^([^=\s]*)\s*=\s*(.+)$/;function Y(V,N,a){var _=V.replace(R,"").split(/[\r\n]+/),y="*",k=re.split("-",1)[0],U=!1,$="";function he(){for(;;){if(!_.length){a();return}var X=_.shift();if(!z.test(X)){if(N){if($=H.exec(X),$){y=$[1].toLowerCase(),U=y!=="*"&&y!==re&&y!==k;continue}else if(U)continue;if($=ne.exec(X),$){te(me+$[1],he);return}}var Q=X.match(D);Q&&Q.length==3&&(v[Q[1]]=Ee(Q[2]))}}}d(he,"nextEntry"),he()}d(Y,"parseRawLines");function te(V,N){p(V,function(a){Y(a,!1,N)},function(){console.warn(V+" not found."),N()})}d(te,"loadImport"),Y(W,!0,function(){A(v)})}d(oe,"parseProperties"),p(q,function(W){l+=W,oe(W,function(A){for(var v in A){var R,z,H=v.lastIndexOf(".");H>0?(R=v.substring(0,H),z=v.substring(H+1)):(R=v,z=w),f[R]||(f[R]={}),f[R][z]=A[v]}fe&&fe()})},K)}d(e,"parseResource");function t(q,re){q&&(q=q.toLowerCase()),re=re||d(function(){},"_callback"),r(),S=q;var fe=n(),K=fe.length;if(K===0){var me=o();if(me&&me.locales&&me.default_locale){if(console.log("using the embedded JSON directory, early way out"),f=me.locales[q],!f){var Ee=me.default_locale.toLowerCase();for(var oe in me.locales)if(oe=oe.toLowerCase(),oe===q){f=me.locales[q];break}else oe===Ee&&(f=me.locales[Ee])}re()}else console.log("no resource to load, early way out");i="complete";return}var W=null,A=0;W=d(function(){A++,A>=K&&(re(),i="complete")},"onResourceLoaded");function v(H){var ne=H.href;this.load=function(D,Y){e(ne,D,Y,function(){console.warn(ne+" not found."),console.warn('"'+D+'" resource not found'),S="",Y()})}}d(v,"L10nResourceLink");for(var R=0;R<K;R++){var z=new v(fe[R]);z.load(q,W)}}d(t,"loadLocale");function r(){f={},l="",S=""}d(r,"clear");function s(q){var re={af:3,ak:4,am:4,ar:1,asa:3,az:0,be:11,bem:3,bez:3,bg:3,bh:4,bm:0,bn:3,bo:0,br:20,brx:3,bs:11,ca:3,cgg:3,chr:3,cs:12,cy:17,da:3,de:3,dv:3,dz:0,ee:3,el:3,en:3,eo:3,es:3,et:3,eu:3,fa:0,ff:5,fi:3,fil:4,fo:3,fr:5,fur:3,fy:3,ga:8,gd:24,gl:3,gsw:3,gu:3,guw:4,gv:23,ha:3,haw:3,he:2,hi:4,hr:11,hu:0,id:0,ig:0,ii:0,is:3,it:3,iu:7,ja:0,jmc:3,jv:0,ka:0,kab:5,kaj:3,kcg:3,kde:0,kea:0,kk:3,kl:3,km:0,kn:0,ko:0,ksb:3,ksh:21,ku:3,kw:7,lag:18,lb:3,lg:3,ln:4,lo:0,lt:10,lv:6,mas:3,mg:4,mk:16,ml:3,mn:3,mo:9,mr:3,ms:0,mt:15,my:0,nah:3,naq:7,nb:3,nd:3,ne:3,nl:3,nn:3,no:3,nr:3,nso:4,ny:3,nyn:3,om:3,or:3,pa:3,pap:3,pl:13,ps:3,pt:3,rm:3,ro:9,rof:3,ru:11,rwk:3,sah:0,saq:3,se:7,seh:3,ses:0,sg:0,sh:11,shi:19,sk:12,sl:14,sma:7,smi:7,smj:7,smn:7,sms:7,sn:3,so:3,sq:3,sr:11,ss:3,ssy:3,st:3,sv:3,sw:3,syr:3,ta:3,te:3,teo:3,th:0,ti:4,tig:3,tk:3,tl:4,tn:3,to:0,tr:0,ts:3,tzm:22,uk:11,ur:3,ve:3,vi:0,vun:3,wa:4,wae:3,wo:0,xh:3,xog:3,yo:0,zh:0,zu:3};function fe(oe,W){return W.indexOf(oe)!==-1}d(fe,"isIn");function K(oe,W,A){return W<=oe&&oe<=A}d(K,"isBetween");var me={0:function(oe){return"other"},1:function(oe){return K(oe%100,3,10)?"few":oe===0?"zero":K(oe%100,11,99)?"many":oe==2?"two":oe==1?"one":"other"},2:function(oe){return oe!==0&&oe%10===0?"many":oe==2?"two":oe==1?"one":"other"},3:function(oe){return oe==1?"one":"other"},4:function(oe){return K(oe,0,1)?"one":"other"},5:function(oe){return K(oe,0,2)&&oe!=2?"one":"other"},6:function(oe){return oe===0?"zero":oe%10==1&&oe%100!=11?"one":"other"},7:function(oe){return oe==2?"two":oe==1?"one":"other"},8:function(oe){return K(oe,3,6)?"few":K(oe,7,10)?"many":oe==2?"two":oe==1?"one":"other"},9:function(oe){return oe===0||oe!=1&&K(oe%100,1,19)?"few":oe==1?"one":"other"},10:function(oe){return K(oe%10,2,9)&&!K(oe%100,11,19)?"few":oe%10==1&&!K(oe%100,11,19)?"one":"other"},11:function(oe){return K(oe%10,2,4)&&!K(oe%100,12,14)?"few":oe%10===0||K(oe%10,5,9)||K(oe%100,11,14)?"many":oe%10==1&&oe%100!=11?"one":"other"},12:function(oe){return K(oe,2,4)?"few":oe==1?"one":"other"},13:function(oe){return K(oe%10,2,4)&&!K(oe%100,12,14)?"few":oe!=1&&K(oe%10,0,1)||K(oe%10,5,9)||K(oe%100,12,14)?"many":oe==1?"one":"other"},14:function(oe){return K(oe%100,3,4)?"few":oe%100==2?"two":oe%100==1?"one":"other"},15:function(oe){return oe===0||K(oe%100,2,10)?"few":K(oe%100,11,19)?"many":oe==1?"one":"other"},16:function(oe){return oe%10==1&&oe!=11?"one":"other"},17:function(oe){return oe==3?"few":oe===0?"zero":oe==6?"many":oe==2?"two":oe==1?"one":"other"},18:function(oe){return oe===0?"zero":K(oe,0,2)&&oe!==0&&oe!=2?"one":"other"},19:function(oe){return K(oe,2,10)?"few":K(oe,0,1)?"one":"other"},20:function(oe){return(K(oe%10,3,4)||oe%10==9)&&!(K(oe%100,10,19)||K(oe%100,70,79)||K(oe%100,90,99))?"few":oe%1e6===0&&oe!==0?"many":oe%10==2&&!fe(oe%100,[12,72,92])?"two":oe%10==1&&!fe(oe%100,[11,71,91])?"one":"other"},21:function(oe){return oe===0?"zero":oe==1?"one":"other"},22:function(oe){return K(oe,0,1)||K(oe,11,99)?"one":"other"},23:function(oe){return K(oe%10,1,2)||oe%20===0?"one":"other"},24:function(oe){return K(oe,3,10)||K(oe,13,19)?"few":fe(oe,[2,12])?"two":fe(oe,[1,11])?"one":"other"}},Ee=re[q.replace(/-.*$/,"")];return Ee in me?me[Ee]:(console.warn("plural form unknown for ["+q+"]"),function(){return"other"})}d(s,"getPluralRules"),g.plural=function(q,re,fe,K){var me=parseFloat(re);if(isNaN(me)||K!=w)return q;g._pluralRules||(g._pluralRules=s(S));var Ee="["+g._pluralRules(me)+"]";return me===0&&fe+"[zero]"in f?q=f[fe+"[zero]"][K]:me==1&&fe+"[one]"in f?q=f[fe+"[one]"][K]:me==2&&fe+"[two]"in f?q=f[fe+"[two]"][K]:fe+Ee in f?q=f[fe+Ee][K]:fe+"[other]"in f&&(q=f[fe+"[other]"][K]),q};function m(q,re,fe){var K=f[q];if(!K){if(console.warn("#"+q+" is undefined."),!fe)return null;K=fe}var me={};for(var Ee in K){var oe=K[Ee];oe=P(oe,re,q,Ee),oe=h(oe,re,q),me[Ee]=oe}return me}d(m,"getL10nData");function P(q,re,fe,K){var me=/\{\[\s*([a-zA-Z]+)\(([a-zA-Z]+)\)\s*\]\}/,Ee=me.exec(q);if(!Ee||!Ee.length)return q;var oe=Ee[1],W=Ee[2],A;if(re&&W in re?A=re[W]:W in f&&(A=f[W]),oe in g){var v=g[oe];q=v(q,A,fe,K)}return q}d(P,"substIndexes");function h(q,re,fe){var K=/\{\{\s*(.+?)\s*\}\}/g;return q.replace(K,function(me,Ee){return re&&Ee in re?re[Ee]:Ee in f?f[Ee]:(console.log("argument {{"+Ee+"}} for #"+fe+" is undefined."),me)})}d(h,"substArguments");function F(q){var re=b(q);if(re.id){var fe=m(re.id,re.args);if(!fe){console.warn("#"+re.id+" is undefined.");return}if(fe[w]){if(J(q)===0)q[w]=fe[w];else{for(var K=q.childNodes,me=!1,Ee=0,oe=K.length;Ee<oe;Ee++)K[Ee].nodeType===3&&/\S/.test(K[Ee].nodeValue)&&(me?K[Ee].nodeValue="":(K[Ee].nodeValue=fe[w],me=!0));if(!me){var W=L.createTextNode(fe[w]);q.prepend(W)}}delete fe[w]}for(var A in fe)q[A]=fe[A]}}d(F,"translateElement");function J(q){if(q.children)return q.children.length;if(typeof q.childElementCount<"u")return q.childElementCount;for(var re=0,fe=0;fe<q.childNodes.length;fe++)re+=q.nodeType===1?1:0;return re}d(J,"getChildElementCount");function le(q){q=q||L.documentElement;for(var re=E(q),fe=re.length,K=0;K<fe;K++)F(re[K]);F(q)}return d(le,"translateFragment"),{get:function(q,re,fe){var K=q.lastIndexOf("."),me=w;K>0&&(me=q.substring(K+1),q=q.substring(0,K));var Ee;fe&&(Ee={},Ee[me]=fe);var oe=m(q,re,Ee);return oe&&me in oe?oe[me]:"{{"+q+"}}"},getData:function(){return f},getText:function(){return l},getLanguage:function(){return S},setLanguage:function(q,re){t(q,function(){re&&re()})},getDirection:function(){var q=["ar","he","fa","ps","ur"],re=S.split("-",1)[0];return q.indexOf(re)>=0?"rtl":"ltr"},translate:le,getReadyState:function(){return i},ready:function(q){if(q)i=="complete"||i=="interactive"?G.setTimeout(function(){q()}):L.addEventListener&&L.addEventListener("localized",d(function re(){L.removeEventListener("localized",re),q()},"once"));else return}}}(window,document)},(G,L,I)=>{var re,fe,K,Vi,Ee,Yt,W,Kt,v,Ui,z,ji,ne,Hi,Y,Zt,V,Wi,a,$i,y,St,U,ft,he,lt,Q,zi,ce,Qt,Se,Jt,Re,Et,se,Gi,O,ei,be,ti,ie,pt;Object.defineProperty(L,"__esModule",{value:!0}),L.PDFFindController=L.FindState=void 0;var f=I(2),l=I(4),w=I(11);const S={FOUND:0,NOT_FOUND:1,WRAPPED:2,PENDING:3};L.FindState=S;const g=250,i=-50,c=-400,n={"‐":"-","‘":"'","’":"'","‚":"'","‛":"'","“":'"',"”":'"',"„":'"',"‟":'"',"¼":"1/4","½":"1/2","¾":"3/4"},o=new Set([12441,12442,2381,2509,2637,2765,2893,3021,3149,3277,3387,3388,3405,3530,3642,3770,3972,4153,4154,5908,5940,6098,6752,6980,7082,7083,7154,7155,11647,43014,43052,43204,43347,43456,43766,44013,3158,3953,3954,3962,3963,3964,3965,3968,3956]);let E;const b=/\p{M}+/gu,p=/([.*+?^${}()|[\]\\])|(\p{P})|(\s+)|(\p{M})|(\p{L})/gu,e=/([^\p{M}])\p{M}*$/u,t=/^\p{M}*([^\p{M}])/u,r=/[\uAC00-\uD7AF\uFA6C\uFACF-\uFAD1\uFAD5-\uFAD7]+/g,s=new Map,m="[\\u1100-\\u1112\\ud7a4-\\ud7af\\ud84a\\ud84c\\ud850\\ud854\\ud857\\ud85f]",P=new Map;let h=null,F=null;function J(Me){const ge=[];let Ae;for(;(Ae=r.exec(Me))!==null;){let{index:Ne}=Ae;for(const Be of Ae[0]){let je=s.get(Be);je||(je=Be.normalize("NFD").length,s.set(Be,je)),ge.push([je,Ne++])}}let Ce;if(ge.length===0&&h)Ce=h;else if(ge.length>0&&F)Ce=F;else{const ze=`([${Object.keys(n).join("")}])|([①-⑳Ⓐ-⓿㉄-㊿㋐-㋾＀-￯])|((?:゙|゚)\\n)|(\\p{M}+(?:-\\n)?)|(\\S-\\n)|((?:\\p{Ideographic}|[぀-ヿ])\\n)|(\\n)`;ge.length===0?Ce=h=new RegExp(ze+"|(\\u0000)","gum"):Ce=F=new RegExp(ze+`|(${m})`,"gum")}const xe=[];for(;(Ae=b.exec(Me))!==null;)xe.push([Ae[0].length,Ae.index]);let we=Me.normalize("NFD");const Le=[[0,0]];let ke=0,Fe=0,Ie=0,Oe=0,De=0,Ve=!1;return we=we.replace(Ce,(Ne,Be,je,$e,ze,Qe,Je,it,nt,We)=>{var ct,fi,pi;if(We-=Oe,Be){const He=n[Be],Ge=He.length;for(let Xe=1;Xe<Ge;Xe++)Le.push([We-Ie+Xe,Ie-Xe]);return Ie-=Ge-1,He}if(je){let He=P.get(je);He||(He=je.normalize("NFKC"),P.set(je,He));const Ge=He.length;for(let Xe=1;Xe<Ge;Xe++)Le.push([We-Ie+Xe,Ie-Xe]);return Ie-=Ge-1,He}if($e)return Ve=!0,We+De===((ct=xe[ke])==null?void 0:ct[1])?++ke:(Le.push([We-1-Ie+1,Ie-1]),Ie-=1,Oe+=1),Le.push([We-Ie+1,Ie]),Oe+=1,De+=1,$e.charAt(0);if(ze){const He=ze.endsWith(`
`),Ge=He?ze.length-2:ze.length;Ve=!0;let Xe=Ge;We+De===((fi=xe[ke])==null?void 0:fi[1])&&(Xe-=xe[ke][0],++ke);for(let mt=1;mt<=Xe;mt++)Le.push([We-1-Ie+mt,Ie-mt]);return Ie-=Xe,Oe+=Xe,He?(We+=Ge-1,Le.push([We-Ie+1,1+Ie]),Ie+=1,Oe+=1,De+=1,ze.slice(0,Ge)):ze}if(Qe){const He=Qe.length-2;return Le.push([We-Ie+He,1+Ie]),Ie+=1,Oe+=1,De+=1,Qe.slice(0,-2)}if(Je){const He=Je.length-1;return Le.push([We-Ie+He,Ie]),Oe+=1,De+=1,Je.slice(0,-1)}if(it)return Le.push([We-Ie+1,Ie-1]),Ie-=1,Oe+=1,De+=1," ";if(We+De===((pi=ge[Fe])==null?void 0:pi[1])){const He=ge[Fe][0]-1;++Fe;for(let Ge=1;Ge<=He;Ge++)Le.push([We-(Ie-Ge),Ie-Ge]);Ie-=He,Oe+=He}return nt}),Le.push([we.length,Ie]),[we,Le,Ve]}d(J,"normalize");function le(Me,ge,Ae){if(!Me)return[ge,Ae];const Ce=ge,xe=ge+Ae;let we=(0,f.binarySearchFirstItem)(Me,ke=>ke[0]>=Ce);Me[we][0]>Ce&&--we;let Le=(0,f.binarySearchFirstItem)(Me,ke=>ke[0]>=xe,we);return Me[Le][0]>xe&&--Le,[Ce+Me[we][1],Ae+Me[Le][1]-Me[we][1]]}d(le,"getOriginalIndex");class q{constructor({linkService:ge,eventBus:Ae,updateMatchesCountOnProgress:Ce=!0}){Z(this,K);Z(this,Ee);Z(this,W);Z(this,v);Z(this,z);Z(this,ne);Z(this,Y);Z(this,V);Z(this,a);Z(this,y);Z(this,U);Z(this,he);Z(this,Q);Z(this,ce);Z(this,Se);Z(this,Re);Z(this,se);Z(this,O);Z(this,be);Z(this,ie);Z(this,re,!0);Z(this,fe,0);this._linkService=ge,this._eventBus=Ae,ve(this,re,Ce),ee(this,Ee,Yt).call(this),Ae._on("find",ee(this,K,Vi).bind(this)),Ae._on("findbarclose",ee(this,se,Gi).bind(this))}get highlightMatches(){return this._highlightMatches}get pageMatches(){return this._pageMatches}get pageMatchesLength(){return this._pageMatchesLength}get selected(){return this._selected}get state(){return this._state}setDocument(ge){this._pdfDocument&&ee(this,Ee,Yt).call(this),ge&&(this._pdfDocument=ge,this._firstPageCapability.resolve())}scrollMatchIntoView({element:ge=null,selectedLeft:Ae=0,pageIndex:Ce=-1,matchIndex:xe=-1}){if(!this._scrollMatches||!ge)return;if(xe===-1||xe!==this._selected.matchIdx)return;if(Ce===-1||Ce!==this._selected.pageIdx)return;this._scrollMatches=!1;const we={top:i,left:Ae+c};(0,f.scrollIntoView)(ge,we,!0)}}d(q,"PDFFindController"),re=new WeakMap,fe=new WeakMap,K=new WeakSet,Vi=d(function(ge){if(!ge)return;const Ae=this._pdfDocument,{type:Ce}=ge;(this._state===null||ee(this,v,Ui).call(this,ge))&&(this._dirtyMatch=!0),this._state=ge,Ce!=="highlightallchange"&&ee(this,ie,pt).call(this,S.PENDING),this._firstPageCapability.promise.then(()=>{if(!this._pdfDocument||Ae&&this._pdfDocument!==Ae)return;ee(this,a,$i).call(this);const xe=!this._highlightMatches,we=!!this._findTimeout;this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),Ce?this._dirtyMatch?ee(this,he,lt).call(this):Ce==="again"?(ee(this,he,lt).call(this),xe&&this._state.highlightAll&&ee(this,U,ft).call(this)):Ce==="highlightallchange"?(we?ee(this,he,lt).call(this):this._highlightMatches=!0,ee(this,U,ft).call(this)):ee(this,he,lt).call(this):this._findTimeout=setTimeout(()=>{ee(this,he,lt).call(this),this._findTimeout=null},g)})},"#onFind"),Ee=new WeakSet,Yt=d(function(){this._highlightMatches=!1,this._scrollMatches=!1,this._pdfDocument=null,this._pageMatches=[],this._pageMatchesLength=[],ve(this,fe,0),this._state=null,this._selected={pageIdx:-1,matchIdx:-1},this._offset={pageIdx:null,matchIdx:null,wrapped:!1},this._extractTextPromises=[],this._pageContents=[],this._pageDiffs=[],this._hasDiacritics=[],this._matchesCountTotal=0,this._pagesToSearch=null,this._pendingFindMatches=new Set,this._resumePageIdx=null,this._dirtyMatch=!1,clearTimeout(this._findTimeout),this._findTimeout=null,this._firstPageCapability=(0,l.createPromiseCapability)()},"#reset"),W=new WeakSet,Kt=d(function(){return this._state.query!==this._rawQuery&&(this._rawQuery=this._state.query,[this._normalizedQuery]=J(this._state.query)),this._normalizedQuery},"#query"),v=new WeakSet,Ui=d(function(ge){if(ge.query!==this._state.query)return!0;switch(ge.type){case"again":const Ae=this._selected.pageIdx+1,Ce=this._linkService;return Ae>=1&&Ae<=Ce.pagesCount&&Ae!==Ce.page&&!Ce.isPageVisible(Ae);case"highlightallchange":return!1}return!0},"#shouldDirtyMatch"),z=new WeakSet,ji=d(function(ge,Ae,Ce){let xe=ge.slice(0,Ae).match(e);if(xe){const we=ge.charCodeAt(Ae),Le=xe[1].charCodeAt(0);if((0,w.getCharacterType)(we)===(0,w.getCharacterType)(Le))return!1}if(xe=ge.slice(Ae+Ce).match(t),xe){const we=ge.charCodeAt(Ae+Ce-1),Le=xe[1].charCodeAt(0);if((0,w.getCharacterType)(we)===(0,w.getCharacterType)(Le))return!1}return!0},"#isEntireWord"),ne=new WeakSet,Hi=d(function(ge,Ae,Ce,xe){const we=this._pageMatches[Ce]=[],Le=this._pageMatchesLength[Ce]=[];if(!ge)return;const ke=this._pageDiffs[Ce];let Fe;for(;(Fe=ge.exec(xe))!==null;){if(Ae&&!ee(this,z,ji).call(this,xe,Fe.index,Fe[0].length))continue;const[Ie,Oe]=le(ke,Fe.index,Fe[0].length);Oe&&(we.push(Ie),Le.push(Oe))}},"#calculateRegExpMatch"),Y=new WeakSet,Zt=d(function(ge,Ae){const{matchDiacritics:Ce}=this._state;let xe=!1;ge=ge.replaceAll(p,(Le,ke,Fe,Ie,Oe,De)=>ke?`[ ]*\\${ke}[ ]*`:Fe?`[ ]*${Fe}[ ]*`:Ie?"[ ]+":Ce?Oe||De:Oe?o.has(Oe.charCodeAt(0))?Oe:"":Ae?(xe=!0,`${De}\\p{M}*`):De);const we="[ ]*";return ge.endsWith(we)&&(ge=ge.slice(0,ge.length-we.length)),Ce&&Ae&&(E||(E=String.fromCharCode(...o)),xe=!0,ge=`${ge}(?=[${E}]|[^\\p{M}]|$)`),[xe,ge]},"#convertToRegExpString"),V=new WeakSet,Wi=d(function(ge){let Ae=u(this,W,Kt);if(!Ae)return;const{caseSensitive:Ce,entireWord:xe,phraseSearch:we}=this._state,Le=this._pageContents[ge],ke=this._hasDiacritics[ge];let Fe=!1;if(we)[Fe,Ae]=ee(this,Y,Zt).call(this,Ae,ke);else{const De=Ae.match(/\S+/g);De&&(Ae=De.sort().reverse().map(Ve=>{const[Ne,Be]=ee(this,Y,Zt).call(this,Ve,ke);return Fe||(Fe=Ne),`(${Be})`}).join("|"))}const Ie=`g${Fe?"u":""}${Ce?"":"i"}`;Ae=Ae?new RegExp(Ae,Ie):null,ee(this,ne,Hi).call(this,Ae,xe,ge,Le),this._state.highlightAll&&ee(this,y,St).call(this,ge),this._resumePageIdx===ge&&(this._resumePageIdx=null,ee(this,ce,Qt).call(this));const Oe=this._pageMatches[ge].length;this._matchesCountTotal+=Oe,u(this,re)?Oe>0&&ee(this,be,ti).call(this):++ht(this,fe)._===this._linkService.pagesCount&&ee(this,be,ti).call(this)},"#calculateMatch"),a=new WeakSet,$i=d(function(){if(this._extractTextPromises.length>0)return;let ge=Promise.resolve();for(let Ae=0,Ce=this._linkService.pagesCount;Ae<Ce;Ae++){const xe=(0,l.createPromiseCapability)();this._extractTextPromises[Ae]=xe.promise,ge=ge.then(()=>this._pdfDocument.getPage(Ae+1).then(we=>we.getTextContent()).then(we=>{const Le=[];for(const ke of we.items)Le.push(ke.str),ke.hasEOL&&Le.push(`
`);[this._pageContents[Ae],this._pageDiffs[Ae],this._hasDiacritics[Ae]]=J(Le.join("")),xe.resolve()},we=>{console.error(`Unable to get text content for page ${Ae+1}`,we),this._pageContents[Ae]="",this._pageDiffs[Ae]=null,this._hasDiacritics[Ae]=!1,xe.resolve()}))}},"#extractText"),y=new WeakSet,St=d(function(ge){this._scrollMatches&&this._selected.pageIdx===ge&&(this._linkService.page=ge+1),this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:ge})},"#updatePage"),U=new WeakSet,ft=d(function(){this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:-1})},"#updateAllPages"),he=new WeakSet,lt=d(function(){const ge=this._state.findPrevious,Ae=this._linkService.page-1,Ce=this._linkService.pagesCount;if(this._highlightMatches=!0,this._dirtyMatch){this._dirtyMatch=!1,this._selected.pageIdx=this._selected.matchIdx=-1,this._offset.pageIdx=Ae,this._offset.matchIdx=null,this._offset.wrapped=!1,this._resumePageIdx=null,this._pageMatches.length=0,this._pageMatchesLength.length=0,ve(this,fe,0),this._matchesCountTotal=0,ee(this,U,ft).call(this);for(let we=0;we<Ce;we++)this._pendingFindMatches.has(we)||(this._pendingFindMatches.add(we),this._extractTextPromises[we].then(()=>{this._pendingFindMatches.delete(we),ee(this,V,Wi).call(this,we)}))}if(!u(this,W,Kt)){ee(this,ie,pt).call(this,S.FOUND);return}if(this._resumePageIdx)return;const xe=this._offset;if(this._pagesToSearch=Ce,xe.matchIdx!==null){const we=this._pageMatches[xe.pageIdx].length;if(!ge&&xe.matchIdx+1<we||ge&&xe.matchIdx>0){xe.matchIdx=ge?xe.matchIdx-1:xe.matchIdx+1,ee(this,Re,Et).call(this,!0);return}ee(this,Se,Jt).call(this,ge)}ee(this,ce,Qt).call(this)},"#nextMatch"),Q=new WeakSet,zi=d(function(ge){const Ae=this._offset,Ce=ge.length,xe=this._state.findPrevious;return Ce?(Ae.matchIdx=xe?Ce-1:0,ee(this,Re,Et).call(this,!0),!0):(ee(this,Se,Jt).call(this,xe),Ae.wrapped&&(Ae.matchIdx=null,this._pagesToSearch<0)?(ee(this,Re,Et).call(this,!1),!0):!1)},"#matchesReady"),ce=new WeakSet,Qt=d(function(){this._resumePageIdx!==null&&console.error("There can only be one pending page.");let ge=null;do{const Ae=this._offset.pageIdx;if(ge=this._pageMatches[Ae],!ge){this._resumePageIdx=Ae;break}}while(!ee(this,Q,zi).call(this,ge))},"#nextPageMatch"),Se=new WeakSet,Jt=d(function(ge){const Ae=this._offset,Ce=this._linkService.pagesCount;Ae.pageIdx=ge?Ae.pageIdx-1:Ae.pageIdx+1,Ae.matchIdx=null,this._pagesToSearch--,(Ae.pageIdx>=Ce||Ae.pageIdx<0)&&(Ae.pageIdx=ge?Ce-1:0,Ae.wrapped=!0)},"#advanceOffsetPage"),Re=new WeakSet,Et=d(function(ge=!1){let Ae=S.NOT_FOUND;const Ce=this._offset.wrapped;if(this._offset.wrapped=!1,ge){const xe=this._selected.pageIdx;this._selected.pageIdx=this._offset.pageIdx,this._selected.matchIdx=this._offset.matchIdx,Ae=Ce?S.WRAPPED:S.FOUND,xe!==-1&&xe!==this._selected.pageIdx&&ee(this,y,St).call(this,xe)}ee(this,ie,pt).call(this,Ae,this._state.findPrevious),this._selected.pageIdx!==-1&&(this._scrollMatches=!0,ee(this,y,St).call(this,this._selected.pageIdx))},"#updateMatch"),se=new WeakSet,Gi=d(function(ge){const Ae=this._pdfDocument;this._firstPageCapability.promise.then(()=>{!this._pdfDocument||Ae&&this._pdfDocument!==Ae||(this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),this._resumePageIdx&&(this._resumePageIdx=null,this._dirtyMatch=!0),ee(this,ie,pt).call(this,S.FOUND),this._highlightMatches=!1,ee(this,U,ft).call(this))})},"#onFindBarClose"),O=new WeakSet,ei=d(function(){var we;const{pageIdx:ge,matchIdx:Ae}=this._selected;let Ce=0,xe=this._matchesCountTotal;if(Ae!==-1){for(let Le=0;Le<ge;Le++)Ce+=((we=this._pageMatches[Le])==null?void 0:we.length)||0;Ce+=Ae+1}return(Ce<1||Ce>xe)&&(Ce=xe=0),{current:Ce,total:xe}},"#requestMatchesCount"),be=new WeakSet,ti=d(function(){this._eventBus.dispatch("updatefindmatchescount",{source:this,matchesCount:ee(this,O,ei).call(this)})},"#updateUIResultsCount"),ie=new WeakSet,pt=d(function(ge,Ae=!1){var Ce;!u(this,re)&&(u(this,fe)!==this._linkService.pagesCount||ge===S.PENDING)||this._eventBus.dispatch("updatefindcontrolstate",{source:this,state:ge,previous:Ae,matchesCount:ee(this,O,ei).call(this),rawQuery:((Ce=this._state)==null?void 0:Ce.query)??null})},"#updateUIState"),L.PDFFindController=q},(G,L)=>{Object.defineProperty(L,"__esModule",{value:!0}),L.CharacterType=void 0,L.getCharacterType=b;const I={SPACE:0,ALPHA_LETTER:1,PUNCT:2,HAN_LETTER:3,KATAKANA_LETTER:4,HIRAGANA_LETTER:5,HALFWIDTH_KATAKANA_LETTER:6,THAI_LETTER:7};L.CharacterType=I;function f(p){return p<11904}d(f,"isAlphabeticalScript");function l(p){return(p&65408)===0}d(l,"isAscii");function w(p){return p>=97&&p<=122||p>=65&&p<=90}d(w,"isAsciiAlpha");function S(p){return p>=48&&p<=57}d(S,"isAsciiDigit");function g(p){return p===32||p===9||p===13||p===10}d(g,"isAsciiSpace");function i(p){return p>=13312&&p<=40959||p>=63744&&p<=64255}d(i,"isHan");function c(p){return p>=12448&&p<=12543}d(c,"isKatakana");function n(p){return p>=12352&&p<=12447}d(n,"isHiragana");function o(p){return p>=65376&&p<=65439}d(o,"isHalfwidthKatakana");function E(p){return(p&65408)===3584}d(E,"isThai");function b(p){return f(p)?l(p)?g(p)?I.SPACE:w(p)||S(p)||p===95?I.ALPHA_LETTER:I.PUNCT:E(p)?I.THAI_LETTER:p===160?I.SPACE:I.ALPHA_LETTER:i(p)?I.HAN_LETTER:c(p)?I.KATAKANA_LETTER:n(p)?I.HIRAGANA_LETTER:o(p)?I.HALFWIDTH_KATAKANA_LETTER:I.ALPHA_LETTER}d(b,"getCharacterType")},(G,L,I)=>{Object.defineProperty(L,"__esModule",{value:!0}),L.PDFHistory=void 0,L.isDestArraysEqual=o,L.isDestHashesEqual=n;var f=I(2),l=I(7);const w=1e3,S=50,g=1e3;function i(){return document.location.hash}d(i,"getCurrentHash");class c{constructor({linkService:b,eventBus:p}){this.linkService=b,this.eventBus=p,this._initialized=!1,this._fingerprint="",this.reset(),this._boundEvents=null,this.eventBus._on("pagesinit",()=>{this._isPagesLoaded=!1,this.eventBus._on("pagesloaded",e=>{this._isPagesLoaded=!!e.pagesCount},{once:!0})})}initialize({fingerprint:b,resetHistory:p=!1,updateUrl:e=!1}){if(!b||typeof b!="string"){console.error('PDFHistory.initialize: The "fingerprint" must be a non-empty string.');return}this._initialized&&this.reset();const t=this._fingerprint!==""&&this._fingerprint!==b;this._fingerprint=b,this._updateUrl=e===!0,this._initialized=!0,this._bindEvents();const r=window.history.state;if(this._popStateInProgress=!1,this._blockHashChange=0,this._currentHash=i(),this._numPositionUpdates=0,this._uid=this._maxUid=0,this._destination=null,this._position=null,!this._isValidState(r,!0)||p){const{hash:m,page:P,rotation:h}=this._parseCurrentHash(!0);if(!m||t||p){this._pushOrReplaceState(null,!0);return}this._pushOrReplaceState({hash:m,page:P,rotation:h},!0);return}const s=r.destination;this._updateInternalState(s,r.uid,!0),s.rotation!==void 0&&(this._initialRotation=s.rotation),s.dest?(this._initialBookmark=JSON.stringify(s.dest),this._destination.page=null):s.hash?this._initialBookmark=s.hash:s.page&&(this._initialBookmark=`page=${s.page}`)}reset(){this._initialized&&(this._pageHide(),this._initialized=!1,this._unbindEvents()),this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._initialBookmark=null,this._initialRotation=null}push({namedDest:b=null,explicitDest:p,pageNumber:e}){if(!this._initialized)return;if(b&&typeof b!="string"){console.error(`PDFHistory.push: "${b}" is not a valid namedDest parameter.`);return}else if(Array.isArray(p)){if(!this._isValidPage(e)&&(e!==null||this._destination)){console.error(`PDFHistory.push: "${e}" is not a valid pageNumber parameter.`);return}}else{console.error(`PDFHistory.push: "${p}" is not a valid explicitDest parameter.`);return}const t=b||JSON.stringify(p);if(!t)return;let r=!1;if(this._destination&&(n(this._destination.hash,t)||o(this._destination.dest,p))){if(this._destination.page)return;r=!0}this._popStateInProgress&&!r||(this._pushOrReplaceState({dest:p,hash:t,page:e,rotation:this.linkService.rotation},r),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1})))}pushPage(b){var p;if(this._initialized){if(!this._isValidPage(b)){console.error(`PDFHistory.pushPage: "${b}" is not a valid page number.`);return}((p=this._destination)==null?void 0:p.page)!==b&&(this._popStateInProgress||(this._pushOrReplaceState({dest:null,hash:`page=${b}`,page:b,rotation:this.linkService.rotation}),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1}))))}}pushCurrentPosition(){!this._initialized||this._popStateInProgress||this._tryPushCurrentPosition()}back(){if(!this._initialized||this._popStateInProgress)return;const b=window.history.state;this._isValidState(b)&&b.uid>0&&window.history.back()}forward(){if(!this._initialized||this._popStateInProgress)return;const b=window.history.state;this._isValidState(b)&&b.uid<this._maxUid&&window.history.forward()}get popStateInProgress(){return this._initialized&&(this._popStateInProgress||this._blockHashChange>0)}get initialBookmark(){return this._initialized?this._initialBookmark:null}get initialRotation(){return this._initialized?this._initialRotation:null}_pushOrReplaceState(b,p=!1){const e=p||!this._destination,t={fingerprint:this._fingerprint,uid:e?this._uid:this._uid+1,destination:b};this._updateInternalState(b,t.uid);let r;if(this._updateUrl&&(b!=null&&b.hash)){const s=document.location.href.split("#")[0];s.startsWith("file://")||(r=`${s}#${b.hash}`)}e?window.history.replaceState(t,"",r):window.history.pushState(t,"",r)}_tryPushCurrentPosition(b=!1){if(!this._position)return;let p=this._position;if(b&&(p=Object.assign(Object.create(null),this._position),p.temporary=!0),!this._destination){this._pushOrReplaceState(p);return}if(this._destination.temporary){this._pushOrReplaceState(p,!0);return}if(this._destination.hash===p.hash||!this._destination.page&&this._numPositionUpdates<=S)return;let e=!1;if(this._destination.page>=p.first&&this._destination.page<=p.page){if(this._destination.dest!==void 0||!this._destination.first)return;e=!0}this._pushOrReplaceState(p,e)}_isValidPage(b){return Number.isInteger(b)&&b>0&&b<=this.linkService.pagesCount}_isValidState(b,p=!1){if(!b)return!1;if(b.fingerprint!==this._fingerprint)if(p){if(typeof b.fingerprint!="string"||b.fingerprint.length!==this._fingerprint.length)return!1;const[e]=performance.getEntriesByType("navigation");if((e==null?void 0:e.type)!=="reload")return!1}else return!1;return!(!Number.isInteger(b.uid)||b.uid<0||b.destination===null||typeof b.destination!="object")}_updateInternalState(b,p,e=!1){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),e&&(b!=null&&b.temporary)&&delete b.temporary,this._destination=b,this._uid=p,this._maxUid=Math.max(this._maxUid,p),this._numPositionUpdates=0}_parseCurrentHash(b=!1){const p=unescape(i()).substring(1),e=(0,f.parseQueryString)(p),t=e.get("nameddest")||"";let r=e.get("page")|0;return(!this._isValidPage(r)||b&&t.length>0)&&(r=null),{hash:p,page:r,rotation:this.linkService.rotation}}_updateViewarea({location:b}){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._position={hash:b.pdfOpenParams.substring(1),page:this.linkService.page,first:b.pageNumber,rotation:b.rotation},!this._popStateInProgress&&(this._isPagesLoaded&&this._destination&&!this._destination.page&&this._numPositionUpdates++,this._updateViewareaTimeout=setTimeout(()=>{this._popStateInProgress||this._tryPushCurrentPosition(!0),this._updateViewareaTimeout=null},g))}_popState({state:b}){const p=i(),e=this._currentHash!==p;if(this._currentHash=p,!b){this._uid++;const{hash:r,page:s,rotation:m}=this._parseCurrentHash();this._pushOrReplaceState({hash:r,page:s,rotation:m},!0);return}if(!this._isValidState(b))return;this._popStateInProgress=!0,e&&(this._blockHashChange++,(0,l.waitOnEventOrTimeout)({target:window,name:"hashchange",delay:w}).then(()=>{this._blockHashChange--}));const t=b.destination;this._updateInternalState(t,b.uid,!0),(0,f.isValidRotation)(t.rotation)&&(this.linkService.rotation=t.rotation),t.dest?this.linkService.goToDestination(t.dest):t.hash?this.linkService.setHash(t.hash):t.page&&(this.linkService.page=t.page),Promise.resolve().then(()=>{this._popStateInProgress=!1})}_pageHide(){(!this._destination||this._destination.temporary)&&this._tryPushCurrentPosition()}_bindEvents(){this._boundEvents||(this._boundEvents={updateViewarea:this._updateViewarea.bind(this),popState:this._popState.bind(this),pageHide:this._pageHide.bind(this)},this.eventBus._on("updateviewarea",this._boundEvents.updateViewarea),window.addEventListener("popstate",this._boundEvents.popState),window.addEventListener("pagehide",this._boundEvents.pageHide))}_unbindEvents(){this._boundEvents&&(this.eventBus._off("updateviewarea",this._boundEvents.updateViewarea),window.removeEventListener("popstate",this._boundEvents.popState),window.removeEventListener("pagehide",this._boundEvents.pageHide),this._boundEvents=null)}}d(c,"PDFHistory"),L.PDFHistory=c;function n(E,b){return typeof E!="string"||typeof b!="string"?!1:E===b||(0,f.parseQueryString)(E).get("nameddest")===b}d(n,"isDestHashesEqual");function o(E,b){function p(e,t){if(typeof e!=typeof t||Array.isArray(e)||Array.isArray(t))return!1;if(e!==null&&typeof e=="object"&&t!==null){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(!p(e[r],t[r]))return!1;return!0}return e===t||Number.isNaN(e)&&Number.isNaN(t)}if(d(p,"isEntryEqual"),!(Array.isArray(E)&&Array.isArray(b))||E.length!==b.length)return!1;for(let e=0,t=E.length;e<t;e++)if(!p(E[e],b[e]))return!1;return!0}d(o,"isDestArraysEqual")},(G,L,I)=>{var s,m,P,h,F,J,le,Pt,re,ii,K,ni,Ee,si,W,ri,v,Xi,z,qi;Object.defineProperty(L,"__esModule",{value:!0}),L.PDFPageView=void 0;var f=I(4),l=I(2),w=I(14),S=I(3),g=I(15),i=I(5),c=I(1),n=I(16),o=I(17),E=I(18),b=I(19),p=I(20);const e=g.compatibilityParams.maxCanvasPixels||16777216,t=d(()=>({annotationEditorUIManager:null,annotationStorage:null,downloadManager:null,enableScripting:!1,fieldObjectsPromise:null,findController:null,hasJSActionsPromise:null,get linkService(){return new c.SimpleLinkService}}),"DEFAULT_LAYER_PROPERTIES");class r{constructor(D){Z(this,le);Z(this,re);Z(this,K);Z(this,Ee);Z(this,W);Z(this,v);Z(this,z);Z(this,s,f.AnnotationMode.ENABLE_FORMS);Z(this,m,null);Z(this,P,null);Z(this,h,null);Z(this,F,l.RenderingStates.INITIAL);Z(this,J,{initialOptionalContent:!0,regularAnnotations:!0});var N;const Y=D.container,te=D.defaultViewport;this.id=D.id,this.renderingId="page"+this.id,ve(this,m,D.layerProperties||t),this.pdfPage=null,this.pageLabel=null,this.rotation=0,this.scale=D.scale||l.DEFAULT_SCALE,this.viewport=te,this.pdfPageRotate=te.rotation,this._optionalContentConfigPromise=D.optionalContentConfigPromise||null,this.hasRestrictedScaling=!1,this.textLayerMode=D.textLayerMode??l.TextLayerMode.ENABLE,ve(this,s,D.annotationMode??f.AnnotationMode.ENABLE_FORMS),this.imageResourcesPath=D.imageResourcesPath||"",this.useOnlyCssZoom=D.useOnlyCssZoom||!1,this.isOffscreenCanvasSupported=D.isOffscreenCanvasSupported??!0,this.maxCanvasPixels=D.maxCanvasPixels||e,this.pageColors=D.pageColors||null,this.eventBus=D.eventBus,this.renderingQueue=D.renderingQueue,this.renderer=D.renderer||l.RendererType.CANVAS,this.l10n=D.l10n||i.NullL10n,this.paintTask=null,this.paintedViewportMap=new WeakMap,this.resume=null,this._renderError=null,this._isStandalone=!((N=this.renderingQueue)!=null&&N.hasViewer()),this._annotationCanvasMap=null,this.annotationLayer=null,this.annotationEditorLayer=null,this.textLayer=null,this.zoomLayer=null,this.xfaLayer=null,this.structTreeLayer=null;const V=document.createElement("div");if(V.className="page",V.setAttribute("data-page-number",this.id),V.setAttribute("role","region"),this.l10n.get("page_landmark",{page:this.id}).then(a=>{V.setAttribute("aria-label",a)}),this.div=V,ee(this,le,Pt).call(this),Y==null||Y.append(V),this._isStandalone){Y==null||Y.style.setProperty("--scale-factor",this.scale*f.PixelsPerInch.PDF_TO_CSS_UNITS);const{optionalContentConfigPromise:a}=D;a&&a.then(_=>{a===this._optionalContentConfigPromise&&(u(this,J).initialOptionalContent=_.hasInitialVisibility)})}}get renderingState(){return u(this,F)}set renderingState(D){if(D!==u(this,F))switch(ve(this,F,D),u(this,P)&&(clearTimeout(u(this,P)),ve(this,P,null)),D){case l.RenderingStates.PAUSED:this.div.classList.remove("loading");break;case l.RenderingStates.RUNNING:this.div.classList.add("loadingIcon"),ve(this,P,setTimeout(()=>{this.div.classList.add("loading"),ve(this,P,null)},0));break;case l.RenderingStates.INITIAL:case l.RenderingStates.FINISHED:this.div.classList.remove("loadingIcon","loading");break}}setPdfPage(D){this.pdfPage=D,this.pdfPageRotate=D.rotate;const Y=(this.rotation+this.pdfPageRotate)%360;this.viewport=D.getViewport({scale:this.scale*f.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:Y}),ee(this,le,Pt).call(this),this.reset()}destroy(){var D;this.reset(),(D=this.pdfPage)==null||D.cleanup()}get _textHighlighter(){return(0,f.shadow)(this,"_textHighlighter",new E.TextHighlighter({pageIndex:this.id-1,eventBus:this.eventBus,findController:u(this,m).call(this).findController}))}_resetZoomLayer(D=!1){if(!this.zoomLayer)return;const Y=this.zoomLayer.firstChild;this.paintedViewportMap.delete(Y),Y.width=0,Y.height=0,D&&this.zoomLayer.remove(),this.zoomLayer=null}reset({keepZoomLayer:D=!1,keepAnnotationLayer:Y=!1,keepAnnotationEditorLayer:te=!1,keepXfaLayer:V=!1,keepTextLayer:N=!1}={}){var X,Q,pe,ce,_e;this.cancelRendering({keepAnnotationLayer:Y,keepAnnotationEditorLayer:te,keepXfaLayer:V,keepTextLayer:N}),this.renderingState=l.RenderingStates.INITIAL;const a=this.div,_=a.childNodes,y=D&&this.zoomLayer||null,k=Y&&((X=this.annotationLayer)==null?void 0:X.div)||null,U=te&&((Q=this.annotationEditorLayer)==null?void 0:Q.div)||null,$=V&&((pe=this.xfaLayer)==null?void 0:pe.div)||null,he=N&&((ce=this.textLayer)==null?void 0:ce.div)||null;for(let Se=_.length-1;Se>=0;Se--){const Pe=_[Se];switch(Pe){case y:case k:case U:case $:case he:continue}Pe.remove()}a.removeAttribute("data-loaded"),k&&this.annotationLayer.hide(),U&&this.annotationEditorLayer.hide(),$&&this.xfaLayer.hide(),he&&this.textLayer.hide(),(_e=this.structTreeLayer)==null||_e.hide(),y||(this.canvas&&(this.paintedViewportMap.delete(this.canvas),this.canvas.width=0,this.canvas.height=0,delete this.canvas),this._resetZoomLayer()),this.svg&&(this.paintedViewportMap.delete(this.svg),delete this.svg)}update({scale:D=0,rotation:Y=null,optionalContentConfigPromise:te=null,drawingDelay:V=-1}){var k;this.scale=D||this.scale,typeof Y=="number"&&(this.rotation=Y),te instanceof Promise&&(this._optionalContentConfigPromise=te,te.then(U=>{te===this._optionalContentConfigPromise&&(u(this,J).initialOptionalContent=U.hasInitialVisibility)}));const N=(this.rotation+this.pdfPageRotate)%360;if(this.viewport=this.viewport.clone({scale:this.scale*f.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:N}),ee(this,le,Pt).call(this),this._isStandalone&&((k=this.div.parentNode)==null||k.style.setProperty("--scale-factor",this.viewport.scale)),this.svg){this.cssTransform({target:this.svg,redrawAnnotationLayer:!0,redrawAnnotationEditorLayer:!0,redrawXfaLayer:!0,redrawTextLayer:!0}),this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!0,timestamp:performance.now(),error:this._renderError});return}let a=!1;if(this.canvas&&this.maxCanvasPixels>0){const U=this.outputScale;(Math.floor(this.viewport.width)*U.sx|0)*(Math.floor(this.viewport.height)*U.sy|0)>this.maxCanvasPixels&&(a=!0)}const _=this.useOnlyCssZoom||this.hasRestrictedScaling&&a,y=!_&&V>=0&&V<1e3;if(this.canvas){if(y||_){y&&this.renderingState!==l.RenderingStates.FINISHED&&(this.cancelRendering({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0,cancelExtraDelay:V}),this.renderingState=l.RenderingStates.FINISHED),this.cssTransform({target:this.canvas,redrawAnnotationLayer:!0,redrawAnnotationEditorLayer:!0,redrawXfaLayer:!0,redrawTextLayer:!y,hideTextLayer:y}),this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!0,timestamp:performance.now(),error:this._renderError});return}!this.zoomLayer&&!this.canvas.hidden&&(this.zoomLayer=this.canvas.parentNode,this.zoomLayer.style.position="absolute")}this.zoomLayer&&this.cssTransform({target:this.zoomLayer.firstChild}),this.reset({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0})}cancelRendering({keepAnnotationLayer:D=!1,keepAnnotationEditorLayer:Y=!1,keepXfaLayer:te=!1,keepTextLayer:V=!1,cancelExtraDelay:N=0}={}){var a;this.paintTask&&(this.paintTask.cancel(N),this.paintTask=null),this.resume=null,this.textLayer&&(!V||!this.textLayer.div)&&(this.textLayer.cancel(),this.textLayer=null),this.structTreeLayer&&!this.textLayer&&(this.structTreeLayer=null),this.annotationLayer&&(!D||!this.annotationLayer.div)&&(this.annotationLayer.cancel(),this.annotationLayer=null,this._annotationCanvasMap=null),this.annotationEditorLayer&&(!Y||!this.annotationEditorLayer.div)&&(this.annotationEditorLayer.cancel(),this.annotationEditorLayer=null),this.xfaLayer&&(!te||!this.xfaLayer.div)&&(this.xfaLayer.cancel(),this.xfaLayer=null,(a=this._textHighlighter)==null||a.disable())}cssTransform({target:D,redrawAnnotationLayer:Y=!1,redrawAnnotationEditorLayer:te=!1,redrawXfaLayer:V=!1,redrawTextLayer:N=!1,hideTextLayer:a=!1}){var y;if(D instanceof HTMLCanvasElement){if(!D.hasAttribute("zooming")){D.setAttribute("zooming",!0);const{style:k}=D;k.width=k.height=""}}else{const k=this.div,{width:U,height:$}=this.viewport;D.style.width=D.parentNode.style.width=k.style.width=Math.floor(U)+"px",D.style.height=D.parentNode.style.height=k.style.height=Math.floor($)+"px"}const _=this.paintedViewportMap.get(D);if(this.viewport!==_){const k=this.viewport.rotation-_.rotation,U=Math.abs(k);let $=1,he=1;if(U===90||U===270){const{width:X,height:Q}=this.viewport;$=Q/X,he=X/Q}D.style.transform=`rotate(${k}deg) scale(${$}, ${he})`}Y&&this.annotationLayer&&ee(this,re,ii).call(this),te&&this.annotationEditorLayer&&ee(this,K,ni).call(this),V&&this.xfaLayer&&ee(this,Ee,si).call(this),this.textLayer&&(a?(this.textLayer.hide(),(y=this.structTreeLayer)==null||y.hide()):N&&ee(this,W,ri).call(this))}get width(){return this.viewport.width}get height(){return this.viewport.height}getPagePoint(D,Y){return this.viewport.convertToPdfPoint(D,Y)}draw(){this.renderingState!==l.RenderingStates.INITIAL&&(console.error("Must be in new state before drawing"),this.reset());const{div:D,pdfPage:Y}=this;if(!Y)return this.renderingState=l.RenderingStates.FINISHED,Promise.reject(new Error("pdfPage is not loaded"));this.renderingState=l.RenderingStates.RUNNING;const te=document.createElement("div");if(te.classList.add("canvasWrapper"),D.append(te),!this.textLayer&&this.textLayerMode!==l.TextLayerMode.DISABLE&&!Y.isPureXfa&&(this._accessibilityManager||(this._accessibilityManager=new o.TextAccessibilityManager),this.textLayer=new b.TextLayerBuilder({highlighter:this._textHighlighter,accessibilityManager:this._accessibilityManager,isOffscreenCanvasSupported:this.isOffscreenCanvasSupported}),D.append(this.textLayer.div)),!this.annotationLayer&&u(this,s)!==f.AnnotationMode.DISABLE){const{annotationStorage:y,downloadManager:k,enableScripting:U,fieldObjectsPromise:$,hasJSActionsPromise:he,linkService:X}=u(this,m).call(this);this._annotationCanvasMap||(this._annotationCanvasMap=new Map),this.annotationLayer=new S.AnnotationLayerBuilder({pageDiv:D,pdfPage:Y,annotationStorage:y,imageResourcesPath:this.imageResourcesPath,renderForms:u(this,s)===f.AnnotationMode.ENABLE_FORMS,linkService:X,downloadManager:k,l10n:this.l10n,enableScripting:U,hasJSActionsPromise:he,fieldObjectsPromise:$,annotationCanvasMap:this._annotationCanvasMap,accessibilityManager:this._accessibilityManager})}let V=null;this.renderingQueue&&(V=d(y=>{if(!this.renderingQueue.isHighestPriority(this)){this.renderingState=l.RenderingStates.PAUSED,this.resume=()=>{this.renderingState=l.RenderingStates.RUNNING,y()};return}y()},"renderContinueCallback"));const N=d(async(y=null)=>{if(a===this.paintTask&&(this.paintTask=null),y instanceof f.RenderingCancelledException){this._renderError=null;return}if(this._renderError=y,this.renderingState=l.RenderingStates.FINISHED,this._resetZoomLayer(!0),u(this,J).regularAnnotations=!a.separateAnnots,this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!1,timestamp:performance.now(),error:this._renderError}),y)throw y},"finishPaintTask"),a=this.renderer===l.RendererType.SVG?this.paintOnSvg(te):this.paintOnCanvas(te);a.onRenderContinue=V,this.paintTask=a;const _=a.promise.then(()=>N(null).then(async()=>{if(ee(this,W,ri).call(this),this.annotationLayer&&await ee(this,re,ii).call(this),!this.annotationEditorLayer){const{annotationEditorUIManager:y}=u(this,m).call(this);if(!y)return;this.annotationEditorLayer=new w.AnnotationEditorLayerBuilder({uiManager:y,pageDiv:D,pdfPage:Y,l10n:this.l10n,accessibilityManager:this._accessibilityManager})}ee(this,K,ni).call(this)}),function(y){return N(y)});if(Y.isPureXfa){if(this.xfaLayer)this.xfaLayer.div&&D.append(this.xfaLayer.div);else{const{annotationStorage:y,linkService:k}=u(this,m).call(this);this.xfaLayer=new p.XfaLayerBuilder({pageDiv:D,pdfPage:Y,annotationStorage:y,linkService:k})}ee(this,Ee,si).call(this)}return D.setAttribute("data-loaded",!0),this.eventBus.dispatch("pagerender",{source:this,pageNumber:this.id}),_}paintOnCanvas(D){var Pe,Re;const Y=(0,f.createPromiseCapability)(),te={promise:Y.promise,onRenderContinue(T){T()},cancel(T=0){Se.cancel(T)},get separateAnnots(){return Se.separateAnnots}},V=this.viewport,{width:N,height:a}=V,_=document.createElement("canvas");_.setAttribute("role","presentation"),_.hidden=!0;let y=!0;const k=!!((Pe=this.pageColors)!=null&&Pe.background&&((Re=this.pageColors)!=null&&Re.foreground)),U=d(function(T){y&&(!k||T)&&(_.hidden=!1,y=!1)},"showCanvas");D.append(_),this.canvas=_;const $=_.getContext("2d",{alpha:!1}),he=this.outputScale=new l.OutputScale;if(this.useOnlyCssZoom){const T=V.clone({scale:f.PixelsPerInch.PDF_TO_CSS_UNITS});he.sx*=T.width/N,he.sy*=T.height/a}if(this.maxCanvasPixels>0){const T=N*a,se=Math.sqrt(this.maxCanvasPixels/T);he.sx>se||he.sy>se?(he.sx=se,he.sy=se,this.hasRestrictedScaling=!0):this.hasRestrictedScaling=!1}const X=(0,l.approximateFraction)(he.sx),Q=(0,l.approximateFraction)(he.sy);_.width=(0,l.roundToDivide)(V.width*he.sx,X[0]),_.height=(0,l.roundToDivide)(V.height*he.sy,Q[0]);const{style:pe}=_;pe.width=(0,l.roundToDivide)(V.width,X[1])+"px",pe.height=(0,l.roundToDivide)(V.height,Q[1])+"px",this.paintedViewportMap.set(_,V);const ce=he.scaled?[he.sx,0,0,he.sy,0,0]:null,_e={canvasContext:$,transform:ce,viewport:V,annotationMode:u(this,s),optionalContentConfigPromise:this._optionalContentConfigPromise,annotationCanvasMap:this._annotationCanvasMap,pageColors:this.pageColors},Se=this.pdfPage.render(_e);return Se.onContinue=function(T){U(!1),te.onRenderContinue?te.onRenderContinue(T):T()},Se.promise.then(function(){U(!0),Y.resolve()},function(T){T instanceof f.RenderingCancelledException||U(!0),Y.reject(T)}),te}paintOnSvg(D){let Y=!1;const te=d(()=>{if(Y)throw new f.RenderingCancelledException(`Rendering cancelled, page ${this.id}`,"svg")},"ensureNotCancelled"),V=this.pdfPage,N=this.viewport.clone({scale:f.PixelsPerInch.PDF_TO_CSS_UNITS});return{promise:V.getOperatorList({annotationMode:u(this,s)}).then(_=>(te(),new f.SVGGraphics(V.commonObjs,V.objs).getSVG(_,N).then(k=>{te(),this.svg=k,this.paintedViewportMap.set(k,N),k.style.width=D.style.width,k.style.height=D.style.height,this.renderingState=l.RenderingStates.FINISHED,D.append(k)}))),onRenderContinue(_){_()},cancel(){Y=!0},get separateAnnots(){return!1}}}setPageLabel(D){this.pageLabel=typeof D=="string"?D:null,this.pageLabel!==null?this.div.setAttribute("data-page-label",this.pageLabel):this.div.removeAttribute("data-page-label")}get thumbnailCanvas(){const{initialOptionalContent:D,regularAnnotations:Y}=u(this,J);return D&&Y?this.canvas:null}}d(r,"PDFPageView"),s=new WeakMap,m=new WeakMap,P=new WeakMap,h=new WeakMap,F=new WeakMap,J=new WeakMap,le=new WeakSet,Pt=d(function(){const{viewport:D}=this;if(this.pdfPage){if(u(this,h)===D.rotation)return;ve(this,h,D.rotation)}(0,f.setLayerDimensions)(this.div,D,!0,!1)},"#setDimensions"),re=new WeakSet,ii=d(async function(){let D=null;try{await this.annotationLayer.render(this.viewport,"display")}catch(Y){console.error(`#renderAnnotationLayer: "${Y}".`),D=Y}finally{this.eventBus.dispatch("annotationlayerrendered",{source:this,pageNumber:this.id,error:D})}},"#renderAnnotationLayer"),K=new WeakSet,ni=d(async function(){let D=null;try{await this.annotationEditorLayer.render(this.viewport,"display")}catch(Y){console.error(`#renderAnnotationEditorLayer: "${Y}".`),D=Y}finally{this.eventBus.dispatch("annotationeditorlayerrendered",{source:this,pageNumber:this.id,error:D})}},"#renderAnnotationEditorLayer"),Ee=new WeakSet,si=d(async function(){let D=null;try{const Y=await this.xfaLayer.render(this.viewport,"display");Y!=null&&Y.textDivs&&this._textHighlighter&&ee(this,z,qi).call(this,Y.textDivs)}catch(Y){console.error(`#renderXfaLayer: "${Y}".`),D=Y}finally{this.eventBus.dispatch("xfalayerrendered",{source:this,pageNumber:this.id,error:D})}},"#renderXfaLayer"),W=new WeakSet,ri=d(async function(){const{pdfPage:D,textLayer:Y,viewport:te}=this;if(!Y)return;let V=null;try{if(!Y.renderingDone){const N=D.streamTextContent({includeMarkedContent:!0});Y.setTextContentSource(N)}await Y.render(te)}catch(N){if(N instanceof f.AbortException)return;console.error(`#renderTextLayer: "${N}".`),V=N}this.eventBus.dispatch("textlayerrendered",{source:this,pageNumber:this.id,numTextDivs:Y.numTextDivs,error:V}),ee(this,v,Xi).call(this)},"#renderTextLayer"),v=new WeakSet,Xi=d(async function(){var te,V,N;if(!this.textLayer)return;this.structTreeLayer||(this.structTreeLayer=new n.StructTreeLayerBuilder);const D=await(this.structTreeLayer.renderingDone?null:this.pdfPage.getStructTree()),Y=(te=this.structTreeLayer)==null?void 0:te.render(D);Y&&((V=this.canvas)==null||V.append(Y)),(N=this.structTreeLayer)==null||N.show()},"#renderStructTreeLayer"),z=new WeakSet,qi=d(async function(D){const Y=await this.pdfPage.getTextContent(),te=[];for(const V of Y.items)te.push(V.str);this._textHighlighter.setTextMapping(D,te),this._textHighlighter.enable()},"#buildXfaTextContentItems"),L.PDFPageView=r},(G,L,I)=>{var S;Object.defineProperty(L,"__esModule",{value:!0}),L.AnnotationEditorLayerBuilder=void 0;var f=I(4),l=I(5);class w{constructor(i){Z(this,S,void 0);this.pageDiv=i.pageDiv,this.pdfPage=i.pdfPage,this.accessibilityManager=i.accessibilityManager,this.l10n=i.l10n||l.NullL10n,this.annotationEditorLayer=null,this.div=null,this._cancelled=!1,ve(this,S,i.uiManager)}async render(i,c="display"){if(c!=="display"||this._cancelled)return;const n=i.clone({dontFlip:!0});if(this.div){this.annotationEditorLayer.update({viewport:n}),this.show();return}const o=this.div=document.createElement("div");o.className="annotationEditorLayer",o.tabIndex=0,o.hidden=!0,this.pageDiv.append(o),this.annotationEditorLayer=new f.AnnotationEditorLayer({uiManager:u(this,S),div:o,accessibilityManager:this.accessibilityManager,pageIndex:this.pdfPage.pageNumber-1,l10n:this.l10n,viewport:n});const E={viewport:n,div:o,annotations:null,intent:c};this.annotationEditorLayer.render(E),this.show()}cancel(){this._cancelled=!0,this.div&&(this.pageDiv=null,this.annotationEditorLayer.destroy(),this.div.remove())}hide(){this.div&&(this.div.hidden=!0)}show(){!this.div||this.annotationEditorLayer.isEmpty||(this.div.hidden=!1)}}d(w,"AnnotationEditorLayerBuilder"),S=new WeakMap,L.AnnotationEditorLayerBuilder=w},(G,L)=>{Object.defineProperty(L,"__esModule",{value:!0}),L.compatibilityParams=L.OptionKind=L.AppOptions=void 0;const I=Object.create(null);L.compatibilityParams=I;{const g=navigator.userAgent||"",i=navigator.platform||"",c=navigator.maxTouchPoints||1,n=/Android/.test(g),o=/\b(iPad|iPhone|iPod)(?=;)/.test(g)||i==="MacIntel"&&c>1;d(function(){(o||n)&&(I.maxCanvasPixels=5242880)},"checkCanvasSizeLimitation")()}const f={VIEWER:2,API:4,WORKER:8,PREFERENCE:128};L.OptionKind=f;const l={annotationEditorMode:{value:0,kind:f.VIEWER+f.PREFERENCE},annotationMode:{value:2,kind:f.VIEWER+f.PREFERENCE},cursorToolOnLoad:{value:0,kind:f.VIEWER+f.PREFERENCE},defaultZoomDelay:{value:400,kind:f.VIEWER+f.PREFERENCE},defaultZoomValue:{value:"",kind:f.VIEWER+f.PREFERENCE},disableHistory:{value:!1,kind:f.VIEWER},disablePageLabels:{value:!1,kind:f.VIEWER+f.PREFERENCE},enablePermissions:{value:!1,kind:f.VIEWER+f.PREFERENCE},enablePrintAutoRotate:{value:!0,kind:f.VIEWER+f.PREFERENCE},enableScripting:{value:!0,kind:f.VIEWER+f.PREFERENCE},externalLinkRel:{value:"noopener noreferrer nofollow",kind:f.VIEWER},externalLinkTarget:{value:0,kind:f.VIEWER+f.PREFERENCE},historyUpdateUrl:{value:!1,kind:f.VIEWER+f.PREFERENCE},ignoreDestinationZoom:{value:!1,kind:f.VIEWER+f.PREFERENCE},imageResourcesPath:{value:"./images/",kind:f.VIEWER},maxCanvasPixels:{value:16777216,kind:f.VIEWER},forcePageColors:{value:!1,kind:f.VIEWER+f.PREFERENCE},pageColorsBackground:{value:"Canvas",kind:f.VIEWER+f.PREFERENCE},pageColorsForeground:{value:"CanvasText",kind:f.VIEWER+f.PREFERENCE},pdfBugEnabled:{value:!1,kind:f.VIEWER+f.PREFERENCE},printResolution:{value:150,kind:f.VIEWER},sidebarViewOnLoad:{value:-1,kind:f.VIEWER+f.PREFERENCE},scrollModeOnLoad:{value:-1,kind:f.VIEWER+f.PREFERENCE},spreadModeOnLoad:{value:-1,kind:f.VIEWER+f.PREFERENCE},textLayerMode:{value:1,kind:f.VIEWER+f.PREFERENCE},useOnlyCssZoom:{value:!1,kind:f.VIEWER+f.PREFERENCE},viewerCssTheme:{value:0,kind:f.VIEWER+f.PREFERENCE},viewOnLoad:{value:0,kind:f.VIEWER+f.PREFERENCE},cMapPacked:{value:!0,kind:f.API},cMapUrl:{value:"../web/cmaps/",kind:f.API},disableAutoFetch:{value:!1,kind:f.API+f.PREFERENCE},disableFontFace:{value:!1,kind:f.API+f.PREFERENCE},disableRange:{value:!1,kind:f.API+f.PREFERENCE},disableStream:{value:!1,kind:f.API+f.PREFERENCE},docBaseUrl:{value:"",kind:f.API},enableXfa:{value:!0,kind:f.API+f.PREFERENCE},fontExtraProperties:{value:!1,kind:f.API},isEvalSupported:{value:!0,kind:f.API},isOffscreenCanvasSupported:{value:!0,kind:f.API},maxImageSize:{value:-1,kind:f.API},pdfBug:{value:!1,kind:f.API},standardFontDataUrl:{value:"../web/standard_fonts/",kind:f.API},verbosity:{value:1,kind:f.API},workerPort:{value:null,kind:f.WORKER},workerSrc:{value:"../build/pdf.worker.js",kind:f.WORKER}};l.defaultUrl={value:"compressed.tracemonkey-pldi-09.pdf",kind:f.VIEWER},l.disablePreferences={value:!1,kind:f.VIEWER},l.locale={value:navigator.language||"en-US",kind:f.VIEWER},l.renderer={value:"canvas",kind:f.VIEWER+f.PREFERENCE},l.sandboxBundleSrc={value:"../build/pdf.sandbox.js",kind:f.VIEWER};const w=Object.create(null);class S{constructor(){throw new Error("Cannot initialize AppOptions.")}static get(i){const c=w[i];if(c!==void 0)return c;const n=l[i];if(n!==void 0)return I[i]??n.value}static getAll(i=null){const c=Object.create(null);for(const n in l){const o=l[n];if(i){if(!(i&o.kind))continue;if(i===f.PREFERENCE){const b=o.value,p=typeof b;if(p==="boolean"||p==="string"||p==="number"&&Number.isInteger(b)){c[n]=b;continue}throw new Error(`Invalid type for preference: ${n}`)}}const E=w[n];c[n]=E!==void 0?E:I[n]??o.value}return c}static set(i,c){w[i]=c}static setAll(i){for(const c in i)w[c]=i[c]}static remove(i){delete w[i]}}d(S,"AppOptions"),L.AppOptions=S,S._hasUserOptions=function(){return Object.keys(w).length>0}},(G,L)=>{var w,S,ai,i,oi;Object.defineProperty(L,"__esModule",{value:!0}),L.StructTreeLayerBuilder=void 0;const I={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},f=/^H(\d+)$/;class l{constructor(){Z(this,S);Z(this,i);Z(this,w,void 0)}get renderingDone(){return u(this,w)!==void 0}render(o){if(u(this,w)!==void 0)return u(this,w);const E=ee(this,i,oi).call(this,o);return E==null||E.classList.add("structTree"),ve(this,w,E)}hide(){u(this,w)&&!u(this,w).hidden&&(u(this,w).hidden=!0)}show(){var o;(o=u(this,w))!=null&&o.hidden&&(u(this,w).hidden=!1)}}d(l,"StructTreeLayerBuilder"),w=new WeakMap,S=new WeakSet,ai=d(function(o,E){o.alt!==void 0&&E.setAttribute("aria-label",o.alt),o.id!==void 0&&E.setAttribute("aria-owns",o.id),o.lang!==void 0&&E.setAttribute("lang",o.lang)},"#setAttributes"),i=new WeakSet,oi=d(function(o){if(!o)return null;const E=document.createElement("span");if("role"in o){const{role:b}=o,p=b.match(f);p?(E.setAttribute("role","heading"),E.setAttribute("aria-level",p[1])):I[b]&&E.setAttribute("role",I[b])}if(ee(this,S,ai).call(this,o,E),o.children)if(o.children.length===1&&"id"in o.children[0])ee(this,S,ai).call(this,o.children[0],E);else for(const b of o.children)E.append(ee(this,i,oi).call(this,b));return E},"#walk"),L.StructTreeLayerBuilder=l},(G,L,I)=>{var w,S,g,i,c,Ct,o,li;Object.defineProperty(L,"__esModule",{value:!0}),L.TextAccessibilityManager=void 0;var f=I(2);const b=class{constructor(){Z(this,o);Z(this,w,!1);Z(this,S,null);Z(this,g,new Map);Z(this,i,new Map)}setTextMapping(e){ve(this,S,e)}enable(){if(u(this,w))throw new Error("TextAccessibilityManager is already enabled.");if(!u(this,S))throw new Error("Text divs and strings have not been set.");if(ve(this,w,!0),ve(this,S,u(this,S).slice()),u(this,S).sort(ee(b,c,Ct)),u(this,g).size>0){const e=u(this,S);for(const[t,r]of u(this,g)){if(!document.getElementById(t)){u(this,g).delete(t);continue}ee(this,o,li).call(this,t,e[r])}}for(const[e,t]of u(this,i))this.addPointerInTextLayer(e,t);u(this,i).clear()}disable(){u(this,w)&&(u(this,i).clear(),ve(this,S,null),ve(this,w,!1))}removePointerInTextLayer(e){if(!u(this,w)){u(this,i).delete(e);return}const t=u(this,S);if(!t||t.length===0)return;const{id:r}=e,s=u(this,g).get(r);if(s===void 0)return;const m=t[s];u(this,g).delete(r);let P=m.getAttribute("aria-owns");P!=null&&P.includes(r)&&(P=P.split(" ").filter(h=>h!==r).join(" "),P?m.setAttribute("aria-owns",P):(m.removeAttribute("aria-owns"),m.setAttribute("role","presentation")))}addPointerInTextLayer(e,t){const{id:r}=e;if(!r)return;if(!u(this,w)){u(this,i).set(e,t);return}t&&this.removePointerInTextLayer(e);const s=u(this,S);if(!s||s.length===0)return;const m=(0,f.binarySearchFirstItem)(s,h=>{var F;return ee(F=b,c,Ct).call(F,e,h)<0}),P=Math.max(0,m-1);ee(this,o,li).call(this,r,s[P]),u(this,g).set(r,P)}moveElementInDOM(e,t,r,s){if(this.addPointerInTextLayer(r,s),!e.hasChildNodes()){e.append(t);return}const m=Array.from(e.childNodes).filter(F=>F!==t);if(m.length===0)return;const P=r||t,h=(0,f.binarySearchFirstItem)(m,F=>{var J;return ee(J=b,c,Ct).call(J,P,F)<0});h===0?m[0].before(t):m[h-1].after(t)}};let l=b;d(l,"TextAccessibilityManager"),w=new WeakMap,S=new WeakMap,g=new WeakMap,i=new WeakMap,c=new WeakSet,Ct=d(function(e,t){const r=e.getBoundingClientRect(),s=t.getBoundingClientRect();if(r.width===0&&r.height===0)return 1;if(s.width===0&&s.height===0)return-1;const m=r.y,P=r.y+r.height,h=r.y+r.height/2,F=s.y,J=s.y+s.height,le=s.y+s.height/2;if(h<=F&&le>=P)return-1;if(le<=m&&h>=J)return 1;const q=r.x+r.width/2,re=s.x+s.width/2;return q-re},"#compareElementPositions"),o=new WeakSet,li=d(function(e,t){const r=t.getAttribute("aria-owns");r!=null&&r.includes(e)||t.setAttribute("aria-owns",r?`${r} ${e}`:e),t.removeAttribute("role")},"#addIdToAriaOwns"),Z(l,c),L.TextAccessibilityManager=l},(G,L)=>{Object.defineProperty(L,"__esModule",{value:!0}),L.TextHighlighter=void 0;class I{constructor({findController:l,eventBus:w,pageIndex:S}){this.findController=l,this.matches=[],this.eventBus=w,this.pageIdx=S,this._onUpdateTextLayerMatches=null,this.textDivs=null,this.textContentItemsStr=null,this.enabled=!1}setTextMapping(l,w){this.textDivs=l,this.textContentItemsStr=w}enable(){if(!this.textDivs||!this.textContentItemsStr)throw new Error("Text divs and strings have not been set.");if(this.enabled)throw new Error("TextHighlighter is already enabled.");this.enabled=!0,this._onUpdateTextLayerMatches||(this._onUpdateTextLayerMatches=l=>{(l.pageIndex===this.pageIdx||l.pageIndex===-1)&&this._updateMatches()},this.eventBus._on("updatetextlayermatches",this._onUpdateTextLayerMatches)),this._updateMatches()}disable(){this.enabled&&(this.enabled=!1,this._onUpdateTextLayerMatches&&(this.eventBus._off("updatetextlayermatches",this._onUpdateTextLayerMatches),this._onUpdateTextLayerMatches=null),this._updateMatches(!0))}_convertMatches(l,w){if(!l)return[];const{textContentItemsStr:S}=this;let g=0,i=0;const c=S.length-1,n=[];for(let o=0,E=l.length;o<E;o++){let b=l[o];for(;g!==c&&b>=i+S[g].length;)i+=S[g].length,g++;g===S.length&&console.error("Could not find a matching mapping");const p={begin:{divIdx:g,offset:b-i}};for(b+=w[o];g!==c&&b>i+S[g].length;)i+=S[g].length,g++;p.end={divIdx:g,offset:b-i},n.push(p)}return n}_renderMatches(l){if(l.length===0)return;const{findController:w,pageIdx:S}=this,{textContentItemsStr:g,textDivs:i}=this,c=S===w.selected.pageIdx,n=w.selected.matchIdx,o=w.state.highlightAll;let E=null;const b={divIdx:-1,offset:void 0};function p(s,m){const P=s.divIdx;return i[P].textContent="",e(P,0,s.offset,m)}d(p,"beginText");function e(s,m,P,h){let F=i[s];if(F.nodeType===Node.TEXT_NODE){const q=document.createElement("span");F.before(q),q.append(F),i[s]=q,F=q}const J=g[s].substring(m,P),le=document.createTextNode(J);if(h){const q=document.createElement("span");return q.className=`${h} appended`,q.append(le),F.append(q),h.includes("selected")?q.offsetLeft:0}return F.append(le),0}d(e,"appendTextToDiv");let t=n,r=t+1;if(o)t=0,r=l.length;else if(!c)return;for(let s=t;s<r;s++){const m=l[s],P=m.begin,h=m.end,F=c&&s===n,J=F?" selected":"";let le=0;if(!E||P.divIdx!==E.divIdx?(E!==null&&e(E.divIdx,E.offset,b.offset),p(P)):e(E.divIdx,E.offset,P.offset),P.divIdx===h.divIdx)le=e(P.divIdx,P.offset,h.offset,"highlight"+J);else{le=e(P.divIdx,P.offset,b.offset,"highlight begin"+J);for(let q=P.divIdx+1,re=h.divIdx;q<re;q++)i[q].className="highlight middle"+J;p(h,"highlight end"+J)}E=h,F&&w.scrollMatchIntoView({element:i[P.divIdx],selectedLeft:le,pageIndex:S,matchIndex:n})}E&&e(E.divIdx,E.offset,b.offset)}_updateMatches(l=!1){if(!this.enabled&&!l)return;const{findController:w,matches:S,pageIdx:g}=this,{textContentItemsStr:i,textDivs:c}=this;let n=-1;for(const b of S){const p=Math.max(n,b.begin.divIdx);for(let e=p,t=b.end.divIdx;e<=t;e++){const r=c[e];r.textContent=i[e],r.className=""}n=b.end.divIdx+1}if(!(w!=null&&w.highlightMatches)||l)return;const o=w.pageMatches[g]||null,E=w.pageMatchesLength[g]||null;this.matches=this._convertMatches(o,E),this._renderMatches(this.matches)}}d(I,"TextHighlighter"),L.TextHighlighter=I},(G,L,I)=>{var w,S,g,i,Yi,n,Ki;Object.defineProperty(L,"__esModule",{value:!0}),L.TextLayerBuilder=void 0;var f=I(4);class l{constructor({highlighter:b=null,accessibilityManager:p=null,isOffscreenCanvasSupported:e=!0}){Z(this,i);Z(this,n);Z(this,w,0);Z(this,S,0);Z(this,g,null);this.textContentItemsStr=[],this.renderingDone=!1,this.textDivs=[],this.textDivProperties=new WeakMap,this.textLayerRenderTask=null,this.highlighter=b,this.accessibilityManager=p,this.isOffscreenCanvasSupported=e,this.div=document.createElement("div"),this.div.className="textLayer",this.hide()}get numTextDivs(){return this.textDivs.length}async render(b){var t,r,s;if(!u(this,g))throw new Error('No "textContentSource" parameter specified.');const p=b.scale*(globalThis.devicePixelRatio||1),{rotation:e}=b;if(this.renderingDone){const m=e!==u(this,w),P=p!==u(this,S);(m||P)&&(this.hide(),(0,f.updateTextLayer)({container:this.div,viewport:b,textDivs:this.textDivs,textDivProperties:this.textDivProperties,isOffscreenCanvasSupported:this.isOffscreenCanvasSupported,mustRescale:P,mustRotate:m}),ve(this,S,p),ve(this,w,e)),this.show();return}this.cancel(),(t=this.highlighter)==null||t.setTextMapping(this.textDivs,this.textContentItemsStr),(r=this.accessibilityManager)==null||r.setTextMapping(this.textDivs),this.textLayerRenderTask=(0,f.renderTextLayer)({textContentSource:u(this,g),container:this.div,viewport:b,textDivs:this.textDivs,textDivProperties:this.textDivProperties,textContentItemsStr:this.textContentItemsStr,isOffscreenCanvasSupported:this.isOffscreenCanvasSupported}),await this.textLayerRenderTask.promise,ee(this,i,Yi).call(this),ve(this,S,p),ve(this,w,e),this.show(),(s=this.accessibilityManager)==null||s.enable()}hide(){var b;this.div.hidden||((b=this.highlighter)==null||b.disable(),this.div.hidden=!0)}show(){var b;this.div.hidden&&this.renderingDone&&(this.div.hidden=!1,(b=this.highlighter)==null||b.enable())}cancel(){var b,p;this.textLayerRenderTask&&(this.textLayerRenderTask.cancel(),this.textLayerRenderTask=null),(b=this.highlighter)==null||b.disable(),(p=this.accessibilityManager)==null||p.disable(),this.textContentItemsStr.length=0,this.textDivs.length=0,this.textDivProperties=new WeakMap}setTextContentSource(b){this.cancel(),ve(this,g,b)}}d(l,"TextLayerBuilder"),w=new WeakMap,S=new WeakMap,g=new WeakMap,i=new WeakSet,Yi=d(function(){this.renderingDone=!0;const b=document.createElement("div");b.className="endOfContent",this.div.append(b),ee(this,n,Ki).call(this)},"#finishRendering"),n=new WeakSet,Ki=d(function(){const{div:b}=this;b.addEventListener("mousedown",p=>{const e=b.querySelector(".endOfContent");if(!e)return;let t=p.target!==b;if(t&&(t=getComputedStyle(e).getPropertyValue("-moz-user-select")!=="none"),t){const r=b.getBoundingClientRect(),s=Math.max(0,(p.pageY-r.top)/r.height);e.style.top=(s*100).toFixed(2)+"%"}e.classList.add("active")}),b.addEventListener("mouseup",()=>{const p=b.querySelector(".endOfContent");p&&(p.style.top="",p.classList.remove("active"))})},"#bindMouse"),L.TextLayerBuilder=l},(G,L,I)=>{Object.defineProperty(L,"__esModule",{value:!0}),L.XfaLayerBuilder=void 0;var f=I(4);class l{constructor({pageDiv:S,pdfPage:g,annotationStorage:i=null,linkService:c,xfaHtml:n=null}){this.pageDiv=S,this.pdfPage=g,this.annotationStorage=i,this.linkService=c,this.xfaHtml=n,this.div=null,this._cancelled=!1}async render(S,g="display"){if(g==="print"){const n={viewport:S.clone({dontFlip:!0}),div:this.div,xfaHtml:this.xfaHtml,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:g},o=document.createElement("div");return this.pageDiv.append(o),n.div=o,f.XfaLayer.render(n)}const i=await this.pdfPage.getXfa();if(this._cancelled||!i)return{textDivs:[]};const c={viewport:S.clone({dontFlip:!0}),div:this.div,xfaHtml:i,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:g};return this.div?f.XfaLayer.update(c):(this.div=document.createElement("div"),this.pageDiv.append(this.div),c.div=this.div,f.XfaLayer.render(c))}cancel(){this._cancelled=!0}hide(){this.div&&(this.div.hidden=!0)}}d(l,"XfaLayerBuilder"),L.XfaLayerBuilder=l},(G,L,I)=>{Object.defineProperty(L,"__esModule",{value:!0}),L.PDFScriptingManager=void 0;var f=I(2),l=I(4);class w{constructor({eventBus:g,sandboxBundleSrc:i=null,scriptingFactory:c=null,docPropertiesLookup:n=null}){this._pdfDocument=null,this._pdfViewer=null,this._closeCapability=null,this._destroyCapability=null,this._scripting=null,this._ready=!1,this._eventBus=g,this._sandboxBundleSrc=i,this._scriptingFactory=c,this._docPropertiesLookup=n,this._scriptingFactory||window.addEventListener("updatefromsandbox",o=>{this._eventBus.dispatch("updatefromsandbox",{source:window,detail:o.detail})})}setViewer(g){this._pdfViewer=g}async setDocument(g){var o;if(this._pdfDocument&&await this._destroyScripting(),this._pdfDocument=g,!g)return;const[i,c,n]=await Promise.all([g.getFieldObjects(),g.getCalculationOrderIds(),g.getJSActions()]);if(!i&&!n){await this._destroyScripting();return}if(g===this._pdfDocument){try{this._scripting=this._createScripting()}catch(E){console.error(`PDFScriptingManager.setDocument: "${E==null?void 0:E.message}".`),await this._destroyScripting();return}this._internalEvents.set("updatefromsandbox",E=>{(E==null?void 0:E.source)===window&&this._updateFromSandbox(E.detail)}),this._internalEvents.set("dispatcheventinsandbox",E=>{var b;(b=this._scripting)==null||b.dispatchEventInSandbox(E.detail)}),this._internalEvents.set("pagechanging",({pageNumber:E,previous:b})=>{E!==b&&(this._dispatchPageClose(b),this._dispatchPageOpen(E))}),this._internalEvents.set("pagerendered",({pageNumber:E})=>{this._pageOpenPending.has(E)&&E===this._pdfViewer.currentPageNumber&&this._dispatchPageOpen(E)}),this._internalEvents.set("pagesdestroy",async E=>{var b,p;await this._dispatchPageClose(this._pdfViewer.currentPageNumber),await((b=this._scripting)==null?void 0:b.dispatchEventInSandbox({id:"doc",name:"WillClose"})),(p=this._closeCapability)==null||p.resolve()});for(const[E,b]of this._internalEvents)this._eventBus._on(E,b);try{const E=await this._getDocProperties();if(g!==this._pdfDocument)return;await this._scripting.createSandbox({objects:i,calculationOrder:c,appInfo:{platform:navigator.platform,language:navigator.language},docInfo:{...E,actions:n}}),this._eventBus.dispatch("sandboxcreated",{source:this})}catch(E){console.error(`PDFScriptingManager.setDocument: "${E==null?void 0:E.message}".`),await this._destroyScripting();return}await((o=this._scripting)==null?void 0:o.dispatchEventInSandbox({id:"doc",name:"Open"})),await this._dispatchPageOpen(this._pdfViewer.currentPageNumber,!0),Promise.resolve().then(()=>{g===this._pdfDocument&&(this._ready=!0)})}}async dispatchWillSave(g){var i;return(i=this._scripting)==null?void 0:i.dispatchEventInSandbox({id:"doc",name:"WillSave"})}async dispatchDidSave(g){var i;return(i=this._scripting)==null?void 0:i.dispatchEventInSandbox({id:"doc",name:"DidSave"})}async dispatchWillPrint(g){var i;return(i=this._scripting)==null?void 0:i.dispatchEventInSandbox({id:"doc",name:"WillPrint"})}async dispatchDidPrint(g){var i;return(i=this._scripting)==null?void 0:i.dispatchEventInSandbox({id:"doc",name:"DidPrint"})}get destroyPromise(){var g;return((g=this._destroyCapability)==null?void 0:g.promise)||null}get ready(){return this._ready}get _internalEvents(){return(0,l.shadow)(this,"_internalEvents",new Map)}get _pageOpenPending(){return(0,l.shadow)(this,"_pageOpenPending",new Set)}get _visitedPages(){return(0,l.shadow)(this,"_visitedPages",new Map)}async _updateFromSandbox(g){var p;const i=this._pdfViewer.isInPresentationMode||this._pdfViewer.isChangingPresentationMode,{id:c,siblings:n,command:o,value:E}=g;if(!c){switch(o){case"clear":console.clear();break;case"error":console.error(E);break;case"layout":{if(i)return;const e=(0,f.apiPageLayoutToViewerModes)(E);this._pdfViewer.spreadMode=e.spreadMode;break}case"page-num":this._pdfViewer.currentPageNumber=E+1;break;case"print":await this._pdfViewer.pagesPromise,this._eventBus.dispatch("print",{source:this});break;case"println":console.log(E);break;case"zoom":if(i)return;this._pdfViewer.currentScaleValue=E;break;case"SaveAs":this._eventBus.dispatch("download",{source:this});break;case"FirstPage":this._pdfViewer.currentPageNumber=1;break;case"LastPage":this._pdfViewer.currentPageNumber=this._pdfViewer.pagesCount;break;case"NextPage":this._pdfViewer.nextPage();break;case"PrevPage":this._pdfViewer.previousPage();break;case"ZoomViewIn":if(i)return;this._pdfViewer.increaseScale();break;case"ZoomViewOut":if(i)return;this._pdfViewer.decreaseScale();break}return}if(i&&g.focus)return;delete g.id,delete g.siblings;const b=n?[c,...n]:[c];for(const e of b){const t=document.querySelector(`[data-element-id="${e}"]`);t?t.dispatchEvent(new CustomEvent("updatefromsandbox",{detail:g})):(p=this._pdfDocument)==null||p.annotationStorage.setValue(e,g)}}async _dispatchPageOpen(g,i=!1){const c=this._pdfDocument,n=this._visitedPages;if(i&&(this._closeCapability=(0,l.createPromiseCapability)()),!this._closeCapability)return;const o=this._pdfViewer.getPageView(g-1);if((o==null?void 0:o.renderingState)!==f.RenderingStates.FINISHED){this._pageOpenPending.add(g);return}this._pageOpenPending.delete(g);const E=(async()=>{var p,e;const b=await(n.has(g)?null:(p=o.pdfPage)==null?void 0:p.getJSActions());c===this._pdfDocument&&await((e=this._scripting)==null?void 0:e.dispatchEventInSandbox({id:"page",name:"PageOpen",pageNumber:g,actions:b}))})();n.set(g,E)}async _dispatchPageClose(g){var o;const i=this._pdfDocument,c=this._visitedPages;if(!this._closeCapability||this._pageOpenPending.has(g))return;const n=c.get(g);n&&(c.set(g,null),await n,i===this._pdfDocument&&await((o=this._scripting)==null?void 0:o.dispatchEventInSandbox({id:"page",name:"PageClose",pageNumber:g})))}async _getDocProperties(){if(this._docPropertiesLookup)return this._docPropertiesLookup(this._pdfDocument);const{docPropertiesLookup:g}=I(22);return g(this._pdfDocument)}_createScripting(){if(this._destroyCapability=(0,l.createPromiseCapability)(),this._scripting)throw new Error("_createScripting: Scripting already exists.");if(this._scriptingFactory)return this._scriptingFactory.createScripting({sandboxBundleSrc:this._sandboxBundleSrc});const{GenericScripting:g}=I(22);return new g(this._sandboxBundleSrc)}async _destroyScripting(){var g,i;if(!this._scripting){this._pdfDocument=null,(g=this._destroyCapability)==null||g.resolve();return}this._closeCapability&&(await Promise.race([this._closeCapability.promise,new Promise(c=>{setTimeout(c,1e3)})]).catch(c=>{}),this._closeCapability=null),this._pdfDocument=null;try{await this._scripting.destroySandbox()}catch{}for(const[c,n]of this._internalEvents)this._eventBus._off(c,n);this._internalEvents.clear(),this._pageOpenPending.clear(),this._visitedPages.clear(),this._scripting=null,this._ready=!1,(i=this._destroyCapability)==null||i.resolve()}}d(w,"PDFScriptingManager"),L.PDFScriptingManager=w},(G,L,I)=>{Object.defineProperty(L,"__esModule",{value:!0}),L.GenericScripting=void 0,L.docPropertiesLookup=l;var f=I(4);async function l(S){const g="",i=g.split("#")[0];let{info:c,metadata:n,contentDispositionFilename:o,contentLength:E}=await S.getMetadata();if(!E){const{length:b}=await S.getDownloadInfo();E=b}return{...c,baseURL:i,filesize:E,filename:o||(0,f.getPdfFilenameFromUrl)(g),metadata:n==null?void 0:n.getRaw(),authors:n==null?void 0:n.get("dc:creator"),numPages:S.numPages,URL:g}}d(l,"docPropertiesLookup");class w{constructor(g){this._ready=(0,f.loadScript)(g,!0).then(()=>window.pdfjsSandbox.QuickJSSandbox())}async createSandbox(g){(await this._ready).create(g)}async dispatchEventInSandbox(g){const i=await this._ready;setTimeout(()=>i.dispatchEvent(g),0)}async destroySandbox(){(await this._ready).nukeSandbox()}}d(w,"GenericScripting"),L.GenericScripting=w},(G,L,I)=>{Object.defineProperty(L,"__esModule",{value:!0}),L.PDFSinglePageViewer=void 0;var f=I(2),l=I(24);class w extends l.PDFViewer{_resetView(){super._resetView(),this._scrollMode=f.ScrollMode.PAGE,this._spreadMode=f.SpreadMode.NONE}set scrollMode(g){}_updateScrollMode(){}set spreadMode(g){}_updateSpreadMode(){}}d(w,"PDFSinglePageViewer"),L.PDFSinglePageViewer=w},(G,L,I)=>{var e,t,r,ci,m,P,h,F,J,le,q,re,fe,K,me,Ee,Zi,W,Qi,v,Ji,z,gt,ne,wt,Y,en,V,hi,a,tn,y,Ze,U,di,he,nn,Q,sn,ce,ui,Se,rn;Object.defineProperty(L,"__esModule",{value:!0}),L.PagesCountLimit=L.PDFViewer=L.PDFPageViewBuffer=void 0;var f=I(4),l=I(2),w=I(5),S=I(13),g=I(25),i=I(1);const c=10,n="enablePermissions",o={FORCE_SCROLL_MODE_PAGE:15e3,FORCE_LAZY_PAGE_INIT:7500,PAUSE_EAGER_PAGE_INIT:250};L.PagesCountLimit=o;function E(Re){return Object.values(f.AnnotationEditorType).includes(Re)&&Re!==f.AnnotationEditorType.DISABLE}d(E,"isValidAnnotationEditorMode");class b{constructor(T){Z(this,r);Z(this,e,new Set);Z(this,t,0);ve(this,t,T)}push(T){const se=u(this,e);se.has(T)&&se.delete(T),se.add(T),se.size>u(this,t)&&ee(this,r,ci).call(this)}resize(T,se=null){ve(this,t,T);const M=u(this,e);if(se){const O=M.size;let j=1;for(const be of M)if(se.has(be.id)&&(M.delete(be),M.add(be)),++j>O)break}for(;M.size>u(this,t);)ee(this,r,ci).call(this)}has(T){return u(this,e).has(T)}[Symbol.iterator](){return u(this,e).keys()}}d(b,"PDFPageViewBuffer"),e=new WeakMap,t=new WeakMap,r=new WeakSet,ci=d(function(){const T=u(this,e).keys().next().value;T==null||T.destroy(),u(this,e).delete(T)},"#destroyFirstView"),L.PDFPageViewBuffer=b;class p{constructor(T){Z(this,Ee);Z(this,W);Z(this,v);Z(this,z);Z(this,ne);Z(this,Y);Z(this,V);Z(this,a);Z(this,y);Z(this,U);Z(this,he);Z(this,Q);Z(this,ce);Z(this,Se);Z(this,m,null);Z(this,P,f.AnnotationEditorType.NONE);Z(this,h,null);Z(this,F,f.AnnotationMode.ENABLE_FORMS);Z(this,J,null);Z(this,le,!1);Z(this,q,0);Z(this,re,new ResizeObserver(ee(this,Se,rn).bind(this)));Z(this,fe,null);Z(this,K,null);Z(this,me,null);var M,O;const se="3.5.141";if(f.version!==se)throw new Error(`The API version "${f.version}" does not match the Viewer version "${se}".`);if(this.container=T.container,this.viewer=T.viewer||T.container.firstElementChild,((M=this.container)==null?void 0:M.tagName)!=="DIV"||((O=this.viewer)==null?void 0:O.tagName)!=="DIV")throw new Error("Invalid `container` and/or `viewer` option.");if(this.container.offsetParent&&getComputedStyle(this.container).position!=="absolute")throw new Error("The `container` must be absolutely positioned.");u(this,re).observe(this.container),this.eventBus=T.eventBus,this.linkService=T.linkService||new i.SimpleLinkService,this.downloadManager=T.downloadManager||null,this.findController=T.findController||null,this._scriptingManager=T.scriptingManager||null,this.textLayerMode=T.textLayerMode??l.TextLayerMode.ENABLE,ve(this,F,T.annotationMode??f.AnnotationMode.ENABLE_FORMS),ve(this,P,T.annotationEditorMode??f.AnnotationEditorType.NONE),this.imageResourcesPath=T.imageResourcesPath||"",this.enablePrintAutoRotate=T.enablePrintAutoRotate||!1,this.removePageBorders=T.removePageBorders||!1,this.renderer=T.renderer||l.RendererType.CANVAS,this.useOnlyCssZoom=T.useOnlyCssZoom||!1,this.isOffscreenCanvasSupported=T.isOffscreenCanvasSupported??!0,this.maxCanvasPixels=T.maxCanvasPixels,this.l10n=T.l10n||w.NullL10n,ve(this,le,T.enablePermissions||!1),this.pageColors=T.pageColors||null,this.pageColors&&!(CSS.supports("color",this.pageColors.background)&&CSS.supports("color",this.pageColors.foreground))&&((this.pageColors.background||this.pageColors.foreground)&&console.warn("PDFViewer: Ignoring `pageColors`-option, since the browser doesn't support the values used."),this.pageColors=null),this.defaultRenderingQueue=!T.renderingQueue,this.defaultRenderingQueue?(this.renderingQueue=new g.PDFRenderingQueue,this.renderingQueue.setViewer(this)):this.renderingQueue=T.renderingQueue,this.scroll=(0,l.watchScroll)(this.container,this._scrollUpdate.bind(this)),this.presentationModeState=l.PresentationModeState.UNKNOWN,this._onBeforeDraw=this._onAfterDraw=null,this._resetView(),this.removePageBorders&&this.viewer.classList.add("removePageBorders"),ee(this,ce,ui).call(this)}get pagesCount(){return this._pages.length}getPageView(T){return this._pages[T]}get pageViewsReady(){return this._pagesCapability.settled?this._pages.every(function(T){return T==null?void 0:T.pdfPage}):!1}get renderForms(){return u(this,F)===f.AnnotationMode.ENABLE_FORMS}get enableScripting(){return!!this._scriptingManager}get currentPageNumber(){return this._currentPageNumber}set currentPageNumber(T){if(!Number.isInteger(T))throw new Error("Invalid page number.");this.pdfDocument&&(this._setCurrentPageNumber(T,!0)||console.error(`currentPageNumber: "${T}" is not a valid page.`))}_setCurrentPageNumber(T,se=!1){var O;if(this._currentPageNumber===T)return se&&ee(this,U,di).call(this),!0;if(!(0<T&&T<=this.pagesCount))return!1;const M=this._currentPageNumber;return this._currentPageNumber=T,this.eventBus.dispatch("pagechanging",{source:this,pageNumber:T,pageLabel:((O=this._pageLabels)==null?void 0:O[T-1])??null,previous:M}),se&&ee(this,U,di).call(this),!0}get currentPageLabel(){var T;return((T=this._pageLabels)==null?void 0:T[this._currentPageNumber-1])??null}set currentPageLabel(T){if(!this.pdfDocument)return;let se=T|0;if(this._pageLabels){const M=this._pageLabels.indexOf(T);M>=0&&(se=M+1)}this._setCurrentPageNumber(se,!0)||console.error(`currentPageLabel: "${T}" is not a valid page.`)}get currentScale(){return this._currentScale!==l.UNKNOWN_SCALE?this._currentScale:l.DEFAULT_SCALE}set currentScale(T){if(isNaN(T))throw new Error("Invalid numeric scale.");this.pdfDocument&&ee(this,y,Ze).call(this,T,{noScroll:!1})}get currentScaleValue(){return this._currentScaleValue}set currentScaleValue(T){this.pdfDocument&&ee(this,y,Ze).call(this,T,{noScroll:!1})}get pagesRotation(){return this._pagesRotation}set pagesRotation(T){if(!(0,l.isValidRotation)(T))throw new Error("Invalid pages rotation angle.");if(!this.pdfDocument||(T%=360,T<0&&(T+=360),this._pagesRotation===T))return;this._pagesRotation=T;const se=this._currentPageNumber;this.refresh(!0,{rotation:T}),this._currentScaleValue&&ee(this,y,Ze).call(this,this._currentScaleValue,{noScroll:!0}),this.eventBus.dispatch("rotationchanging",{source:this,pagesRotation:T,pageNumber:se}),this.defaultRenderingQueue&&this.update()}get firstPagePromise(){return this.pdfDocument?this._firstPageCapability.promise:null}get onePageRendered(){return this.pdfDocument?this._onePageRenderedCapability.promise:null}get pagesPromise(){return this.pdfDocument?this._pagesCapability.promise:null}setDocument(T){var be,Te;if(this.pdfDocument&&(this.eventBus.dispatch("pagesdestroy",{source:this}),this._cancelRendering(),this._resetView(),(be=this.findController)==null||be.setDocument(null),(Te=this._scriptingManager)==null||Te.setDocument(null),u(this,h)&&(u(this,h).destroy(),ve(this,h,null))),this.pdfDocument=T,!T)return;const se=T.numPages,M=T.getPage(1),O=T.getOptionalContentConfig(),j=u(this,le)?T.getPermissions():Promise.resolve();if(se>o.FORCE_SCROLL_MODE_PAGE){console.warn("Forcing PAGE-scrolling for performance reasons, given the length of the document.");const ie=this._scrollMode=l.ScrollMode.PAGE;this.eventBus.dispatch("scrollmodechanged",{source:this,mode:ie})}this._pagesCapability.promise.then(()=>{this.eventBus.dispatch("pagesloaded",{source:this,pagesCount:se})},()=>{}),this._onBeforeDraw=ie=>{const ye=this._pages[ie.pageNumber-1];ye&&u(this,m).push(ye)},this.eventBus._on("pagerender",this._onBeforeDraw),this._onAfterDraw=ie=>{ie.cssTransform||this._onePageRenderedCapability.settled||(this._onePageRenderedCapability.resolve({timestamp:ie.timestamp}),this.eventBus._off("pagerendered",this._onAfterDraw),this._onAfterDraw=null,u(this,K)&&(document.removeEventListener("visibilitychange",u(this,K)),ve(this,K,null)))},this.eventBus._on("pagerendered",this._onAfterDraw),Promise.all([M,j]).then(([ie,ye])=>{if(T!==this.pdfDocument)return;this._firstPageCapability.resolve(ie),this._optionalContentConfigPromise=O;const{annotationEditorMode:Me,annotationMode:ge,textLayerMode:Ae}=ee(this,W,Qi).call(this,ye);if(Me!==f.AnnotationEditorType.DISABLE){const Fe=Me;T.isPureXfa?console.warn("Warning: XFA-editing is not implemented."):E(Fe)?(ve(this,h,new f.AnnotationEditorUIManager(this.container,this.eventBus,T==null?void 0:T.annotationStorage)),Fe!==f.AnnotationEditorType.NONE&&u(this,h).updateMode(Fe)):console.error(`Invalid AnnotationEditor mode: ${Fe}`)}const Ce=ee(this,Ee,Zi).bind(this),xe=this._scrollMode===l.ScrollMode.PAGE?null:this.viewer,we=this.currentScale,Le=ie.getViewport({scale:we*f.PixelsPerInch.PDF_TO_CSS_UNITS});this.viewer.style.setProperty("--scale-factor",Le.scale);for(let Fe=1;Fe<=se;++Fe){const Ie=new S.PDFPageView({container:xe,eventBus:this.eventBus,id:Fe,scale:we,defaultViewport:Le.clone(),optionalContentConfigPromise:O,renderingQueue:this.renderingQueue,textLayerMode:Ae,annotationMode:ge,imageResourcesPath:this.imageResourcesPath,renderer:this.renderer,useOnlyCssZoom:this.useOnlyCssZoom,isOffscreenCanvasSupported:this.isOffscreenCanvasSupported,maxCanvasPixels:this.maxCanvasPixels,pageColors:this.pageColors,l10n:this.l10n,layerProperties:Ce});this._pages.push(Ie)}const ke=this._pages[0];ke&&(ke.setPdfPage(ie),this.linkService.cachePageRef(1,ie.ref)),this._scrollMode===l.ScrollMode.PAGE?ee(this,z,gt).call(this):this._spreadMode!==l.SpreadMode.NONE&&this._updateSpreadMode(),ee(this,v,Ji).call(this).then(async()=>{var Ie,Oe;if((Ie=this.findController)==null||Ie.setDocument(T),(Oe=this._scriptingManager)==null||Oe.setDocument(T),u(this,h)&&this.eventBus.dispatch("annotationeditormodechanged",{source:this,mode:u(this,P)}),T.loadingParams.disableAutoFetch||se>o.FORCE_LAZY_PAGE_INIT){this._pagesCapability.resolve();return}let Fe=se-1;if(Fe<=0){this._pagesCapability.resolve();return}for(let De=2;De<=se;++De){const Ve=T.getPage(De).then(Ne=>{const Be=this._pages[De-1];Be.pdfPage||Be.setPdfPage(Ne),this.linkService.cachePageRef(De,Ne.ref),--Fe===0&&this._pagesCapability.resolve()},Ne=>{console.error(`Unable to get page ${De} to initialize viewer`,Ne),--Fe===0&&this._pagesCapability.resolve()});De%o.PAUSE_EAGER_PAGE_INIT===0&&await Ve}}),this.eventBus.dispatch("pagesinit",{source:this}),T.getMetadata().then(({info:Fe})=>{T===this.pdfDocument&&Fe.Language&&(this.viewer.lang=Fe.Language)}),this.defaultRenderingQueue&&this.update()}).catch(ie=>{console.error("Unable to initialize viewer",ie),this._pagesCapability.reject(ie)})}setPageLabels(T){var se;if(this.pdfDocument){T?Array.isArray(T)&&this.pdfDocument.numPages===T.length?this._pageLabels=T:(this._pageLabels=null,console.error("setPageLabels: Invalid page labels.")):this._pageLabels=null;for(let M=0,O=this._pages.length;M<O;M++)this._pages[M].setPageLabel(((se=this._pageLabels)==null?void 0:se[M])??null)}}_resetView(){this._pages=[],this._currentPageNumber=1,this._currentScale=l.UNKNOWN_SCALE,this._currentScaleValue=null,this._pageLabels=null,ve(this,m,new b(c)),this._location=null,this._pagesRotation=0,this._optionalContentConfigPromise=null,this._firstPageCapability=(0,f.createPromiseCapability)(),this._onePageRenderedCapability=(0,f.createPromiseCapability)(),this._pagesCapability=(0,f.createPromiseCapability)(),this._scrollMode=l.ScrollMode.VERTICAL,this._previousScrollMode=l.ScrollMode.UNKNOWN,this._spreadMode=l.SpreadMode.NONE,ve(this,fe,{previousPageNumber:1,scrollDown:!0,pages:[]}),this._onBeforeDraw&&(this.eventBus._off("pagerender",this._onBeforeDraw),this._onBeforeDraw=null),this._onAfterDraw&&(this.eventBus._off("pagerendered",this._onAfterDraw),this._onAfterDraw=null),u(this,K)&&(document.removeEventListener("visibilitychange",u(this,K)),ve(this,K,null)),this.viewer.textContent="",this._updateScrollMode(),this.viewer.removeAttribute("lang"),this.viewer.classList.remove(n)}_scrollUpdate(){this.pagesCount!==0&&this.update()}pageLabelToPageNumber(T){if(!this._pageLabels)return null;const se=this._pageLabels.indexOf(T);return se<0?null:se+1}scrollPageIntoView({pageNumber:T,destArray:se=null,allowNegativeOffset:M=!1,ignoreDestinationZoom:O=!1}){if(!this.pdfDocument)return;const j=Number.isInteger(T)&&this._pages[T-1];if(!j){console.error(`scrollPageIntoView: "${T}" is not a valid pageNumber parameter.`);return}if(this.isInPresentationMode||!se){this._setCurrentPageNumber(T,!0);return}let be=0,Te=0,ie=0,ye=0,Me,ge;const Ae=j.rotation%180!==0,Ce=(Ae?j.height:j.width)/j.scale/f.PixelsPerInch.PDF_TO_CSS_UNITS,xe=(Ae?j.width:j.height)/j.scale/f.PixelsPerInch.PDF_TO_CSS_UNITS;let we=0;switch(se[1].name){case"XYZ":be=se[2],Te=se[3],we=se[4],be=be!==null?be:0,Te=Te!==null?Te:xe;break;case"Fit":case"FitB":we="page-fit";break;case"FitH":case"FitBH":Te=se[2],we="page-width",Te===null&&this._location?(be=this._location.left,Te=this._location.top):(typeof Te!="number"||Te<0)&&(Te=xe);break;case"FitV":case"FitBV":be=se[2],ie=Ce,ye=xe,we="page-height";break;case"FitR":be=se[2],Te=se[3],ie=se[4]-be,ye=se[5]-Te;let Ie=l.SCROLLBAR_PADDING,Oe=l.VERTICAL_PADDING;this.removePageBorders&&(Ie=Oe=0),Me=(this.container.clientWidth-Ie)/ie/f.PixelsPerInch.PDF_TO_CSS_UNITS,ge=(this.container.clientHeight-Oe)/ye/f.PixelsPerInch.PDF_TO_CSS_UNITS,we=Math.min(Math.abs(Me),Math.abs(ge));break;default:console.error(`scrollPageIntoView: "${se[1].name}" is not a valid destination type.`);return}if(O||(we&&we!==this._currentScale?this.currentScaleValue=we:this._currentScale===l.UNKNOWN_SCALE&&(this.currentScaleValue=l.DEFAULT_SCALE_VALUE)),we==="page-fit"&&!se[4]){ee(this,ne,wt).call(this,j);return}const Le=[j.viewport.convertToViewportPoint(be,Te),j.viewport.convertToViewportPoint(be+ie,Te+ye)];let ke=Math.min(Le[0][0],Le[1][0]),Fe=Math.min(Le[0][1],Le[1][1]);M||(ke=Math.max(ke,0),Fe=Math.max(Fe,0)),ee(this,ne,wt).call(this,j,{left:ke,top:Fe})}_updateLocation(T){const se=this._currentScale,M=this._currentScaleValue,O=parseFloat(M)===se?Math.round(se*1e4)/100:M,j=T.id,be=this._pages[j-1],Te=this.container,ie=be.getPagePoint(Te.scrollLeft-T.x,Te.scrollTop-T.y),ye=Math.round(ie[0]),Me=Math.round(ie[1]);let ge=`#page=${j}`;this.isInPresentationMode||(ge+=`&zoom=${O},${ye},${Me}`),this._location={pageNumber:j,scale:O,top:Me,left:ye,rotation:this._pagesRotation,pdfOpenParams:ge}}update(){const T=this._getVisiblePages(),se=T.views,M=se.length;if(M===0)return;const O=Math.max(c,2*M+1);u(this,m).resize(O,T.ids),this.renderingQueue.renderHighestPriority(T);const j=this._spreadMode===l.SpreadMode.NONE&&(this._scrollMode===l.ScrollMode.PAGE||this._scrollMode===l.ScrollMode.VERTICAL),be=this._currentPageNumber;let Te=!1;for(const ie of se){if(ie.percent<100)break;if(ie.id===be&&j){Te=!0;break}}this._setCurrentPageNumber(Te?be:se[0].id),this._updateLocation(T.first),this.eventBus.dispatch("updateviewarea",{source:this,location:this._location})}containsElement(T){return this.container.contains(T)}focus(){this.container.focus()}get _isContainerRtl(){return getComputedStyle(this.container).direction==="rtl"}get isInPresentationMode(){return this.presentationModeState===l.PresentationModeState.FULLSCREEN}get isChangingPresentationMode(){return this.presentationModeState===l.PresentationModeState.CHANGING}get isHorizontalScrollbarEnabled(){return this.isInPresentationMode?!1:this.container.scrollWidth>this.container.clientWidth}get isVerticalScrollbarEnabled(){return this.isInPresentationMode?!1:this.container.scrollHeight>this.container.clientHeight}_getVisiblePages(){const T=this._scrollMode===l.ScrollMode.PAGE?u(this,fe).pages:this._pages,se=this._scrollMode===l.ScrollMode.HORIZONTAL,M=se&&this._isContainerRtl;return(0,l.getVisibleElements)({scrollEl:this.container,views:T,sortByVisibility:!0,horizontal:se,rtl:M})}isPageVisible(T){return this.pdfDocument?Number.isInteger(T)&&T>0&&T<=this.pagesCount?this._getVisiblePages().ids.has(T):(console.error(`isPageVisible: "${T}" is not a valid page.`),!1):!1}isPageCached(T){if(!this.pdfDocument)return!1;if(!(Number.isInteger(T)&&T>0&&T<=this.pagesCount))return console.error(`isPageCached: "${T}" is not a valid page.`),!1;const se=this._pages[T-1];return u(this,m).has(se)}cleanup(){for(const T of this._pages)T.renderingState!==l.RenderingStates.FINISHED&&T.reset()}_cancelRendering(){for(const T of this._pages)T.cancelRendering()}forceRendering(T){const se=T||this._getVisiblePages(),M=ee(this,Q,sn).call(this,se),O=this._spreadMode!==l.SpreadMode.NONE&&this._scrollMode!==l.ScrollMode.HORIZONTAL,j=this.renderingQueue.getHighestPriority(se,this._pages,M,O);return j?(ee(this,he,nn).call(this,j).then(()=>{this.renderingQueue.renderView(j)}),!0):!1}get hasEqualPageSizes(){const T=this._pages[0];for(let se=1,M=this._pages.length;se<M;++se){const O=this._pages[se];if(O.width!==T.width||O.height!==T.height)return!1}return!0}getPagesOverview(){return this._pages.map(T=>{const se=T.pdfPage.getViewport({scale:1});return!this.enablePrintAutoRotate||(0,l.isPortraitOrientation)(se)?{width:se.width,height:se.height,rotation:se.rotation}:{width:se.height,height:se.width,rotation:(se.rotation-90)%360}})}get optionalContentConfigPromise(){return this.pdfDocument?this._optionalContentConfigPromise?this._optionalContentConfigPromise:(console.error("optionalContentConfigPromise: Not initialized yet."),this.pdfDocument.getOptionalContentConfig()):Promise.resolve(null)}set optionalContentConfigPromise(T){if(!(T instanceof Promise))throw new Error(`Invalid optionalContentConfigPromise: ${T}`);this.pdfDocument&&this._optionalContentConfigPromise&&(this._optionalContentConfigPromise=T,this.refresh(!1,{optionalContentConfigPromise:T}),this.eventBus.dispatch("optionalcontentconfigchanged",{source:this,promise:T}))}get scrollMode(){return this._scrollMode}set scrollMode(T){if(this._scrollMode!==T){if(!(0,l.isValidScrollMode)(T))throw new Error(`Invalid scroll mode: ${T}`);this.pagesCount>o.FORCE_SCROLL_MODE_PAGE||(this._previousScrollMode=this._scrollMode,this._scrollMode=T,this.eventBus.dispatch("scrollmodechanged",{source:this,mode:T}),this._updateScrollMode(this._currentPageNumber))}}_updateScrollMode(T=null){const se=this._scrollMode,M=this.viewer;M.classList.toggle("scrollHorizontal",se===l.ScrollMode.HORIZONTAL),M.classList.toggle("scrollWrapped",se===l.ScrollMode.WRAPPED),!(!this.pdfDocument||!T)&&(se===l.ScrollMode.PAGE?ee(this,z,gt).call(this):this._previousScrollMode===l.ScrollMode.PAGE&&this._updateSpreadMode(),this._currentScaleValue&&isNaN(this._currentScaleValue)&&ee(this,y,Ze).call(this,this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(T,!0),this.update())}get spreadMode(){return this._spreadMode}set spreadMode(T){if(this._spreadMode!==T){if(!(0,l.isValidSpreadMode)(T))throw new Error(`Invalid spread mode: ${T}`);this._spreadMode=T,this.eventBus.dispatch("spreadmodechanged",{source:this,mode:T}),this._updateSpreadMode(this._currentPageNumber)}}_updateSpreadMode(T=null){if(!this.pdfDocument)return;const se=this.viewer,M=this._pages;if(this._scrollMode===l.ScrollMode.PAGE)ee(this,z,gt).call(this);else if(se.textContent="",this._spreadMode===l.SpreadMode.NONE)for(const O of this._pages)se.append(O.div);else{const O=this._spreadMode-1;let j=null;for(let be=0,Te=M.length;be<Te;++be)j===null?(j=document.createElement("div"),j.className="spread",se.append(j)):be%2===O&&(j=j.cloneNode(!1),se.append(j)),j.append(M[be].div)}T&&(this._currentScaleValue&&isNaN(this._currentScaleValue)&&ee(this,y,Ze).call(this,this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(T,!0),this.update())}_getPageAdvance(T,se=!1){switch(this._scrollMode){case l.ScrollMode.WRAPPED:{const{views:M}=this._getVisiblePages(),O=new Map;for(const{id:j,y:be,percent:Te,widthPercent:ie}of M){if(Te===0||ie<100)continue;let ye=O.get(be);ye||O.set(be,ye||(ye=[])),ye.push(j)}for(const j of O.values()){const be=j.indexOf(T);if(be===-1)continue;const Te=j.length;if(Te===1)break;if(se)for(let ie=be-1,ye=0;ie>=ye;ie--){const Me=j[ie],ge=j[ie+1]-1;if(Me<ge)return T-ge}else for(let ie=be+1,ye=Te;ie<ye;ie++){const Me=j[ie],ge=j[ie-1]+1;if(Me>ge)return ge-T}if(se){const ie=j[0];if(ie<T)return T-ie+1}else{const ie=j[Te-1];if(ie>T)return ie-T+1}break}break}case l.ScrollMode.HORIZONTAL:break;case l.ScrollMode.PAGE:case l.ScrollMode.VERTICAL:{if(this._spreadMode===l.SpreadMode.NONE)break;const M=this._spreadMode-1;if(se&&T%2!==M)break;if(!se&&T%2===M)break;const{views:O}=this._getVisiblePages(),j=se?T-1:T+1;for(const{id:be,percent:Te,widthPercent:ie}of O)if(be===j){if(Te>0&&ie===100)return 2;break}break}}return 1}nextPage(){const T=this._currentPageNumber,se=this.pagesCount;if(T>=se)return!1;const M=this._getPageAdvance(T,!1)||1;return this.currentPageNumber=Math.min(T+M,se),!0}previousPage(){const T=this._currentPageNumber;if(T<=1)return!1;const se=this._getPageAdvance(T,!0)||1;return this.currentPageNumber=Math.max(T-se,1),!0}increaseScale({drawingDelay:T,scaleFactor:se,steps:M}={}){if(!this.pdfDocument)return;let O=this._currentScale;if(se>1)O=Math.round(O*se*100)/100;else{M??(M=1);do O=Math.ceil((O*l.DEFAULT_SCALE_DELTA).toFixed(2)*10)/10;while(--M>0&&O<l.MAX_SCALE)}ee(this,y,Ze).call(this,Math.min(l.MAX_SCALE,O),{noScroll:!1,drawingDelay:T})}decreaseScale({drawingDelay:T,scaleFactor:se,steps:M}={}){if(!this.pdfDocument)return;let O=this._currentScale;if(se>0&&se<1)O=Math.round(O*se*100)/100;else{M??(M=1);do O=Math.floor((O/l.DEFAULT_SCALE_DELTA).toFixed(2)*10)/10;while(--M>0&&O>l.MIN_SCALE)}ee(this,y,Ze).call(this,Math.max(l.MIN_SCALE,O),{noScroll:!1,drawingDelay:T})}get containerTopLeft(){return u(this,J)||ve(this,J,[this.container.offsetTop,this.container.offsetLeft])}get annotationEditorMode(){return u(this,h)?u(this,P):f.AnnotationEditorType.DISABLE}set annotationEditorMode(T){if(!u(this,h))throw new Error("The AnnotationEditor is not enabled.");if(u(this,P)!==T){if(!E(T))throw new Error(`Invalid AnnotationEditor mode: ${T}`);this.pdfDocument&&(ve(this,P,T),this.eventBus.dispatch("annotationeditormodechanged",{source:this,mode:T}),u(this,h).updateMode(T))}}set annotationEditorParams({type:T,value:se}){if(!u(this,h))throw new Error("The AnnotationEditor is not enabled.");u(this,h).updateParams(T,se)}refresh(T=!1,se=Object.create(null)){if(this.pdfDocument){for(const M of this._pages)M.update(se);u(this,me)!==null&&(clearTimeout(u(this,me)),ve(this,me,null)),T||this.update()}}}d(p,"PDFViewer"),m=new WeakMap,P=new WeakMap,h=new WeakMap,F=new WeakMap,J=new WeakMap,le=new WeakMap,q=new WeakMap,re=new WeakMap,fe=new WeakMap,K=new WeakMap,me=new WeakMap,Ee=new WeakSet,Zi=d(function(){const T=this;return{get annotationEditorUIManager(){return u(T,h)},get annotationStorage(){var se;return(se=T.pdfDocument)==null?void 0:se.annotationStorage},get downloadManager(){return T.downloadManager},get enableScripting(){return!!T._scriptingManager},get fieldObjectsPromise(){var se;return(se=T.pdfDocument)==null?void 0:se.getFieldObjects()},get findController(){return T.findController},get hasJSActionsPromise(){var se;return(se=T.pdfDocument)==null?void 0:se.hasJSActions()},get linkService(){return T.linkService}}},"#layerProperties"),W=new WeakSet,Qi=d(function(T){const se={annotationEditorMode:u(this,P),annotationMode:u(this,F),textLayerMode:this.textLayerMode};return T&&(T.includes(f.PermissionFlag.COPY)||this.viewer.classList.add(n),T.includes(f.PermissionFlag.MODIFY_CONTENTS)||(se.annotationEditorMode=f.AnnotationEditorType.DISABLE),!T.includes(f.PermissionFlag.MODIFY_ANNOTATIONS)&&!T.includes(f.PermissionFlag.FILL_INTERACTIVE_FORMS)&&u(this,F)===f.AnnotationMode.ENABLE_FORMS&&(se.annotationMode=f.AnnotationMode.ENABLE)),se},"#initializePermissions"),v=new WeakSet,Ji=d(function(){if(document.visibilityState==="hidden"||!this.container.offsetParent||this._getVisiblePages().views.length===0)return Promise.resolve();const T=new Promise(se=>{ve(this,K,()=>{document.visibilityState==="hidden"&&(se(),document.removeEventListener("visibilitychange",u(this,K)),ve(this,K,null))}),document.addEventListener("visibilitychange",u(this,K))});return Promise.race([this._onePageRenderedCapability.promise,T])},"#onePageRenderedOrForceFetch"),z=new WeakSet,gt=d(function(){if(this._scrollMode!==l.ScrollMode.PAGE)throw new Error("#ensurePageViewVisible: Invalid scrollMode value.");const T=this._currentPageNumber,se=u(this,fe),M=this.viewer;if(M.textContent="",se.pages.length=0,this._spreadMode===l.SpreadMode.NONE&&!this.isInPresentationMode){const O=this._pages[T-1];M.append(O.div),se.pages.push(O)}else{const O=new Set,j=this._spreadMode-1;j===-1?O.add(T-1):T%2!==j?(O.add(T-1),O.add(T)):(O.add(T-2),O.add(T-1));const be=document.createElement("div");if(be.className="spread",this.isInPresentationMode){const Te=document.createElement("div");Te.className="dummyPage",be.append(Te)}for(const Te of O){const ie=this._pages[Te];ie&&(be.append(ie.div),se.pages.push(ie))}M.append(be)}se.scrollDown=T>=se.previousPageNumber,se.previousPageNumber=T},"#ensurePageViewVisible"),ne=new WeakSet,wt=d(function(T,se=null){const{div:M,id:O}=T;if(this._currentPageNumber!==O&&this._setCurrentPageNumber(O),this._scrollMode===l.ScrollMode.PAGE&&(ee(this,z,gt).call(this),this.update()),!se&&!this.isInPresentationMode){const j=M.offsetLeft+M.clientLeft,be=j+M.clientWidth,{scrollLeft:Te,clientWidth:ie}=this.container;(this._scrollMode===l.ScrollMode.HORIZONTAL||j<Te||be>Te+ie)&&(se={left:0,top:0})}(0,l.scrollIntoView)(M,se),!this._currentScaleValue&&this._location&&(this._location=null)},"#scrollIntoView"),Y=new WeakSet,en=d(function(T){return T===this._currentScale||Math.abs(T-this._currentScale)<1e-15},"#isSameScale"),V=new WeakSet,hi=d(function(T,se,{noScroll:M=!1,preset:O=!1,drawingDelay:j=-1}){if(this._currentScaleValue=se.toString(),ee(this,Y,en).call(this,T)){O&&this.eventBus.dispatch("scalechanging",{source:this,scale:T,presetValue:se});return}this.viewer.style.setProperty("--scale-factor",T*f.PixelsPerInch.PDF_TO_CSS_UNITS);const be=j>=0&&j<1e3;if(this.refresh(!0,{scale:T,drawingDelay:be?j:-1}),be&&ve(this,me,setTimeout(()=>{ve(this,me,null),this.refresh()},j)),this._currentScale=T,!M){let Te=this._currentPageNumber,ie;this._location&&!(this.isInPresentationMode||this.isChangingPresentationMode)&&(Te=this._location.pageNumber,ie=[null,{name:"XYZ"},this._location.left,this._location.top,null]),this.scrollPageIntoView({pageNumber:Te,destArray:ie,allowNegativeOffset:!0})}this.eventBus.dispatch("scalechanging",{source:this,scale:T,presetValue:O?se:void 0}),this.defaultRenderingQueue&&this.update()},"#setScaleUpdatePages"),a=new WeakSet,tn=d(function(){return this._spreadMode!==l.SpreadMode.NONE&&this._scrollMode!==l.ScrollMode.HORIZONTAL?2:1},"#pageWidthScaleFactor"),y=new WeakSet,Ze=d(function(T,se){let M=parseFloat(T);if(M>0)se.preset=!1,ee(this,V,hi).call(this,M,T,se);else{const O=this._pages[this._currentPageNumber-1];if(!O)return;let j=l.SCROLLBAR_PADDING,be=l.VERTICAL_PADDING;this.isInPresentationMode?(j=be=4,this._spreadMode!==l.SpreadMode.NONE&&(j*=2)):this.removePageBorders?j=be=0:this._scrollMode===l.ScrollMode.HORIZONTAL&&([j,be]=[be,j]);const Te=(this.container.clientWidth-j)/O.width*O.scale/u(this,a,tn),ie=(this.container.clientHeight-be)/O.height*O.scale;switch(T){case"page-actual":M=1;break;case"page-width":M=Te;break;case"page-height":M=ie;break;case"page-fit":M=Math.min(Te,ie);break;case"auto":const ye=(0,l.isPortraitOrientation)(O)?Te:Math.min(ie,Te);M=Math.min(l.MAX_AUTO_SCALE,ye);break;default:console.error(`#setScale: "${T}" is an unknown zoom value.`);return}se.preset=!0,ee(this,V,hi).call(this,M,T,se)}},"#setScale"),U=new WeakSet,di=d(function(){const T=this._pages[this._currentPageNumber-1];this.isInPresentationMode&&ee(this,y,Ze).call(this,this._currentScaleValue,{noScroll:!0}),ee(this,ne,wt).call(this,T)},"#resetCurrentPageView"),he=new WeakSet,nn=d(async function(T){var se,M;if(T.pdfPage)return T.pdfPage;try{const O=await this.pdfDocument.getPage(T.id);return T.pdfPage||T.setPdfPage(O),(M=(se=this.linkService)._cachedPageNumber)!=null&&M.call(se,O.ref)||this.linkService.cachePageRef(T.id,O.ref),O}catch(O){return console.error("Unable to get page for page view",O),null}},"#ensurePdfPageLoaded"),Q=new WeakSet,sn=d(function(T){var se,M;if(((se=T.first)==null?void 0:se.id)===1)return!0;if(((M=T.last)==null?void 0:M.id)===this.pagesCount)return!1;switch(this._scrollMode){case l.ScrollMode.PAGE:return u(this,fe).scrollDown;case l.ScrollMode.HORIZONTAL:return this.scroll.right}return this.scroll.down},"#getScrollAhead"),ce=new WeakSet,ui=d(function(T=this.container.clientHeight){T!==u(this,q)&&(ve(this,q,T),l.docStyle.setProperty("--viewer-container-height",`${T}px`))},"#updateContainerHeightCss"),Se=new WeakSet,rn=d(function(T){for(const se of T)if(se.target===this.container){ee(this,ce,ui).call(this,Math.floor(se.borderBoxSize[0].blockSize)),ve(this,J,null);break}},"#resizeObserverCallback"),L.PDFViewer=p},(G,L,I)=>{Object.defineProperty(L,"__esModule",{value:!0}),L.PDFRenderingQueue=void 0;var f=I(4),l=I(2);const w=3e4;class S{constructor(){this.pdfViewer=null,this.pdfThumbnailViewer=null,this.onIdle=null,this.highestPriorityPage=null,this.idleTimeout=null,this.printing=!1,this.isThumbnailViewEnabled=!1}setViewer(i){this.pdfViewer=i}setThumbnailViewer(i){this.pdfThumbnailViewer=i}isHighestPriority(i){return this.highestPriorityPage===i.renderingId}hasViewer(){return!!this.pdfViewer}renderHighestPriority(i){var c;this.idleTimeout&&(clearTimeout(this.idleTimeout),this.idleTimeout=null),!this.pdfViewer.forceRendering(i)&&(this.isThumbnailViewEnabled&&((c=this.pdfThumbnailViewer)!=null&&c.forceRendering())||this.printing||this.onIdle&&(this.idleTimeout=setTimeout(this.onIdle.bind(this),w)))}getHighestPriority(i,c,n,o=!1){const E=i.views,b=E.length;if(b===0)return null;for(let s=0;s<b;s++){const m=E[s].view;if(!this.isViewFinished(m))return m}const p=i.first.id,e=i.last.id;if(e-p+1>b){const s=i.ids;for(let m=1,P=e-p;m<P;m++){const h=n?p+m:e-m;if(s.has(h))continue;const F=c[h-1];if(!this.isViewFinished(F))return F}}let t=n?e:p-2,r=c[t];return r&&!this.isViewFinished(r)||o&&(t+=n?1:-1,r=c[t],r&&!this.isViewFinished(r))?r:null}isViewFinished(i){return i.renderingState===l.RenderingStates.FINISHED}renderView(i){switch(i.renderingState){case l.RenderingStates.FINISHED:return!1;case l.RenderingStates.PAUSED:this.highestPriorityPage=i.renderingId,i.resume();break;case l.RenderingStates.RUNNING:this.highestPriorityPage=i.renderingId;break;case l.RenderingStates.INITIAL:this.highestPriorityPage=i.renderingId,i.draw().finally(()=>{this.renderHighestPriority()}).catch(c=>{c instanceof f.RenderingCancelledException||console.error(`renderView: "${c}"`)});break}return!0}}d(S,"PDFRenderingQueue"),L.PDFRenderingQueue=S}],x={};function B(G){var L=x[G];if(L!==void 0)return L.exports;var I=x[G]={exports:{}};return de[G](I,I.exports,B),I.exports}d(B,"__w_pdfjs_require__");var ue={};return(()=>{var G=ue;Object.defineProperty(G,"__esModule",{value:!0}),Object.defineProperty(G,"AnnotationLayerBuilder",{enumerable:!0,get:function(){return f.AnnotationLayerBuilder}}),G.DefaultXfaLayerFactory=G.DefaultTextLayerFactory=G.DefaultStructTreeLayerFactory=G.DefaultAnnotationLayerFactory=void 0,Object.defineProperty(G,"DownloadManager",{enumerable:!0,get:function(){return l.DownloadManager}}),Object.defineProperty(G,"EventBus",{enumerable:!0,get:function(){return w.EventBus}}),Object.defineProperty(G,"GenericL10n",{enumerable:!0,get:function(){return S.GenericL10n}}),Object.defineProperty(G,"LinkTarget",{enumerable:!0,get:function(){return L.LinkTarget}}),Object.defineProperty(G,"NullL10n",{enumerable:!0,get:function(){return g.NullL10n}}),Object.defineProperty(G,"PDFFindController",{enumerable:!0,get:function(){return i.PDFFindController}}),Object.defineProperty(G,"PDFHistory",{enumerable:!0,get:function(){return c.PDFHistory}}),Object.defineProperty(G,"PDFLinkService",{enumerable:!0,get:function(){return L.PDFLinkService}}),Object.defineProperty(G,"PDFPageView",{enumerable:!0,get:function(){return n.PDFPageView}}),Object.defineProperty(G,"PDFScriptingManager",{enumerable:!0,get:function(){return o.PDFScriptingManager}}),Object.defineProperty(G,"PDFSinglePageViewer",{enumerable:!0,get:function(){return E.PDFSinglePageViewer}}),Object.defineProperty(G,"PDFViewer",{enumerable:!0,get:function(){return b.PDFViewer}}),Object.defineProperty(G,"ProgressBar",{enumerable:!0,get:function(){return I.ProgressBar}}),Object.defineProperty(G,"RenderingStates",{enumerable:!0,get:function(){return I.RenderingStates}}),Object.defineProperty(G,"ScrollMode",{enumerable:!0,get:function(){return I.ScrollMode}}),Object.defineProperty(G,"SimpleLinkService",{enumerable:!0,get:function(){return L.SimpleLinkService}}),Object.defineProperty(G,"SpreadMode",{enumerable:!0,get:function(){return I.SpreadMode}}),Object.defineProperty(G,"StructTreeLayerBuilder",{enumerable:!0,get:function(){return p.StructTreeLayerBuilder}}),Object.defineProperty(G,"TextLayerBuilder",{enumerable:!0,get:function(){return e.TextLayerBuilder}}),Object.defineProperty(G,"XfaLayerBuilder",{enumerable:!0,get:function(){return t.XfaLayerBuilder}}),Object.defineProperty(G,"parseQueryString",{enumerable:!0,get:function(){return I.parseQueryString}});var L=B(1),I=B(2),f=B(3),l=B(6),w=B(7),S=B(8),g=B(5),i=B(10),c=B(12),n=B(13),o=B(21),E=B(23),b=B(24),p=B(16),e=B(19),t=B(20);class r{constructor(){throw new Error("The `DefaultAnnotationLayerFactory` has been removed, please use the `annotationMode` option when initializing the `PDFPageView`-instance to control AnnotationLayer rendering.")}}d(r,"DefaultAnnotationLayerFactory"),G.DefaultAnnotationLayerFactory=r;class s{constructor(){throw new Error("The `DefaultStructTreeLayerFactory` has been removed, this functionality is automatically enabled when the TextLayer is used.")}}d(s,"DefaultStructTreeLayerFactory"),G.DefaultStructTreeLayerFactory=s;class m{constructor(){throw new Error("The `DefaultTextLayerFactory` has been removed, please use the `textLayerMode` option when initializing the `PDFPageView`-instance to control TextLayer rendering.")}}d(m,"DefaultTextLayerFactory"),G.DefaultTextLayerFactory=m;class P{constructor(){throw new Error("The `DefaultXfaLayerFactory` has been removed, please use the `enableXfa` option when calling the `getDocument`-function to control XfaLayer rendering.")}}d(P,"DefaultXfaLayerFactory"),G.DefaultXfaLayerFactory=P})(),ue})())})(pdf_viewer$1);const pdf_viewer="";pdfExports.GlobalWorkerOptions.workerSrc="/static/pdfjs/pdf.worker.min.js";const _sfc_main=defineComponent({name:"DocumentEditor",components:{ToolbarPagination:_sfc_main$1,ToolbarRotation:_sfc_main$2,ToolbarZoom:_sfc_main$3,ToolbarAnnotation:_sfc_main$4},props:{value:{type:String,required:!0},baseUrl:{type:String,required:!0},pagination:{type:Boolean,default:!0},zoom:{type:Boolean,default:!0},comment:{type:Boolean,default:!0},highlight:{type:Boolean,default:!0},rotation:{type:Boolean,default:!0}},data(){return{token:this.value,rotations:{},highlightingColor:"",commentingColor:"",loading:!0,error:"",currentPage:1,currentZoom:"",hasAnnotations:!1,savingInProgress:!1,interval:null,pages:1,pdfDocument:void 0,viewer:void 0}},computed:{hasBeenRotated(){return this.rotations&&Object.keys(this.rotations).length!==0},needsToBeSaved(){return this.hasBeenRotated||this.hasAnnotations}},mounted(){this.pdfDocument=void 0,this.getFile();const ae=["changeCurrentPage","rotate","zoomIn","zoomOut","setScale","setHighlight","setCommenting","save"];for(const C of ae)this.$el.addEventListener(C,de=>{this[C](de.detail)})},unmounted(){this.stopWatchingAnnotations()},methods:{getFile:async function(){if(this.token==="FileInfectedException")this.error=this.$t("view_entry.file_infected");else try{const ae=await doRequest(`${this.baseUrl}metadata/${this.token}`),C=await pdfExports.getDocument(ae.url).promise,de=new pdf_viewerExports.PDFViewer({container:this.$refs.viewerContainer,eventBus:new pdf_viewerExports.EventBus});de.setDocument(C),de.eventBus.on("pagechanging",B=>{this.currentPage=B.pageNumber;const ue=new CustomEvent("pageChange",{detail:{pageNumber:B.pageNumber}});this.$el.dispatchEvent(ue)}),de.eventBus.on("pagesinit",()=>{this.currentZoom=de.currentScaleValue="auto"}),this.pages=C.numPages;const x=new CustomEvent("numPages",{detail:{numPages:C.numPages}});this.$el.dispatchEvent(x),this.pdfDocument=markRaw(C),this.viewer=markRaw(de)}catch(ae){this.error=ae.message}this.loading=!1},rotate(ae){var C;((C=this.viewer)==null?void 0:C.getPageView(this.currentPage-1)).update({rotation:ae}),ae!==0?this.rotations[this.currentPage-1]=ae:delete this.rotations[this.currentPage-1]},changeCurrentPage(ae){this.viewer.currentPageNumber=ae},zoomIn(){const ae=this.viewer;ae.increaseScale({scaleFactor:1.1}),this.currentZoom=ae.currentScale.toString()},zoomOut(){const ae=this.viewer;ae.decreaseScale({scaleFactor:1.1}),this.currentZoom=ae.currentScale.toString()},setScale(ae){this.viewer.currentScaleValue=ae,this.currentZoom=ae},startWatchingAnnotations:function(){this.interval||(this.interval=window.setInterval(()=>this.updateNeedsToBeSaved(),500))},stopWatchingAnnotations:function(){this.interval&&window.clearInterval(this.interval),this.interval=null},setHighlight(ae){const C=this.viewer;this.commentingColor="",this.highlightingColor=ae,ae?(this.startWatchingAnnotations(),C.annotationEditorMode=pdfExports.AnnotationEditorType.INK,C.annotationEditorParams={type:pdfExports.AnnotationEditorParamsType.INK_THICKNESS,value:10},C.annotationEditorParams={type:pdfExports.AnnotationEditorParamsType.INK_OPACITY,value:50},C.annotationEditorParams={type:pdfExports.AnnotationEditorParamsType.INK_COLOR,value:ae}):(this.stopWatchingAnnotations(),C.annotationEditorMode=pdfExports.AnnotationEditorType.NONE)},setCommenting(ae){const C=this.viewer;this.highlightingColor="",this.commentingColor=ae,ae?(this.startWatchingAnnotations(),C.annotationEditorMode=pdfExports.AnnotationEditorType.FREETEXT,C.annotationEditorParams={type:pdfExports.AnnotationEditorParamsType.FREETEXT_SIZE,value:10},C.annotationEditorParams={type:pdfExports.AnnotationEditorParamsType.FREETEXT_COLOR,value:ae}):(this.stopWatchingAnnotations(),C.annotationEditorMode=pdfExports.AnnotationEditorType.NONE)},updateNeedsToBeSaved(){this.hasAnnotations=!!this.pdfDocument&&this.pdfDocument.annotationStorage.size>0},async save(){if(!this.needsToBeSaved)return!1;this.savingInProgress=!0,this.setCommenting("");const ae=await this.pdfDocument.saveDocument(),C=new Blob([ae],{type:"application/pdf"}),de=new FormData;de.append("file",C),de.append("rotations",JSON.stringify(toRaw(this.rotations)));try{const x=await doRequest(`${this.baseUrl}save-editor/${this.token}`,{method:"POST",headers:void 0,body:de});this.rotations={},this.hasAnnotations=!1,this.token=x.token,this.getFile()}catch(x){this.error=x.message}this.savingInProgress=!1}}}),DocumentEditor_vue_vue_type_style_index_0_lang="",_hoisted_1={class:"editor-container"},_hoisted_2={class:"wrapper"},_hoisted_3={ref:"viewerContainer",class:"viewerContainer",tabindex:"0"},_hoisted_4=createBaseVNode("div",{class:"pdfViewer"},null,-1),_hoisted_5=[_hoisted_4],_hoisted_6={class:"btn-toolbar",role:"toolbar"},_hoisted_7={key:0,class:"text-danger"};function _sfc_render(ae,C,de,x,B,ue){const G=resolveComponent("ToolbarPagination"),L=resolveComponent("ToolbarRotation"),I=resolveComponent("ToolbarZoom"),f=resolveComponent("ToolbarAnnotation");return openBlock(),createElementBlock("div",_hoisted_1,[createBaseVNode("div",_hoisted_2,[createBaseVNode("div",_hoisted_3,_hoisted_5,512)]),createBaseVNode("div",_hoisted_6,[ae.pages&&ae.pagination?(openBlock(),createBlock(G,{key:0,"current-page":ae.currentPage,pages:ae.pages,onOnChangeCurrentPage:ae.changeCurrentPage},null,8,["current-page","pages","onOnChangeCurrentPage"])):createCommentVNode("",!0),ae.rotation?(openBlock(),createBlock(L,{key:1,"current-rotation":ae.rotations[ae.currentPage-1]||0,onOnRotate:ae.rotate},null,8,["current-rotation","onOnRotate"])):createCommentVNode("",!0),ae.zoom&&ae.currentZoom?(openBlock(),createBlock(I,{key:2,"current-zoom":ae.currentZoom,onOnZoomIn:ae.zoomIn,onOnZoomOut:ae.zoomOut,onOnSetScale:ae.setScale},null,8,["current-zoom","onOnZoomIn","onOnZoomOut","onOnSetScale"])):createCommentVNode("",!0),ae.highlight?(openBlock(),createBlock(f,{key:3,icon:"fa-highlighter","is-activated":ae.highlightingColor!="",color:ae.highlightingColor,"class-prefix":"bg",colors:{warning:"#ffff00",danger:"#ff0000",info:"#0000ff",success:"#00ff00"},onOnChange:ae.setHighlight},null,8,["is-activated","color","onOnChange"])):createCommentVNode("",!0),ae.comment?(openBlock(),createBlock(f,{key:4,icon:"fa-message","is-activated":ae.commentingColor!="",color:ae.commentingColor,"class-prefix":"text",colors:{danger:"#a94442",warning:"#ffff00",info:"#31708f",success:"#3c763d",muted:"#ffffff"},onOnChange:ae.setCommenting},null,8,["is-activated","color","onOnChange"])):createCommentVNode("",!0),createBaseVNode("button",{type:"button",class:normalizeClass(["btn",ae.needsToBeSaved?"btn-primary":"btn-default disabled"]),onClick:C[0]||(C[0]=(...l)=>ae.save&&ae.save(...l))},[createBaseVNode("span",{class:normalizeClass(["fas",ae.savingInProgress?"fa-spinner fa-spin-pulse":`fa-save ${ae.needsToBeSaved&&"fa-beat-fade"}`])},null,2)],2)]),ae.error?(openBlock(),createElementBlock("p",_hoisted_7,toDisplayString(ae.error),1)):createCommentVNode("",!0)])}d(_sfc_render,"_sfc_render");const DocumentEditor=_export_sfc(_sfc_main,[["render",_sfc_render]]);_sfc_main.__docgenInfo={displayName:"DocumentEditor",description:`TODO: Existing annotations cannot be edited, so watch for https://github.com/mozilla/pdf.js/issues/15403
Overall PDF Editing is tracked in https://github.com/mozilla/pdf.js/projects/9?fullscreen=true`,tags:{},exportName:"default",props:[{name:"value",type:{name:"string"},required:!0},{name:"baseUrl",type:{name:"string"},required:!0},{name:"pagination",type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"zoom",type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"comment",type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"highlight",type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"rotation",type:{name:"boolean"},defaultValue:{func:!1,value:"true"}}],sourceFiles:["/home/runner/work/osis-document/osis-document/frontend/DocumentEditor.vue"]};const UploadingServerTemplate=d(({metadata:ae,changed:C,...de})=>{const x=ae||{mimetype:"application/pdf",size:82381,url:"./multiple-pages.pdf",name:"test document.pdf"};return client.config.fallbackToNetwork=!0,client.restore().get("/metadata/12e68184-5cba-4b27-9988-609a6cc3be63",x).post("/change-metadata/12e68184-5cba-4b27-9988-609a6cc3be63",C||200).post("/save-editor/12e68184-5cba-4b27-9988-609a6cc3be63",{token:"12e68184-5cba-4b27-9988-609a6cc3be63"},{delay:1e3}),{components:{DocumentEditor},setup(){return{args:de}},template:'<DocumentEditor v-bind="args" base-url="/" value="12e68184-5cba-4b27-9988-609a6cc3be63" />'}},"UploadingServerTemplate"),Basic=UploadingServerTemplate.bind({}),DocumentEditor_stories={parameters:{storySource:{source:`/*
 *
 *   OSIS stands for Open Student Information System. It's an application
 *   designed to manage the core business of higher education institutions,
 *   such as universities, faculties, institutes and professional schools.
 *   The core business involves the administration of students, teachers,
 *   courses, programs and so on.
 *
 *   Copyright (C) 2015-2021 Université catholique de Louvain (http://www.uclouvain.be)
 *
 *   This program is free software: you can redistribute it and/or modify
 *   it under the terms of the GNU General Public License as published by
 *   the Free Software Foundation, either version 3 of the License, or
 *   (at your option) any later version.
 *
 *   This program is distributed in the hope that it will be useful,
 *   but WITHOUT ANY WARRANTY; without even the implied warranty of
 *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *   GNU General Public License for more details.
 *
 *   A copy of this license - GNU General Public License - is available
 *   at the root of the source code of this program.  If not,
 *   see http://www.gnu.org/licenses/.
 *
 */

import DocumentEditor from './DocumentEditor.vue';
import fetchMock from 'fetch-mock';
import type {MockResponse} from 'fetch-mock';
import type {Meta, StoryFn} from "@storybook/vue3";
import type {FileUpload} from "./interfaces";

const UploadingServerTemplate: StoryFn<typeof DocumentEditor & {
  metadata: FileUpload | MockResponse,
  changed: MockResponse
}> = (
    {metadata, changed, ...args},
) => {
  const documentMetadata = metadata || {
    mimetype: 'application/pdf',
    size: 82381,
    url: './multiple-pages.pdf',
    name: 'test document.pdf',
  };
  fetchMock.config.fallbackToNetwork = true;  // to effectively download PDF
  fetchMock
      .restore()
      .get('/metadata/12e68184-5cba-4b27-9988-609a6cc3be63', documentMetadata)
      .post('/change-metadata/12e68184-5cba-4b27-9988-609a6cc3be63', changed || 200)
      .post('/save-editor/12e68184-5cba-4b27-9988-609a6cc3be63',
          {token: '12e68184-5cba-4b27-9988-609a6cc3be63'},
          {delay: 1000},
      );

  return ({
    components: {DocumentEditor},
    setup() {
      return {args};
    },
    template: '<DocumentEditor v-bind="args" base-url="/" value="12e68184-5cba-4b27-9988-609a6cc3be63" />',
  });
};

export const Basic = UploadingServerTemplate.bind({});

export default {
  title: 'DocumentEditor',
  component: DocumentEditor,
} as Meta<typeof DocumentEditor>;
`,locationsMap:{basic:{startLoc:{col:5,line:36},endLoc:{col:1,line:62},startBody:{col:5,line:36},endBody:{col:1,line:62}}}}},title:"DocumentEditor",component:DocumentEditor},__namedExportsOrder=["Basic"];export{Basic,__namedExportsOrder,DocumentEditor_stories as default};
//# sourceMappingURL=DocumentEditor.stories-a537ec32.js.map
