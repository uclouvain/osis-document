var m=Object.defineProperty;var l=(e,i)=>m(e,"name",{value:i,configurable:!0});import{d as c,p as g,a as s,b as t,t as n,k as d,n as f,e as p,i as u,o as a}from"./vue.esm-bundler-398966a3.js";import{d as y,_ as b}from"./plugin-vueexport-helper-dbf55845.js";const h=c({name:"ViewingModal",props:{baseUrl:{type:String,required:!0},value:{type:String,required:!0},id:{type:String,required:!0},file:{type:Object,required:!0},isEditable:{type:Boolean,default:!0},openOnMount:{type:Boolean,default:!1}},emits:{updateToken(e){return e.length>0}},data:function(){return{rotation:0,originalHeight:null,originalWidth:null,modalHeight:"auto",modalWidth:"auto",error:"",saved:!1}},computed:{isImage:function(){return this.file.mimetype.split("/")[0]==="image"},imageStyle:function(){let e=`rotate(${this.rotation}deg)`;this.isQuarterRotated?e+=` translate(${this.isRotated90CounterClockwise?"-50%":"50%"}, -50%)`:this.isRotated&&(e+=" translate(0, -100%)");const i=this.$refs.modal,r=this.originalHeight&&this.isQuarterRotated&&i.clientWidth<this.originalHeight?`${i.clientWidth-30}px`:"auto";return{transform:e,height:r}},isRotated:function(){return this.rotation%360},isQuarterRotated:function(){return this.rotation%180},isRotated90CounterClockwise:function(){return[-90,270].includes(this.rotation%360)}},watch:{rotation:"changeModalHeight"},mounted(){jQuery(this.$el).on("shown.bs.modal",()=>{this.originalHeight||this.imageLoaded(this.$refs.img),this.changeModalHeight()}),this.openOnMount&&jQuery(this.$el).modal("show")},beforeUnmount(){jQuery(this.$el).modal("hide")},methods:{imageLoaded:async function(e){await g(),this.originalHeight=e.clientHeight,this.originalWidth=e.clientWidth,this.changeModalHeight()},changeModalHeight:function(){if(!this.originalWidth||!this.originalHeight)return"auto";const e=this.$refs.modal;this.isQuarterRotated&&e.clientWidth<this.originalHeight?this.modalHeight=`${e.clientWidth*this.originalWidth/this.originalHeight+30}px`:this.modalHeight=`${(this.isQuarterRotated?this.originalWidth:this.originalHeight)+30}px`},saveRotation:async function(){try{const e=await y(`${this.baseUrl}rotate-image/${this.value}`,{method:"POST",body:JSON.stringify({rotate:this.rotation})});this.saved=!0,this.rotation=0,this.$emit("updateToken",e.token),this.error=""}catch(e){this.error=e.message}}}}),v=["id"],_={class:"modal-dialog modal-lg",role:"document"},$={class:"modal-content"},k={class:"modal-header"},w=["aria-label"],H=t("span",{"aria-hidden":"true"},"Ã—",-1),R=[H],M={class:"modal-title"},W=["src","alt"],C={key:1,class:"embed-responsive embed-responsive-16by9"},V=["data"],q=["src"],S={class:"modal-footer"},Q={class:"row"},N={key:0,class:"col-sm-10 text-left"},O=t("i",{class:"fas fa-undo"},null,-1),T=[O],j=t("i",{class:"fas fa-redo"},null,-1),B=[j],U=["disabled"],E={key:0,class:"text-danger"},I={class:"col-sm-2 pull-right"},L={type:"button",class:"btn btn-default","data-dismiss":"modal"};function z(e,i,r,D,F,J){return a(),s("div",{id:`modal-${e.id}`,class:"modal fade",tabindex:"-1",role:"dialog"},[t("div",_,[t("div",$,[t("div",k,[t("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":e.$t("view_entry.close")},R,8,w),t("h4",M,n(e.file.name),1)]),t("div",{ref:"modal",class:"modal-body",style:d([{transition:"500ms",overflow:"hidden","max-width":"100%"},{height:e.modalHeight}])},[e.isImage?(a(),s("img",{key:0,ref:"img",src:e.file.url,alt:e.file.name,class:"img-responsive",style:d([{transition:"500ms","transform-origin":"top center",margin:"0 auto"},e.imageStyle]),onLoad:i[0]||(i[0]=o=>e.imageLoaded(o.target))},null,44,W)):(a(),s("div",C,[t("object",{data:e.file.url,type:"application/pdf",class:"embed-responsive-item"},[t("embed",{src:e.file.url,type:"application/pdf"},null,8,q)],8,V)]))],4),t("div",S,[t("div",Q,[e.isImage&&e.isEditable?(a(),s("div",N,[t("button",{type:"button",class:"btn btn-default",onClick:i[1]||(i[1]=o=>e.rotation-=90)},T),t("button",{type:"button",class:"btn btn-default",onClick:i[2]||(i[2]=o=>e.rotation+=90)},B),t("button",{type:"button",class:"btn btn-default",disabled:!e.isRotated,onClick:i[3]||(i[3]=(...o)=>e.saveRotation&&e.saveRotation(...o))},[t("i",{class:f(`fas fa-${e.saved?"check":"save"}`)},null,2),p(" "+n(e.$t("view_entry.save")),1)],8,U),e.error?(a(),s("span",E,n(e.$t("error",{error:e.error})),1)):u("",!0)])):u("",!0),t("div",I,[t("button",L,n(e.$t("view_entry.close")),1)])])])])])],8,v)}l(z,"_sfc_render");const K=b(h,[["render",z]]);h.__docgenInfo={displayName:"ViewingModal",exportName:"default",description:"",tags:{},props:[{name:"baseUrl",type:{name:"string"},required:!0},{name:"value",type:{name:"string"},required:!0},{name:"id",type:{name:"string"},required:!0},{name:"file",type:{name:"FileUpload"},required:!0},{name:"isEditable",type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"openOnMount",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}}],events:[{name:"updateToken",type:{names:["undefined"]}}],sourceFiles:["/home/runner/work/osis-document/osis-document/frontend/components/ViewingModal.vue"]};export{K as V};
//# sourceMappingURL=ViewingModal-2336206d.js.map
