{"version":3,"file":"osis-document.umd.js","sources":["../../../frontend/i18n.ts","../../../frontend/utils.ts","../../../node_modules/tiny-emitter/index.js","../../../frontend/event-bus.ts","../../../frontend/components/UploadEntry.vue","../../../frontend/components/ViewingModal.vue","../../../frontend/components/ViewEntry.vue","../../../frontend/DocumentUploader.vue","../../../frontend/DocumentVisualizer.vue","../../../frontend/main.ts"],"sourcesContent":["/*\n *\n *   OSIS stands for Open Student Information System. It's an application\n *   designed to manage the core business of higher education institutions,\n *   such as universities, faculties, institutes and professional schools.\n *   The core business involves the administration of students, teachers,\n *   courses, programs and so on.\n *\n *   Copyright (C) 2015-2021 Université catholique de Louvain (http://www.uclouvain.be)\n *\n *   This program is free software: you can redistribute it and/or modify\n *   it under the terms of the GNU General Public License as published by\n *   the Free Software Foundation, either version 3 of the License, or\n *   (at your option) any later version.\n *\n *   This program is distributed in the hope that it will be useful,\n *   but WITHOUT ANY WARRANTY; without even the implied warranty of\n *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *   GNU General Public License for more details.\n *\n *   A copy of this license - GNU General Public License - is available\n *   at the root of the source code of this program.  If not,\n *   see http://www.gnu.org/licenses/.\n *\n */\n\nimport {createI18n} from 'vue-i18n';\n\nconst messages = {\n  en: {\n    uploader: {\n      specific_nb_drag_n_drop_label: 'Drag and drop one file here | Drag and drop {count} files here',\n      min_max_drag_n_drop_label: 'Drag and drop between {min} and {max} files here',\n      min_drag_n_drop_label: 'Drag and drop at least one file here | Drag and drop at least {count} files here',\n      max_drag_n_drop_label: 'Drag and drop your file here | Drag and drop your files here (maximum {count})',\n      drag_n_drop_label: 'Drag and drop your files here',\n      add_file_label: 'or click here',\n      max_size_label: '(max size {size})',\n      trigger_upload: 'Upload',\n    },\n    upload_entry: {\n      completion: '{progress}% uploaded',\n      too_large: 'File is too large',\n      wrong_type: 'The file must have the following type: \"{types}\" | The file must have one of the following types: \"{types}\"',\n    },\n    view_entry: {\n      rotate_left: 'Rotate image left',\n      rotate_right: 'Rotate image right',\n      loading: \"Loading...\",\n      close: \"Close\",\n      save: \"Save\",\n      file_infected: \"The referenced file appears to be infected with a virus\",\n    },\n    error: 'Error: {error}',\n    request_error: 'Request error: {error}',\n    units: ['B', 'KB', 'MB', 'GB', 'TB'],\n  },\n  'fr-be': {\n    uploader: {\n      specific_nb_drag_n_drop_label: 'Glissez-déposez ici un fichier | Glissez-déposez ici {count} fichiers',\n      min_max_drag_n_drop_label: 'Glissez-déposez ici entre {min} et {max} fichiers',\n      min_drag_n_drop_label: 'Glissez-déposez ici au-moins un fichier | Glissez-déposez ici au-moins {count} fichiers',\n      max_drag_n_drop_label: 'Glissez-déposez ici votre fichier | Glissez-déposez ici vos fichiers (maximum {count})',\n      drag_n_drop_label: 'Glissez-déposez ici vos fichiers',\n      add_file_label: 'ou cliquez-ici',\n      max_size_label: '(taille maximum {size})',\n      trigger_upload: 'Transférer',\n    },\n    upload_entry: {\n      completion: '{progress}% transférés',\n      too_large: 'Le fichier est trop lourd',\n      wrong_type: 'Le fichier doit être du type \"{types}\" | Le fichier doit être d\\'un des types suivants : \"{types}\"',\n    },\n    view_entry: {\n      rotate_left: \"Faire pivoter l'image à gauche\",\n      rotate_right: \"Faire pivoter l'image à droite\",\n      loading: \"Chargement...\",\n      close: \"Fermer\",\n      save: \"Enregistrer\",\n      file_infected: \"Le fichier référencé semble infecté par un virus\",\n    },\n    error: 'Erreur : {error}',\n    request_error: 'Erreur lors de la requête : {error}',\n    units: ['o', 'Ko', 'Mo', 'Go', 'To'],\n  },\n};\n\nexport const i18n = createI18n({\n  locale: document.documentElement.lang || 'en',\n  messages,\n});\n","/*\n *\n *   OSIS stands for Open Student Information System. It's an application\n *   designed to manage the core business of higher education institutions,\n *   such as universities, faculties, institutes and professional schools.\n *   The core business involves the administration of students, teachers,\n *   courses, programs and so on.\n *\n *   Copyright (C) 2015-2021 Université catholique de Louvain (http://www.uclouvain.be)\n *\n *   This program is free software: you can redistribute it and/or modify\n *   it under the terms of the GNU General Public License as published by\n *   the Free Software Foundation, either version 3 of the License, or\n *   (at your option) any later version.\n *\n *   This program is distributed in the hope that it will be useful,\n *   but WITHOUT ANY WARRANTY; without even the implied warranty of\n *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *   GNU General Public License for more details.\n *\n *   A copy of this license - GNU General Public License - is available\n *   at the root of the source code of this program.  If not,\n *   see http://www.gnu.org/licenses/.\n *\n */\nimport {i18n} from './i18n';\n\nexport function humanizedSize(size: number): string {\n  let i = 0;\n  while (size >= 1024) {\n    size /= 1024;\n    ++i;\n  }\n  const unit = i18n.global.t(`units[${i}]`);\n  return `${size.toFixed(2)} ${unit}`;\n}\n\n\nexport async function doRequest(url: string, params?: object): Promise<unknown> {\n  const response = await fetch(url, {\n    headers: {'Content-Type': 'application/json'},\n    ...params,\n  });\n  if (response.status >= 200 && response.status < 300) {\n    return response.json();\n  } else {\n    throw new Error(response.statusText);\n  }\n}\n","function E () {\n  // Keep this empty so it's easier to inherit from\n  // (via https://github.com/lipsmack from https://github.com/scottcorgan/tiny-emitter/issues/3)\n}\n\nE.prototype = {\n  on: function (name, callback, ctx) {\n    var e = this.e || (this.e = {});\n\n    (e[name] || (e[name] = [])).push({\n      fn: callback,\n      ctx: ctx\n    });\n\n    return this;\n  },\n\n  once: function (name, callback, ctx) {\n    var self = this;\n    function listener () {\n      self.off(name, listener);\n      callback.apply(ctx, arguments);\n    };\n\n    listener._ = callback\n    return this.on(name, listener, ctx);\n  },\n\n  emit: function (name) {\n    var data = [].slice.call(arguments, 1);\n    var evtArr = ((this.e || (this.e = {}))[name] || []).slice();\n    var i = 0;\n    var len = evtArr.length;\n\n    for (i; i < len; i++) {\n      evtArr[i].fn.apply(evtArr[i].ctx, data);\n    }\n\n    return this;\n  },\n\n  off: function (name, callback) {\n    var e = this.e || (this.e = {});\n    var evts = e[name];\n    var liveEvents = [];\n\n    if (evts && callback) {\n      for (var i = 0, len = evts.length; i < len; i++) {\n        if (evts[i].fn !== callback && evts[i].fn._ !== callback)\n          liveEvents.push(evts[i]);\n      }\n    }\n\n    // Remove event from queue to prevent memory leak\n    // Suggested by https://github.com/lazd\n    // Ref: https://github.com/scottcorgan/tiny-emitter/commit/c6ebfaa9bc973b33d110a84a307742b7cf94c953#commitcomment-5024910\n\n    (liveEvents.length)\n      ? e[name] = liveEvents\n      : delete e[name];\n\n    return this;\n  }\n};\n\nmodule.exports = E;\nmodule.exports.TinyEmitter = E;\n","/*\n *\n *   OSIS stands for Open Student Information System. It's an application\n *   designed to manage the core business of higher education institutions,\n *   such as universities, faculties, institutes and professional schools.\n *   The core business involves the administration of students, teachers,\n *   courses, programs and so on.\n *\n *   Copyright (C) 2015-2021 Université catholique de Louvain (http://www.uclouvain.be)\n *\n *   This program is free software: you can redistribute it and/or modify\n *   it under the terms of the GNU General Public License as published by\n *   the Free Software Foundation, either version 3 of the License, or\n *   (at your option) any later version.\n *\n *   This program is distributed in the hope that it will be useful,\n *   but WITHOUT ANY WARRANTY; without even the implied warranty of\n *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *   GNU General Public License for more details.\n *\n *   A copy of this license - GNU General Public License - is available\n *   at the root of the source code of this program.  If not,\n *   see http://www.gnu.org/licenses/.\n *\n */\n\nimport {TinyEmitter} from 'tiny-emitter';\n\nconst EventBus = new TinyEmitter();\n\nexport default EventBus;\n\n","<!--\n  -\n  -   OSIS stands for Open Student Information System. It's an application\n  -   designed to manage the core business of higher education institutions,\n  -   such as universities, faculties, institutes and professional schools.\n  -   The core business involves the administration of students, teachers,\n  -   courses, programs and so on.\n  -\n  -   Copyright (C) 2015-2021 Université catholique de Louvain (http://www.uclouvain.be)\n  -\n  -   This program is free software: you can redistribute it and/or modify\n  -   it under the terms of the GNU General Public License as published by\n  -   the Free Software Foundation, either version 3 of the License, or\n  -   (at your option) any later version.\n  -\n  -   This program is distributed in the hope that it will be useful,\n  -   but WITHOUT ANY WARRANTY; without even the implied warranty of\n  -   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  -   GNU General Public License for more details.\n  -\n  -   A copy of this license - GNU General Public License - is available\n  -   at the root of the source code of this program.  If not,\n  -   see http://www.gnu.org/licenses/.\n  -\n  -->\n<template>\n  <li class=\"media\">\n    <div\n        v-if=\"isImage\"\n        class=\"media-left\"\n    >\n      <img\n          class=\"media-object img-thumbnail\"\n          :src=\"fileUrl\"\n          :alt=\"file.name\"\n          width=\"80\"\n          @load=\"revokeUrl(fileUrl)\"\n      >\n    </div>\n    <div class=\"media-body\">\n      <h4 class=\"media-heading\">\n        {{ file.name }}\n        <small><span class=\"text-nowrap\">{{ humanizedSize }}</span> ({{ file.type }})</small>\n      </h4>\n      <div\n          v-if=\"!error\"\n          class=\"progress\"\n      >\n        <div\n            class=\"progress-bar progress-bar-striped active\"\n            role=\"progressbar\"\n            :aria-valuenow=\"progress\"\n            aria-valuemin=\"0\"\n            aria-valuemax=\"100\"\n            :style=\"{width: `${progress}%`}\"\n        >\n          <span class=\"sr-only\">{{ $t('upload_entry.completion', { progress }) }}</span>\n        </div>\n      </div>\n      <span\n          v-else\n          class=\"text-danger\"\n      >\n        {{ error }}\n      </span>\n    </div>\n    <div class=\"media-right\">\n      <button\n          type=\"button\"\n          class=\"btn btn-danger\"\n          @click=\"$emit('delete')\"\n      >\n        <span class=\"fas fa-trash-alt\" />\n      </button>\n    </div>\n  </li>\n</template>\n\n<script lang=\"ts\">\n/**\n * This component goal is to upload a local file and emit a token\n */\nimport {humanizedSize} from '../utils';\nimport EventBus from '../event-bus';\nimport {defineComponent} from 'vue';\nimport type {ErrorReponse, TokenReponse} from \"../interfaces\";\n\nexport default defineComponent({\n  name: 'UploadEntry',\n  props: {\n    file: {\n      type: File,\n      required: true,\n    },\n    baseUrl: {\n      type: String,\n      required: true,\n    },\n    maxSize: {\n      type: Number,\n      default: 0,\n    },\n    mimetypes: {\n      type: Array,\n      default: () => [],\n    },\n    automatic: {\n      type: Boolean,\n      default: true,\n    },\n  },\n  emits: {\n    setToken(token: string) {\n      return token.length > 0;\n    },\n    delete() {\n      return true;\n    },\n  },\n  data() {\n    return {\n      progress: 0,\n      token: '',\n      error: '',\n    };\n  },\n  computed: {\n    isImage: function () {\n      return this.file.type.split('/')[0] === 'image';\n    },\n    fileUrl: function () {\n      return URL.createObjectURL(this.file);\n    },\n    humanizedSize: function () {\n      return humanizedSize(this.file.size);\n    },\n  },\n  mounted() {\n    if (this.maxSize && this.file.size > this.maxSize) {\n      this.error = this.$t('upload_entry.too_large');\n    } else if (this.mimetypes.length && !this.mimetypes.includes(this.file.type)) {\n      this.error = this.$tc('upload_entry.wrong_type', this.mimetypes.length, {types: this.mimetypes.join(', ')});\n    } else if (this.automatic) {\n      this.sendFile();\n    } else {\n      EventBus.on('upload', this.sendFile);\n    }\n  },\n  methods: {\n    revokeUrl: function (url: string) {\n      URL.revokeObjectURL(url);\n    },\n    sendFile: function () {\n      const xhr = new XMLHttpRequest();\n      xhr.upload.addEventListener('progress', (e) => {\n        this.progress = Math.round((e.loaded * 100) / e.total);\n      }, false);\n\n      xhr.open('POST', `${this.baseUrl}request-upload`, true);\n      xhr.addEventListener('readystatechange', () => {\n        if (xhr.readyState === 4 && xhr.status >= 200 && xhr.status <= 300) {\n          const response = JSON.parse(xhr.responseText) as TokenReponse;\n          this.$emit('setToken', response.token);\n        } else {\n          let detail;\n          try {\n            detail = (JSON.parse(xhr.responseText) as ErrorReponse).detail;\n          } catch (e) {\n            detail = xhr.statusText;\n          }\n          this.error = this.$t('request_error', {error: detail});\n        }\n      });\n\n      const fd = new FormData();\n      fd.append('file', this.file);\n      // Initiate a multipart/form-data upload\n      xhr.send(fd);\n    },\n  },\n});\n</script>\n","<!--\n  -\n  -   OSIS stands for Open Student Information System. It's an application\n  -   designed to manage the core business of higher education institutions,\n  -   such as universities, faculties, institutes and professional schools.\n  -   The core business involves the administration of students, teachers,\n  -   courses, programs and so on.\n  -\n  -   Copyright (C) 2015-2021 Université catholique de Louvain (http://www.uclouvain.be)\n  -\n  -   This program is free software: you can redistribute it and/or modify\n  -   it under the terms of the GNU General Public License as published by\n  -   the Free Software Foundation, either version 3 of the License, or\n  -   (at your option) any later version.\n  -\n  -   This program is distributed in the hope that it will be useful,\n  -   but WITHOUT ANY WARRANTY; without even the implied warranty of\n  -   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  -   GNU General Public License for more details.\n  -\n  -   A copy of this license - GNU General Public License - is available\n  -   at the root of the source code of this program.  If not,\n  -   see http://www.gnu.org/licenses/.\n  -\n  -->\n\n<template>\n  <div\n      :id=\"`modal-${id}`\"\n      class=\"modal fade\"\n      tabindex=\"-1\"\n      role=\"dialog\"\n  >\n    <div\n        class=\"modal-dialog modal-lg\"\n        role=\"document\"\n    >\n      <div class=\"modal-content\">\n        <div class=\"modal-header\">\n          <button\n              type=\"button\"\n              class=\"close\"\n              data-dismiss=\"modal\"\n              :aria-label=\"$t('view_entry.close')\"\n          >\n            <span aria-hidden=\"true\">&times;</span>\n          </button>\n          <h4 class=\"modal-title\">\n            {{ file.name }}\n          </h4>\n        </div>\n        <div\n            ref=\"modal\"\n            class=\"modal-body\"\n            style=\"transition: 500ms; overflow: hidden; max-width: 100%\"\n            :style=\"{height: modalHeight}\"\n        >\n          <img\n              v-if=\"isImage\"\n              ref=\"img\"\n              :src=\"file.url\"\n              :alt=\"file.name\"\n              class=\"img-responsive\"\n              style=\"transition: 500ms; transform-origin: top center; margin: 0 auto;\"\n              :style=\"imageStyle\"\n              @load=\"imageLoaded($event.target as HTMLImageElement)\"\n          >\n          <div\n              v-else\n              class=\"embed-responsive embed-responsive-16by9\"\n          >\n            <object\n                :data=\"file.url\"\n                type=\"application/pdf\"\n                class=\"embed-responsive-item\"\n            >\n              <embed\n                  :src=\"file.url\"\n                  type=\"application/pdf\"\n              >\n            </object>\n          </div>\n        </div>\n        <div class=\"modal-footer\">\n          <div class=\"row\">\n            <div\n                v-if=\"isImage && isEditable\"\n                class=\"col-sm-10 text-left\"\n            >\n              <button\n                  type=\"button\"\n                  class=\"btn btn-default\"\n                  @click=\"rotation -= 90\"\n              >\n                <i class=\"fas fa-undo\" />\n              </button>\n              <button\n                  type=\"button\"\n                  class=\"btn btn-default\"\n                  @click=\"rotation += 90\"\n              >\n                <i class=\"fas fa-redo\" />\n              </button>\n              <button\n                  type=\"button\"\n                  class=\"btn btn-default\"\n                  :disabled=\"!isRotated\"\n                  @click=\"saveRotation\"\n              >\n                <i :class=\"`fas fa-${saved ? 'check' : 'save'}`\" />\n                {{ $t('view_entry.save') }}\n              </button>\n              <span\n                  v-if=\"error\"\n                  class=\"text-danger\"\n              >\n                {{ $t('error', { error }) }}\n              </span>\n            </div>\n            <div class=\"col-sm-2 pull-right\">\n              <button\n                  type=\"button\"\n                  class=\"btn btn-default\"\n                  data-dismiss=\"modal\"\n              >\n                {{ $t('view_entry.close') }}\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport {defineComponent, nextTick} from 'vue';\nimport type {PropType} from 'vue';\nimport type {FileUpload, TokenReponse} from '../interfaces';\nimport {doRequest} from \"../utils\";\n\nexport default defineComponent({\n  name: 'ViewingModal',\n  props: {\n    baseUrl: {\n      type: String,\n      required: true,\n    },\n    value: {\n      type: String,\n      required: true,\n    },\n    id: {\n      type: String,\n      required: true,\n    },\n    file: {\n      type: Object as PropType<FileUpload>,\n      required: true,\n    },\n    isEditable: {\n      type: Boolean,\n      default: true,\n    },\n    openOnMount: {\n      type: Boolean,\n      default: false,\n    },\n  },\n  emits: {\n    updateToken(token: string) {\n      return token.length > 0;\n    },\n  },\n  data: function () {\n    return {\n      // Image rotation set by user\n      rotation: 0,\n      // Original image dimensions (filled once loaded)\n      originalHeight: null as number | null,\n      originalWidth: null as number | null,\n      // Programmatically controlled dimensions for modal\n      modalHeight: 'auto',\n      modalWidth: 'auto',\n      error: '',\n      saved: false,\n    };\n  },\n  computed: {\n    isImage: function () {\n      return this.file.mimetype.split('/')[0] === 'image';\n    },\n    imageStyle: function () {\n      let transform = `rotate(${this.rotation}deg)`;\n      if (this.isQuarterRotated) {\n        transform += ` translate(${this.isRotated90CounterClockwise ? '-50%' : '50%'}, -50%)`;\n      } else if (this.isRotated) {\n        transform += ` translate(0, -100%)`;\n      }\n      // When image is portrait, constraint the rotated image height (which is width) to modal width\n      const modal = this.$refs.modal as HTMLDivElement;\n      const height = (this.originalHeight && this.isQuarterRotated && modal.clientWidth < this.originalHeight)\n          ? `${modal.clientWidth - 30}px`\n          : 'auto';\n      return {transform, height};\n    },\n    isRotated: function () {\n      return this.rotation % 360;\n    },\n    isQuarterRotated: function () {\n      // Check if the image is rotated at 90 or -90 degrees\n      return this.rotation % 180;\n    },\n    isRotated90CounterClockwise: function () {\n      // Check if the image is rotated at -90 degrees\n      return [-90, 270].includes(this.rotation % 360);\n    },\n  },\n  watch: {\n    rotation: 'changeModalHeight',\n  },\n  mounted() {\n    // The modal may be loaded hidden, thus the image has no dimensions, use bootstrap event\n    jQuery(this.$el).on('shown.bs.modal', () => {\n      if (!this.originalHeight) {\n        void this.imageLoaded(this.$refs.img as HTMLImageElement);\n      }\n      this.changeModalHeight();\n    });\n    if (this.openOnMount) {\n      jQuery(this.$el).modal('show');\n    }\n  },\n  beforeUnmount() {\n    jQuery(this.$el).modal('hide');\n  },\n  methods: {\n    imageLoaded: async function (img: HTMLImageElement) {\n      // The image is loaded, better wait for next rendering tick\n      await nextTick();\n      this.originalHeight = img.clientHeight;\n      this.originalWidth = img.clientWidth;\n      this.changeModalHeight();\n    },\n    changeModalHeight: function () {\n      if (!this.originalWidth || !this.originalHeight) return 'auto';  // Image is not yet loaded\n      const modal = this.$refs.modal as HTMLDivElement;\n      if (this.isQuarterRotated && modal.clientWidth < this.originalHeight) {\n        // Handle case when image is too tall for width (portrait)\n        this.modalHeight = `${modal.clientWidth * this.originalWidth / this.originalHeight + 30}px`;\n      } else {\n        this.modalHeight = `${(this.isQuarterRotated ? this.originalWidth : this.originalHeight) + 30}px`;\n      }\n    },\n    saveRotation: async function () {\n      try {\n        const data = await doRequest(`${this.baseUrl}rotate-image/${this.value}`, {\n          method: 'POST',\n          body: JSON.stringify({rotate: this.rotation}),\n        }) as TokenReponse;\n        this.saved = true;\n        this.rotation = 0;\n        this.$emit('updateToken', data.token);\n        this.error = '';\n      } catch (e) {\n        this.error = (e as Error).message;\n      }\n    },\n  },\n});\n</script>\n","<!--\n  -\n  -   OSIS stands for Open Student Information System. It's an application\n  -   designed to manage the core business of higher education institutions,\n  -   such as universities, faculties, institutes and professional schools.\n  -   The core business involves the administration of students, teachers,\n  -   courses, programs and so on.\n  -\n  -   Copyright (C) 2015-2021 Université catholique de Louvain (http://www.uclouvain.be)\n  -\n  -   This program is free software: you can redistribute it and/or modify\n  -   it under the terms of the GNU General Public License as published by\n  -   the Free Software Foundation, either version 3 of the License, or\n  -   (at your option) any later version.\n  -\n  -   This program is distributed in the hope that it will be useful,\n  -   but WITHOUT ANY WARRANTY; without even the implied warranty of\n  -   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  -   GNU General Public License for more details.\n  -\n  -   A copy of this license - GNU General Public License - is available\n  -   at the root of the source code of this program.  If not,\n  -   see http://www.gnu.org/licenses/.\n  -\n  -->\n\n<template>\n  <li class=\"media\">\n    <!-- progress bar -->\n    <div\n        v-if=\"loading\"\n        class=\"media-body\"\n    >\n      <div class=\"progress\">\n        <div\n            class=\"progress-bar progress-bar-striped active\"\n            role=\"progressbar\"\n            aria-valuenow=\"0\"\n            aria-valuemin=\"0\"\n            aria-valuemax=\"100\"\n            :style=\"{width: `100%`}\"\n        >\n          <span class=\"sr-only\">{{ $t('view_entry.loading') }}</span>\n        </div>\n      </div>\n    </div>\n    <!-- error -->\n    <template v-else-if=\"error\">\n      <div class=\"media-body\">\n        <span class=\"text-danger\">{{ $t('error', { error }) }}</span>\n      </div>\n      <div class=\"media-right text-right\">\n        <button\n            v-if=\"isEditable\"\n            class=\"btn btn-danger\"\n            type=\"button\"\n            @click=\"$emit('delete')\"\n        >\n          <span class=\"fas fa-trash-alt\" />\n        </button>\n      </div>\n    </template>\n    <!-- thumbnail -->\n    <template v-else-if=\"file\">\n      <div\n          v-if=\"isImage\"\n          class=\"media-left\"\n      >\n        <img\n            class=\"media-object img-thumbnail\"\n            :src=\"file.url\"\n            :alt=\"file.name\"\n            width=\"80\"\n        >\n      </div>\n      <div class=\"media-body\">\n        <h4 class=\"media-heading\">\n          <div\n              v-if=\"isEditable && editableFilename\"\n              class=\"input-group\"\n          >\n            <input\n                v-model=\"name\"\n                type=\"text\"\n                class=\"form-control\"\n                @input=\"saved = false\"\n            >\n            <span\n                v-if=\"extension\"\n                class=\"input-group-addon\"\n            >\n              {{ extension }}\n            </span>\n            <span class=\"input-group-btn\">\n              <button\n                  type=\"button\"\n                  :disabled=\"file.name === fullName\"\n                  class=\"btn btn-default\"\n                  @click=\"saveName\"\n              >\n                <i :class=\"`fas fa-${saved ? 'check' : 'save'}`\" />\n              </button>\n            </span>\n          </div>\n          <div v-else>\n            {{ file.name }}\n          </div>\n          <small><span class=\"text-nowrap\">{{ humanizedSize(file.size) }}</span> ({{ file.mimetype }})</small>\n        </h4>\n      </div>\n      <!-- actions -->\n      <div\n          class=\"media-right text-right\"\n          :style=\"{'min-width': isViewableDocument ? '9.5em' : '7em'}\"\n      >\n        <div class=\"btn-group\">\n          <a\n              v-if=\"isViewableDocument\"\n              class=\"btn btn-default\"\n              data-toggle=\"modal\"\n              :data-target=\"`#modal-${formattedValue}`\"\n          >\n            <span class=\"fas fa-eye\" />\n          </a>\n          <a\n              class=\"btn btn-default\"\n              target=\"_blank\"\n              :href=\"`${file.url}?dl=1`\"\n          >\n            <span class=\"fas fa-download\" />\n          </a>\n          <button\n              v-if=\"isEditable\"\n              class=\"btn btn-danger\"\n              type=\"button\"\n              @click=\"$emit('delete')\"\n          >\n            <span class=\"fas fa-trash-alt\" />\n          </button>\n        </div>\n      </div>\n      <ViewingModal\n          v-if=\"isViewableDocument\"\n          :id=\"formattedValue\"\n          :file=\"file\"\n          :is-editable=\"isEditable\"\n          :value=\"value\"\n          :base-url=\"baseUrl\"\n          @update-token=\"$emit('updateToken', $event)\"\n      />\n    </template>\n  </li>\n</template>\n\n<script lang=\"ts\">\n/**\n * This component's goal is to view an uploaded file and edit it\n */\nimport {doRequest, humanizedSize} from '../utils';\nimport ViewingModal from './ViewingModal.vue';\nimport {defineComponent} from 'vue';\nimport type {FileUpload} from \"../interfaces\";\n\nexport default defineComponent({\n  name: 'ViewEntry',\n  components: {ViewingModal},\n  props: {\n    value: {\n      type: String,\n      required: true,\n    },\n    id: {\n      type: String,\n      required: true,\n    },\n    baseUrl: {\n      type: String,\n      required: true,\n    },\n    isEditable: {\n      type: Boolean,\n      default: true,\n    },\n    editableFilename: {\n      type: Boolean,\n      default: true,\n    },\n  },\n  emits: {\n    updateToken(token: string) {\n      return token.length > 0;\n    },\n    delete() {\n      return true;\n    },\n  },\n  data() {\n    return {\n      file: null as FileUpload | null,\n      loading: true,\n      error: '',\n      name: '',\n      extension: '',\n      saved: false,\n    };\n  },\n  computed: {\n    isImage: function () {\n      return this.file?.mimetype.split('/')[0] === 'image';\n    },\n    isViewableDocument: function () {\n      const mimetype = (this.file as FileUpload).mimetype;\n      return mimetype.split('/')[0] === 'image' || mimetype === 'application/pdf';\n    },\n    formattedValue: function () {\n      return this.value.replace(/:/g, '-');\n    },\n    fullName: {\n      // The full name is composed of the file name and extension (if specified)\n      get() {\n        return `${this.name}${this.extension}`;\n      },\n      set: function (newValue: string) {\n        const splitName = /^(.+)(\\.[^.]+)$/.exec(newValue);\n        if (splitName?.length === 3) {\n          this.name = splitName[1];\n          this.extension = splitName[2];\n        } else {\n          this.name = newValue;\n          this.extension = '';\n        }\n      },\n    },\n  },\n  watch: {\n    value: 'getFile',\n  },\n  mounted() {\n    void this.getFile();\n  },\n  methods: {\n    humanizedSize,\n    getFile: async function () {\n      if (this.value === 'FileInfectedException') {\n        this.error = this.$t('view_entry.file_infected');\n      } else {\n        try {\n          this.file = await doRequest(`${this.baseUrl}metadata/${this.value}`) as FileUpload;\n          this.fullName = this.file.name;\n        } catch (e) {\n          this.error = (e as Error).message;\n        }\n      }\n      this.loading = false;\n    },\n    saveName: async function () {\n      try {\n        await doRequest(`${this.baseUrl}change-metadata/${this.value}`, {\n          method: 'POST',\n          body: JSON.stringify({name: this.fullName}),\n        });\n        this.saved = true;\n        (this.file as FileUpload).name = this.fullName;\n      } catch (e) {\n        this.error = (e as Error).message;\n      }\n    },\n  },\n});\n</script>\n","<!--\n  -\n  -   OSIS stands for Open Student Information System. It's an application\n  -   designed to manage the core business of higher education institutions,\n  -   such as universities, faculties, institutes and professional schools.\n  -   The core business involves the administration of students, teachers,\n  -   courses, programs and so on.\n  -\n  -   Copyright (C) 2015-2023 Université catholique de Louvain (http://www.uclouvain.be)\n  -\n  -   This program is free software: you can redistribute it and/or modify\n  -   it under the terms of the GNU General Public License as published by\n  -   the Free Software Foundation, either version 3 of the License, or\n  -   (at your option) any later version.\n  -\n  -   This program is distributed in the hope that it will be useful,\n  -   but WITHOUT ANY WARRANTY; without even the implied warranty of\n  -   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  -   GNU General Public License for more details.\n  -\n  -   A copy of this license - GNU General Public License - is available\n  -   at the root of the source code of this program.  If not,\n  -   see http://www.gnu.org/licenses/.\n  -\n  -->\n<template>\n  <div\n      ref=\"uploader\"\n      class=\"osis-document-uploader\"\n  >\n    <div\n        v-if=\"maxFiles === 0 || nbUploadedFiles < maxFiles\"\n        class=\"dropzone form-group\"\n        :class=\"{hovering: isDragging}\"\n        @dragenter=\"isDragging = true\"\n    >\n      <input\n          ref=\"fileInput\"\n          type=\"file\"\n          multiple\n          :accept=\"mimetypes.length ? mimetypes.join(',') : undefined\"\n          @dragleave=\"isDragging = false\"\n          @change=\"onFilePicked\"\n      >\n      {{ uploadText || dragNDropLabel }}\n      <button\n          class=\"btn btn-default\"\n          type=\"button\"\n          @click=\"($refs.fileInput as HTMLInputElement).click()\"\n      >\n        <span class=\"glyphicon glyphicon-plus\" />\n        {{ uploadButtonText || $t('uploader.add_file_label') }}\n      </button>\n      <span v-if=\"maxSize\">\n        {{ $t('uploader.max_size_label', { size: humanizedSize(maxSize) }) }}\n      </span>\n    </div>\n\n    <ul\n        v-if=\"fileList\"\n        class=\"media-list\"\n    >\n      <UploadEntry\n          v-for=\"(file, index) in fileList\"\n          :key=\"index\"\n          :file=\"file\"\n          :base-url=\"baseUrl\"\n          :max-size=\"maxSize\"\n          :mimetypes=\"mimetypes\"\n          :automatic=\"automaticUpload\"\n          @delete=\"delete fileList[index]; delete tokens[index];\"\n          @set-token=\"tokens[index] = $event; delete fileList[index];\"\n      />\n    </ul>\n    <div\n        v-if=\"!automaticUpload && Object.values(fileList).length\"\n        class=\"text-right form-group\"\n    >\n      <button\n          class=\"btn btn-default \"\n          type=\"button\"\n          @click=\"triggerUpload\"\n      >\n        {{ $t('uploader.trigger_upload') }}\n      </button>\n    </div>\n\n    <ul class=\"media-list\">\n      <ViewEntry\n          v-for=\"(token, index) in filteredTokens\"\n          :id=\"`${name}-${index}`\"\n          :key=\"index\"\n          :value=\"token\"\n          :base-url=\"baseUrl\"\n          :editable=\"true\"\n          :editable-filename=\"editableFilename\"\n          @delete=\"delete tokens[index]\"\n          @update-token=\"tokens[index] = $event\"\n      />\n    </ul>\n\n    <input\n        v-for=\"(token, index) in Object.values(cleanedTokens)\"\n        :key=\"`${name}_${index}`\"\n        type=\"hidden\"\n        :name=\"`${name}_${index}`\"\n        :value=\"token\"\n    >\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport {humanizedSize} from './utils';\nimport UploadEntry from './components/UploadEntry.vue';\nimport ViewEntry from './components/ViewEntry.vue';\nimport EventBus from './event-bus';\nimport {defineComponent} from 'vue';\n\nconst EVENT_NAMESPACE = 'osisdocument:';\nconst ADD_EVENT = 'add';\nconst DELETE_EVENT = 'delete';\n\nexport default defineComponent({\n  name: 'DocumentUploader',\n  components: {UploadEntry, ViewEntry},\n  props: {\n    name: {\n      type: String,\n      required: true,\n    },\n    baseUrl: {\n      type: String,\n      required: true,\n    },\n    uploadText: {\n      type: String,\n      default: null,\n    },\n    uploadButtonText: {\n      type: String,\n      default: null,\n    },\n    maxSize: {\n      type: Number,\n      default: 0,\n    },\n    automaticUpload: {\n      type: Boolean,\n      default: true,\n    },\n    editableFilename: {\n      type: Boolean,\n      default: true,\n    },\n    values: {\n      type: Array,\n      default: () => [],\n    },\n    mimetypes: {\n      type: Array,\n      default: () => [],\n    },\n    minFiles: {\n      type: Number,\n      default: 0,\n    },\n    maxFiles: {\n      type: Number,\n      default: 0,\n    },\n  },\n  data() {\n    let indexGenerated = 0;\n    return {\n      isDragging: false,\n      fileList: {} as Record<number, File>,\n      tokens: Object.fromEntries(this.values.map(f => {\n        indexGenerated++;\n        return [indexGenerated, f];\n      })) as Record<number, string | null>,\n      indexGenerated,\n    };\n  },\n  computed: {\n    /** Token list without empty tokens */\n    filteredTokens: function () {\n      return Object.fromEntries(Object.entries(this.tokens).filter(e => !!e[1])) as Record<number, string>;\n    },\n    /** Token list without infected or invalid files */\n    cleanedTokens: function () {\n      return Object.fromEntries(Object.entries(this.tokens).filter(\n          e => !!e[1] && !['FileInfectedException', 'UploadInvalidException'].includes(e[1]),\n      ));\n    },\n    /** Number of file tokens ready to be submitted */\n    nbUploadedFiles: function () {\n      return Object.values(this.cleanedTokens).length;\n    },\n    /**\n     * Customize the drag and drop button label depending on the limits\n     * @returns {string} the drag and drop label\n     */\n    dragNDropLabel: function () {\n      if (this.minFiles) {\n        if (this.minFiles === this.maxFiles) {\n          return this.$tc('uploader.specific_nb_drag_n_drop_label', this.minFiles);\n        } else if (this.maxFiles) {\n          return this.$t('uploader.min_max_drag_n_drop_label', {min: this.minFiles, max: this.maxFiles});\n        } else {\n          return this.$tc('uploader.min_drag_n_drop_label', this.minFiles);\n        }\n      } else if (this.maxFiles) {\n        return this.$tc('uploader.max_drag_n_drop_label', this.maxFiles);\n      }\n      return this.$t('uploader.drag_n_drop_label');\n    },\n  },\n  watch: {\n    cleanedTokens: {\n      handler(newTokens: Record<number, string>, oldTokens: Record<number, string>) {\n        if (JSON.stringify(oldTokens) !== JSON.stringify(newTokens)) {\n          const eventType = Object.keys(oldTokens).length > Object.keys(newTokens).length ? DELETE_EVENT : ADD_EVENT;\n          const fileEvent = new CustomEvent(EVENT_NAMESPACE + eventType, {\n            bubbles: true,\n            detail: {newTokens, oldTokens},\n          });\n          (this.$refs.uploader as HTMLDivElement).dispatchEvent(fileEvent);\n        }\n      },\n    },\n  },\n  mounted() {\n    // Watch for external changes on hidden inputs\n    jQuery('> input', (this.$el as HTMLDivElement)).on('change', (event) => {\n      const $input = jQuery(event.target);\n      if (!$input.val()) {\n        // If an input is emptied, remove all\n        this.tokens = {};\n      }\n    });\n  },\n  methods: {\n    humanizedSize,\n    triggerUpload() {\n      EventBus.emit('upload');\n    },\n    onFilePicked(e: Event) {\n      const files = (e.target as HTMLInputElement).files;\n      files && Array.from(files).forEach(file => {\n        this.indexGenerated++;\n        this.fileList[this.indexGenerated] = file;\n        this.tokens[this.indexGenerated] = null;\n      });\n      this.isDragging = false;\n    },\n  },\n});\n</script>\n\n<style lang=\"scss\">\n.dropzone {\n  border: dashed 2px #8cb0cc;\n  border-radius: 5px * 2;\n  overflow: hidden;\n  transition: all 1s;\n  position: relative;\n  padding: 1em;\n  text-align: center;\n\n  &:after {\n    padding: 1em 3em;\n    display: inline-block;\n    text-align: center;\n  }\n\n  &.filled {\n    border: solid 3px #4cae4c;\n  }\n\n  input {\n    display: none;\n    position: absolute;\n    z-index: 3;\n    padding: 20px 0;\n    opacity: 0;\n    width: 100%;\n    height: 100%;\n    top: 0;\n  }\n\n  &.hovering {\n    border: dotted 3px #4cae4c;\n\n    input {\n      display: block;\n    }\n  }\n}\n</style>\n","<template>\n  <ul class=\"media-list\">\n    <ViewEntry\n        v-for=\"(value, index) in values\"\n        :id=\"index.toString()\"\n        :key=\"index\"\n        :value=\"value\"\n        :base-url=\"baseUrl\"\n        :is-editable=\"false\"\n    />\n  </ul>\n</template>\n\n<script lang=\"ts\">\nimport ViewEntry from './components/ViewEntry.vue';\nimport {defineComponent} from 'vue';\nimport type {PropType} from 'vue';\n\nexport default defineComponent({\n  name: 'DocumentVisualizer',\n  components: {ViewEntry},\n  props: {\n    baseUrl: {\n      type: String,\n      required: true,\n    },\n    values: {\n      type: Array as PropType<string[]>,\n      required: true,\n    },\n  },\n});\n</script>\n","/*\n *\n *   OSIS stands for Open Student Information System. It's an application\n *   designed to manage the core business of higher education institutions,\n *   such as universities, faculties, institutes and professional schools.\n *   The core business involves the administration of students, teachers,\n *   courses, programs and so on.\n *\n *   Copyright (C) 2015-2021 Université catholique de Louvain (http://www.uclouvain.be)\n *\n *   This program is free software: you can redistribute it and/or modify\n *   it under the terms of the GNU General Public License as published by\n *   the Free Software Foundation, either version 3 of the License, or\n *   (at your option) any later version.\n *\n *   This program is distributed in the hope that it will be useful,\n *   but WITHOUT ANY WARRANTY; without even the implied warranty of\n *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *   GNU General Public License for more details.\n *\n *   A copy of this license - GNU General Public License - is available\n *   at the root of the source code of this program.  If not,\n *   see http://www.gnu.org/licenses/.\n *\n */\n// eslint-disable-next-line vue/prefer-import-from-vue\nimport {createApp} from '@vue/runtime-dom'; // So it can be spied on in tests\nimport {i18n} from './i18n';\nimport Uploader from './DocumentUploader.vue';\nimport Visualizer from './DocumentVisualizer.vue';\n\n\ninterface UploaderProps extends Record<string, unknown> {\n  baseUrl: string,\n  maxSize?: number,\n  minFiles?: number,\n  maxFiles?: number,\n  mimetypes?: string[],\n  values?: string[],\n  automaticUpload?: boolean,\n  editableFilename?: boolean,\n}\n\ninterface VisualizerProps extends Record<string, unknown> {\n  baseUrl: string,\n  values: string[],\n}\n\nfunction initDocumentComponents() {\n  document.querySelectorAll<HTMLElement>('.document-uploader:not([data-v-app])').forEach((elem) => {\n    const props: UploaderProps = {baseUrl: \"\", ...elem.dataset};\n    if (typeof elem.dataset.maxSize !== 'undefined') {\n      props.maxSize = Number.parseInt(elem.dataset.maxSize);\n    }\n    if (typeof elem.dataset.minFiles !== 'undefined') {\n      props.minFiles = Number.parseInt(elem.dataset.minFiles);\n    }\n    if (typeof elem.dataset.maxFiles !== 'undefined') {\n      props.maxFiles = Number.parseInt(elem.dataset.maxFiles);\n    }\n    if (typeof elem.dataset.mimetypes !== 'undefined') {\n      props.mimetypes = elem.dataset.mimetypes.split(',');\n    }\n    if (typeof elem.dataset.values !== 'undefined') {\n      props.values = elem.dataset.values.split(',');\n    }\n    if (typeof elem.dataset.automaticUpload !== 'undefined') {\n      props.automaticUpload = elem.dataset.automaticUpload === 'true';\n    }\n    if (typeof elem.dataset.editableFilename !== 'undefined') {\n      props.editableFilename = elem.dataset.editableFilename === 'true';\n    }\n    createApp(Uploader, props).use(i18n).mount(elem);\n  });\n\n  document.querySelectorAll<HTMLElement>('.document-visualizer:not([data-v-app])').forEach((elem) => {\n    const props: VisualizerProps = {baseUrl: \"\", values: [], ...elem.dataset};\n    if (typeof elem.dataset.values !== 'undefined') {\n      props.values = elem.dataset.values.split(',');\n    }\n    createApp(Visualizer, props).use(i18n).mount(elem);\n  });\n}\n\n// Initialize at first load\ninitDocumentComponents();\n\n// Initialize later if nodes are added dynamically\nconst observer = new MutationObserver(initDocumentComponents);\nobserver.observe(document, {childList: true, subtree: true});\n"],"names":["messages","i18n","createI18n","humanizedSize","size","unit","doRequest","url","params","response","E","name","callback","ctx","e","self","listener","data","evtArr","i","len","evts","liveEvents","tinyEmitterModule","TinyEmitter","tinyEmitter","EventBus","_sfc_main$4","defineComponent","token","xhr","detail","fd","_hoisted_2","_hoisted_4","_hoisted_7","_hoisted_10","_createElementVNode","_sfc_render","_ctx","_cache","$props","$setup","$data","$options","_openBlock","_createElementBlock","_hoisted_1","_createCommentVNode","_hoisted_5","_createTextVNode","_toDisplayString","_hoisted_6","_normalizeStyle","_hoisted_8","_hoisted_11","_sfc_main$3","transform","modal","height","img","nextTick","_hoisted_12","_hoisted_15","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_3","$event","_hoisted_9","_hoisted_13","_hoisted_14","_hoisted_17","_hoisted_19","args","_normalizeClass","_hoisted_20","_sfc_main$2","ViewingModal","_a","mimetype","newValue","splitName","_hoisted_16","_hoisted_18","_resolveComponent","_Fragment","_withDirectives","_vModelText","_hoisted_24","_hoisted_27","_hoisted_25","_createBlock","_component_ViewingModal","EVENT_NAMESPACE","ADD_EVENT","DELETE_EVENT","_sfc_main$1","UploadEntry","ViewEntry","indexGenerated","f","newTokens","oldTokens","eventType","fileEvent","event","files","file","_component_ViewEntry","_renderList","index","_component_UploadEntry","_sfc_main","value","initDocumentComponents","elem","props","createApp","Uploader","Visualizer"],"mappings":"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","x_google_ignoreList":[2]}