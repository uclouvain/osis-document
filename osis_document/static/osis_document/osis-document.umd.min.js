(function(c,p){typeof exports=="object"&&typeof module<"u"?p(require("@vue/runtime-dom"),require("vue-i18n"),require("vue")):typeof define=="function"&&define.amd?define(["@vue/runtime-dom","vue-i18n","vue"],p):(c=typeof globalThis<"u"?globalThis:c||self,p(c.Vue,c.VueI18n,c.Vue))})(this,function(c,p,t){"use strict";const E={uploader:{specific_nb_drag_n_drop_label:e=>{const{normalize:n,interpolate:o,named:i,plural:a}=e;return a([n(["Glissez-déposez ici un fichier"]),n(["Glissez-déposez ici ",o(i("count"))," fichiers"])])},min_max_drag_n_drop_label:e=>{const{normalize:n,interpolate:o,named:i}=e;return n(["Glissez-déposez ici entre ",o(i("min"))," et ",o(i("max"))," fichiers"])},min_drag_n_drop_label:e=>{const{normalize:n,interpolate:o,named:i,plural:a}=e;return a([n(["Glissez-déposez ici au-moins un fichier"]),n(["Glissez-déposez ici au-moins ",o(i("count"))," fichiers"])])},max_drag_n_drop_label:e=>{const{normalize:n,interpolate:o,named:i,plural:a}=e;return a([n(["Glissez-déposez ici votre fichier"]),n(["Glissez-déposez ici vos fichiers (maximum ",o(i("count")),")"])])},drag_n_drop_label:e=>{const{normalize:n}=e;return n(["Glissez-déposez ici vos fichiers"])},add_file_label:e=>{const{normalize:n}=e;return n(["ou cliquez-ici"])},max_size_label:e=>{const{normalize:n,interpolate:o,named:i}=e;return n(["(taille maximum ",o(i("size")),")"])},trigger_upload:e=>{const{normalize:n}=e;return n(["Transférer"])}},upload_entry:{completion:e=>{const{normalize:n,interpolate:o,named:i}=e;return n([o(i("progress")),"% transférés"])},too_large:e=>{const{normalize:n}=e;return n(["Le fichier est trop lourd"])},wrong_type:e=>{const{normalize:n,interpolate:o,named:i,plural:a}=e;return a([n(['Le fichier doit être du type "',o(i("types")),'"']),n([`Le fichier doit être d'un des types suivants : "`,o(i("types")),'"'])])}},view_entry:{rotate_left:e=>{const{normalize:n}=e;return n(["Faire pivoter l'image à gauche"])},rotate_right:e=>{const{normalize:n}=e;return n(["Faire pivoter l'image à droite"])},loading:e=>{const{normalize:n}=e;return n(["Chargement..."])},close:e=>{const{normalize:n}=e;return n(["Fermer"])},save:e=>{const{normalize:n}=e;return n(["Enregistrer"])},file_infected:e=>{const{normalize:n}=e;return n(["Le fichier référencé semble infecté par un virus"])}},error:e=>{const{normalize:n,interpolate:o,named:i}=e;return n(["Erreur : ",o(i("error"))])},request_error:e=>{const{normalize:n,interpolate:o,named:i}=e;return n(["Erreur lors de la requête : ",o(i("error"))])},units:[e=>{const{normalize:n}=e;return n(["o"])},e=>{const{normalize:n}=e;return n(["Ko"])},e=>{const{normalize:n}=e;return n(["Mo"])},e=>{const{normalize:n}=e;return n(["Go"])},e=>{const{normalize:n}=e;return n(["To"])}]},N={uploader:{specific_nb_drag_n_drop_label:e=>{const{normalize:n,interpolate:o,named:i,plural:a}=e;return a([n(["Drag and drop one file here"]),n(["Drag and drop ",o(i("count"))," files here"])])},min_max_drag_n_drop_label:e=>{const{normalize:n,interpolate:o,named:i}=e;return n(["Drag and drop between ",o(i("min"))," and ",o(i("max"))," files here"])},min_drag_n_drop_label:e=>{const{normalize:n,interpolate:o,named:i,plural:a}=e;return a([n(["Drag and drop at least one file here"]),n(["Drag and drop at least ",o(i("count"))," files here"])])},max_drag_n_drop_label:e=>{const{normalize:n,interpolate:o,named:i,plural:a}=e;return a([n(["Drag and drop your file here"]),n(["Drag and drop your files here (maximum ",o(i("count")),")"])])},drag_n_drop_label:e=>{const{normalize:n}=e;return n(["Drag and drop your files here"])},add_file_label:e=>{const{normalize:n}=e;return n(["or click here"])},max_size_label:e=>{const{normalize:n,interpolate:o,named:i}=e;return n(["(max size ",o(i("size")),")"])},trigger_upload:e=>{const{normalize:n}=e;return n(["Upload"])}},upload_entry:{completion:e=>{const{normalize:n,interpolate:o,named:i}=e;return n([o(i("progress")),"% uploaded"])},too_large:e=>{const{normalize:n}=e;return n(["File is too large"])},wrong_type:e=>{const{normalize:n,interpolate:o,named:i,plural:a}=e;return a([n(['The file must have the following type: "',o(i("types")),'"']),n(['The file must have one of the following types: "',o(i("types")),'"'])])}},view_entry:{rotate_left:e=>{const{normalize:n}=e;return n(["Rotate image left"])},rotate_right:e=>{const{normalize:n}=e;return n(["Rotate image right"])},loading:e=>{const{normalize:n}=e;return n(["Loading..."])},close:e=>{const{normalize:n}=e;return n(["Close"])},save:e=>{const{normalize:n}=e;return n(["Save"])},file_infected:e=>{const{normalize:n}=e;return n(["The referenced file appears to be infected with a virus"])}},error:e=>{const{normalize:n,interpolate:o,named:i}=e;return n(["Error: ",o(i("error"))])},request_error:e=>{const{normalize:n,interpolate:o,named:i}=e;return n(["Request error: ",o(i("error"))])},units:[e=>{const{normalize:n}=e;return n(["B"])},e=>{const{normalize:n}=e;return n(["KB"])},e=>{const{normalize:n}=e;return n(["MB"])},e=>{const{normalize:n}=e;return n(["GB"])},e=>{const{normalize:n}=e;return n(["TB"])}]},f=p.createI18n({locale:document.documentElement.lang||"en",messages:{en:N,fr:E}});function g(e){let n=0;for(;e>=1024;)e/=1024,++n;const o=f.global.t(`units[${n}]`);return`${e.toFixed(2)} ${o}`}async function _(e,n){const o=await fetch(e,{headers:{"Content-Type":"application/json"},...n});if(o.status>=200&&o.status<300)return o.json();throw new Error(o.statusText)}var y={},V={get exports(){return y},set exports(e){y=e}};function b(){}b.prototype={on:function(e,n,o){var i=this.e||(this.e={});return(i[e]||(i[e]=[])).push({fn:n,ctx:o}),this},once:function(e,n,o){var i=this;function a(){i.off(e,a),n.apply(o,arguments)}return a._=n,this.on(e,a,o)},emit:function(e){var n=[].slice.call(arguments,1),o=((this.e||(this.e={}))[e]||[]).slice(),i=0,a=o.length;for(i;i<a;i++)o[i].fn.apply(o[i].ctx,n);return this},off:function(e,n){var o=this.e||(this.e={}),i=o[e],a=[];if(i&&n)for(var m=0,r=i.length;m<r;m++)i[m].fn!==n&&i[m].fn._!==n&&a.push(i[m]);return a.length?o[e]=a:delete o[e],this}},V.exports=b;var B=y.TinyEmitter=b;const z=new B,S=t.defineComponent({name:"UploadEntry",props:{file:{type:File,required:!0},baseUrl:{type:String,required:!0},maxSize:{type:Number,default:0},mimetypes:{type:Array,default:()=>[]},automatic:{type:Boolean,default:!0}},emits:{setToken(e){return e.length>0},delete(){return!0}},data(){return{progress:0,token:"",error:""}},computed:{isImage:function(){return this.file.type.split("/")[0]==="image"},fileUrl:function(){return URL.createObjectURL(this.file)},humanizedSize:function(){return g(this.file.size)}},mounted(){this.maxSize&&this.file.size>this.maxSize?this.error=this.$t("upload_entry.too_large"):this.mimetypes.length&&!this.mimetypes.includes(this.file.type)?this.error=this.$tc("upload_entry.wrong_type",this.mimetypes.length,{types:this.mimetypes.join(", ")}):this.automatic?this.sendFile():z.on("upload",this.sendFile)},methods:{revokeUrl:function(e){URL.revokeObjectURL(e)},sendFile:function(){const e=new XMLHttpRequest;e.upload.addEventListener("progress",o=>{this.progress=Math.round(o.loaded*100/o.total)},!1),e.open("POST",`${this.baseUrl}request-upload`,!0),e.addEventListener("readystatechange",()=>{if(e.readyState===4&&e.status>=200&&e.status<=300){const o=JSON.parse(e.responseText);this.$emit("setToken",o.token)}else{let o;try{o=JSON.parse(e.responseText).detail}catch{o=e.statusText}this.error=this.$t("request_error",{error:o})}});const n=new FormData;n.append("file",this.file),e.send(n)}}}),u=(e,n)=>{const o=e.__vccOpts||e;for(const[i,a]of n)o[i]=a;return o},w={class:"media"},F={key:0,class:"media-left"},D=["src","alt"],U={class:"media-body"},T={class:"media-heading"},C={class:"text-nowrap"},L={key:0,class:"progress"},q=["aria-valuenow"],j={class:"sr-only"},O={key:1,class:"text-danger"},R={class:"media-right"},H=[t.createElementVNode("span",{class:"fas fa-trash-alt"},null,-1)];function I(e,n,o,i,a,m){return t.openBlock(),t.createElementBlock("li",w,[e.isImage?(t.openBlock(),t.createElementBlock("div",F,[t.createElementVNode("img",{class:"media-object img-thumbnail",src:e.fileUrl,alt:e.file.name,width:"80",onLoad:n[0]||(n[0]=r=>e.revokeUrl(e.fileUrl))},null,40,D)])):t.createCommentVNode("",!0),t.createElementVNode("div",U,[t.createElementVNode("h4",T,[t.createTextVNode(t.toDisplayString(e.file.name)+" ",1),t.createElementVNode("small",null,[t.createElementVNode("span",C,t.toDisplayString(e.humanizedSize),1),t.createTextVNode(" ("+t.toDisplayString(e.file.type)+")",1)])]),e.error?(t.openBlock(),t.createElementBlock("span",O,t.toDisplayString(e.error),1)):(t.openBlock(),t.createElementBlock("div",L,[t.createElementVNode("div",{class:"progress-bar progress-bar-striped active",role:"progressbar","aria-valuenow":e.progress,"aria-valuemin":"0","aria-valuemax":"100",style:t.normalizeStyle({width:`${e.progress}%`})},[t.createElementVNode("span",j,t.toDisplayString(e.$t("upload_entry.completion",{progress:e.progress})),1)],12,q)]))]),t.createElementVNode("div",R,[t.createElementVNode("button",{type:"button",class:"btn btn-danger",onClick:n[1]||(n[1]=r=>e.$emit("delete"))},H)])])}const M=u(S,[["render",I]]),G=t.defineComponent({name:"ViewingModal",props:{baseUrl:{type:String,required:!0},value:{type:String,required:!0},id:{type:String,required:!0},file:{type:Object,required:!0},isEditable:{type:Boolean,default:!0},openOnMount:{type:Boolean,default:!1}},emits:{updateToken(e){return e.length>0}},data:function(){return{rotation:0,originalHeight:null,originalWidth:null,modalHeight:"auto",modalWidth:"auto",error:"",saved:!1}},computed:{isImage:function(){return this.file.mimetype.split("/")[0]==="image"},imageStyle:function(){let e=`rotate(${this.rotation}deg)`;this.isQuarterRotated?e+=` translate(${this.isRotated90CounterClockwise?"-50%":"50%"}, -50%)`:this.isRotated&&(e+=" translate(0, -100%)");const n=this.$refs.modal,o=this.originalHeight&&this.isQuarterRotated&&n.clientWidth<this.originalHeight?`${n.clientWidth-30}px`:"auto";return{transform:e,height:o}},isRotated:function(){return this.rotation%360},isQuarterRotated:function(){return this.rotation%180},isRotated90CounterClockwise:function(){return[-90,270].includes(this.rotation%360)}},watch:{rotation:"changeModalHeight"},mounted(){jQuery(this.$el).on("shown.bs.modal",()=>{this.originalHeight||this.imageLoaded(this.$refs.img),this.changeModalHeight()}),this.openOnMount&&jQuery(this.$el).modal("show")},beforeUnmount(){jQuery(this.$el).modal("hide")},methods:{imageLoaded:async function(e){await t.nextTick(),this.originalHeight=e.clientHeight,this.originalWidth=e.clientWidth,this.changeModalHeight()},changeModalHeight:function(){if(!this.originalWidth||!this.originalHeight)return"auto";const e=this.$refs.modal;this.isQuarterRotated&&e.clientWidth<this.originalHeight?this.modalHeight=`${e.clientWidth*this.originalWidth/this.originalHeight+30}px`:this.modalHeight=`${(this.isQuarterRotated?this.originalWidth:this.originalHeight)+30}px`},saveRotation:async function(){try{const e=await _(`${this.baseUrl}rotate-image/${this.value}`,{method:"POST",body:JSON.stringify({rotate:this.rotation})});this.saved=!0,this.rotation=0,this.$emit("updateToken",e.token),this.error=""}catch(e){this.error=e.message}}}}),A=["id"],W={class:"modal-dialog modal-lg",role:"document"},Q={class:"modal-content"},P={class:"modal-header"},J=["aria-label"],K=[t.createElementVNode("span",{"aria-hidden":"true"},"×",-1)],X={class:"modal-title"},Y=["src","alt"],Z={key:1,class:"embed-responsive embed-responsive-16by9"},v=["data"],x=["src"],ee={class:"modal-footer"},te={class:"row"},ne={key:0,class:"col-sm-10 text-left"},oe=[t.createElementVNode("i",{class:"fas fa-undo"},null,-1)],ie=[t.createElementVNode("i",{class:"fas fa-redo"},null,-1)],ae=["disabled"],re={key:0,class:"text-danger"},se={class:"col-sm-2 pull-right"},le={type:"button",class:"btn btn-default","data-dismiss":"modal"};function de(e,n,o,i,a,m){return t.openBlock(),t.createElementBlock("div",{id:`modal-${e.id}`,class:"modal fade",tabindex:"-1",role:"dialog"},[t.createElementVNode("div",W,[t.createElementVNode("div",Q,[t.createElementVNode("div",P,[t.createElementVNode("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":e.$t("view_entry.close")},K,8,J),t.createElementVNode("h4",X,t.toDisplayString(e.file.name),1)]),t.createElementVNode("div",{ref:"modal",class:"modal-body",style:t.normalizeStyle([{transition:"500ms",overflow:"hidden","max-width":"100%"},{height:e.modalHeight}])},[e.isImage?(t.openBlock(),t.createElementBlock("img",{key:0,ref:"img",src:e.file.url,alt:e.file.name,class:"img-responsive",style:t.normalizeStyle([{transition:"500ms","transform-origin":"top center",margin:"0 auto"},e.imageStyle]),onLoad:n[0]||(n[0]=r=>e.imageLoaded(r.target))},null,44,Y)):(t.openBlock(),t.createElementBlock("div",Z,[t.createElementVNode("object",{data:e.file.url,type:"application/pdf",class:"embed-responsive-item"},[t.createElementVNode("embed",{src:e.file.url,type:"application/pdf"},null,8,x)],8,v)]))],4),t.createElementVNode("div",ee,[t.createElementVNode("div",te,[e.isImage&&e.isEditable?(t.openBlock(),t.createElementBlock("div",ne,[t.createElementVNode("button",{type:"button",class:"btn btn-default",onClick:n[1]||(n[1]=r=>e.rotation-=90)},oe),t.createElementVNode("button",{type:"button",class:"btn btn-default",onClick:n[2]||(n[2]=r=>e.rotation+=90)},ie),t.createElementVNode("button",{type:"button",class:"btn btn-default",disabled:!e.isRotated,onClick:n[3]||(n[3]=(...r)=>e.saveRotation&&e.saveRotation(...r))},[t.createElementVNode("i",{class:t.normalizeClass(`fas fa-${e.saved?"check":"save"}`)},null,2),t.createTextVNode(" "+t.toDisplayString(e.$t("view_entry.save")),1)],8,ae),e.error?(t.openBlock(),t.createElementBlock("span",re,t.toDisplayString(e.$t("error",{error:e.error})),1)):t.createCommentVNode("",!0)])):t.createCommentVNode("",!0),t.createElementVNode("div",se,[t.createElementVNode("button",le,t.toDisplayString(e.$t("view_entry.close")),1)])])])])])],8,A)}const me=u(G,[["render",de]]),ce=t.defineComponent({name:"ViewEntry",components:{ViewingModal:me},props:{value:{type:String,required:!0},id:{type:String,required:!0},baseUrl:{type:String,required:!0},isEditable:{type:Boolean,default:!0},editableFilename:{type:Boolean,default:!0}},emits:{updateToken(e){return e.length>0},delete(){return!0}},data(){return{file:null,loading:!0,error:"",name:"",extension:"",saved:!1}},computed:{isImage:function(){var e;return((e=this.file)==null?void 0:e.mimetype.split("/")[0])==="image"},isViewableDocument:function(){const e=this.file.mimetype;return e.split("/")[0]==="image"||e==="application/pdf"},formattedValue:function(){return this.value.replace(/:/g,"-")},fullName:{get(){return`${this.name}${this.extension}`},set:function(e){const n=/^(.+)(\.[^.]+)$/.exec(e);(n==null?void 0:n.length)===3?(this.name=n[1],this.extension=n[2]):(this.name=e,this.extension="")}}},watch:{value:"getFile"},mounted(){this.getFile()},methods:{humanizedSize:g,getFile:async function(){if(this.value==="FileInfectedException")this.error=this.$t("view_entry.file_infected");else try{this.file=await _(`${this.baseUrl}metadata/${this.value}`),this.fullName=this.file.name}catch(e){this.error=e.message}this.loading=!1},saveName:async function(){try{await _(`${this.baseUrl}change-metadata/${this.value}`,{method:"POST",body:JSON.stringify({name:this.fullName})}),this.saved=!0,this.file.name=this.fullName}catch(e){this.error=e.message}}}}),pe={class:"media"},ue={key:0,class:"media-body"},he={class:"progress"},fe={class:"progress-bar progress-bar-striped active",role:"progressbar","aria-valuenow":"0","aria-valuemin":"0","aria-valuemax":"100",style:{width:"100%"}},ge={class:"sr-only"},_e={class:"media-body"},ye={class:"text-danger"},be={class:"media-right text-right"},ze=[t.createElementVNode("span",{class:"fas fa-trash-alt"},null,-1)],$e={key:0,class:"media-left"},ke=["src","alt"],Ee={class:"media-body"},Ne={class:"media-heading"},Ve={key:0,class:"input-group"},Be={key:0,class:"input-group-addon"},Se={class:"input-group-btn"},we=["disabled"],Fe={key:1},De={class:"text-nowrap"},Ue={class:"btn-group"},Te=["data-target"],Ce=[t.createElementVNode("span",{class:"fas fa-eye"},null,-1)],Le=["href"],qe=[t.createElementVNode("span",{class:"fas fa-download"},null,-1)],je=[t.createElementVNode("span",{class:"fas fa-trash-alt"},null,-1)];function Oe(e,n,o,i,a,m){const r=t.resolveComponent("ViewingModal");return t.openBlock(),t.createElementBlock("li",pe,[e.loading?(t.openBlock(),t.createElementBlock("div",ue,[t.createElementVNode("div",he,[t.createElementVNode("div",fe,[t.createElementVNode("span",ge,t.toDisplayString(e.$t("view_entry.loading")),1)])])])):e.error?(t.openBlock(),t.createElementBlock(t.Fragment,{key:1},[t.createElementVNode("div",_e,[t.createElementVNode("span",ye,t.toDisplayString(e.$t("error",{error:e.error})),1)]),t.createElementVNode("div",be,[e.isEditable?(t.openBlock(),t.createElementBlock("button",{key:0,class:"btn btn-danger",type:"button",onClick:n[0]||(n[0]=d=>e.$emit("delete"))},ze)):t.createCommentVNode("",!0)])],64)):e.file?(t.openBlock(),t.createElementBlock(t.Fragment,{key:2},[e.isImage?(t.openBlock(),t.createElementBlock("div",$e,[t.createElementVNode("img",{class:"media-object img-thumbnail",src:e.file.url,alt:e.file.name,width:"80"},null,8,ke)])):t.createCommentVNode("",!0),t.createElementVNode("div",Ee,[t.createElementVNode("h4",Ne,[e.isEditable&&e.editableFilename?(t.openBlock(),t.createElementBlock("div",Ve,[t.withDirectives(t.createElementVNode("input",{"onUpdate:modelValue":n[1]||(n[1]=d=>e.name=d),type:"text",class:"form-control",onInput:n[2]||(n[2]=d=>e.saved=!1)},null,544),[[t.vModelText,e.name]]),e.extension?(t.openBlock(),t.createElementBlock("span",Be,t.toDisplayString(e.extension),1)):t.createCommentVNode("",!0),t.createElementVNode("span",Se,[t.createElementVNode("button",{type:"button",disabled:e.file.name===e.fullName,class:"btn btn-default",onClick:n[3]||(n[3]=(...d)=>e.saveName&&e.saveName(...d))},[t.createElementVNode("i",{class:t.normalizeClass(`fas fa-${e.saved?"check":"save"}`)},null,2)],8,we)])])):(t.openBlock(),t.createElementBlock("div",Fe,t.toDisplayString(e.file.name),1)),t.createElementVNode("small",null,[t.createElementVNode("span",De,t.toDisplayString(e.humanizedSize(e.file.size)),1),t.createTextVNode(" ("+t.toDisplayString(e.file.mimetype)+")",1)])])]),t.createElementVNode("div",{class:"media-right text-right",style:t.normalizeStyle({"min-width":e.isViewableDocument?"9.5em":"7em"})},[t.createElementVNode("div",Ue,[e.isViewableDocument?(t.openBlock(),t.createElementBlock("a",{key:0,class:"btn btn-default","data-toggle":"modal","data-target":`#modal-${e.formattedValue}`},Ce,8,Te)):t.createCommentVNode("",!0),t.createElementVNode("a",{class:"btn btn-default",target:"_blank",href:`${e.file.url}?dl=1`},qe,8,Le),e.isEditable?(t.openBlock(),t.createElementBlock("button",{key:1,class:"btn btn-danger",type:"button",onClick:n[4]||(n[4]=d=>e.$emit("delete"))},je)):t.createCommentVNode("",!0)])],4),e.isViewableDocument?(t.openBlock(),t.createBlock(r,{key:1,id:e.formattedValue,file:e.file,"is-editable":e.isEditable,value:e.value,"base-url":e.baseUrl,onUpdateToken:n[5]||(n[5]=d=>e.$emit("updateToken",d))},null,8,["id","file","is-editable","value","base-url"])):t.createCommentVNode("",!0)],64)):t.createCommentVNode("",!0)])}const $=u(ce,[["render",Oe]]),Re="osisdocument:",He="add",Ie="delete",Me=t.defineComponent({name:"DocumentUploader",components:{UploadEntry:M,ViewEntry:$},props:{name:{type:String,required:!0},baseUrl:{type:String,required:!0},uploadText:{type:String,default:null},uploadButtonText:{type:String,default:null},maxSize:{type:Number,default:0},automaticUpload:{type:Boolean,default:!0},editableFilename:{type:Boolean,default:!0},values:{type:Array,default:()=>[]},mimetypes:{type:Array,default:()=>[]},minFiles:{type:Number,default:0},maxFiles:{type:Number,default:0}},data(){let e=0;return{isDragging:!1,fileList:{},tokens:Object.fromEntries(this.values.map(n=>(e++,[e,n]))),indexGenerated:e}},computed:{filteredTokens:function(){return Object.fromEntries(Object.entries(this.tokens).filter(e=>!!e[1]))},cleanedTokens:function(){return Object.fromEntries(Object.entries(this.tokens).filter(e=>!!e[1]&&!["FileInfectedException","UploadInvalidException"].includes(e[1])))},nbUploadedFiles:function(){return Object.values(this.cleanedTokens).length},dragNDropLabel:function(){return this.minFiles?this.minFiles===this.maxFiles?this.$tc("uploader.specific_nb_drag_n_drop_label",this.minFiles):this.maxFiles?this.$t("uploader.min_max_drag_n_drop_label",{min:this.minFiles,max:this.maxFiles}):this.$tc("uploader.min_drag_n_drop_label",this.minFiles):this.maxFiles?this.$tc("uploader.max_drag_n_drop_label",this.maxFiles):this.$t("uploader.drag_n_drop_label")}},watch:{cleanedTokens:{handler(e,n){if(JSON.stringify(n)!==JSON.stringify(e)){const o=Object.keys(n).length>Object.keys(e).length?Ie:He,i=new CustomEvent(Re+o,{bubbles:!0,detail:{newTokens:e,oldTokens:n}});this.$el.dispatchEvent(i)}}}},mounted(){jQuery("> input",this.$el).on("change",e=>{jQuery(e.target).val()||(this.tokens={})})},methods:{humanizedSize:g,triggerUpload(){z.emit("upload")},onFilePicked(e){const n=e.target.files;n&&Array.from(n).forEach(o=>{this.indexGenerated++,this.fileList[this.indexGenerated]=o,this.tokens[this.indexGenerated]=null}),this.isDragging=!1}}}),dt="",Ge=["accept"],Ae=t.createElementVNode("span",{class:"glyphicon glyphicon-plus"},null,-1),We={key:0},Qe={key:1,class:"media-list"},Pe={key:2,class:"text-right form-group"},Je={class:"media-list"},Ke=["name","value"];function Xe(e,n,o,i,a,m){const r=t.resolveComponent("UploadEntry"),d=t.resolveComponent("ViewEntry");return t.openBlock(),t.createElementBlock(t.Fragment,null,[e.maxFiles===0||e.nbUploadedFiles<e.maxFiles?(t.openBlock(),t.createElementBlock("div",{key:0,class:t.normalizeClass(["dropzone form-group",{hovering:e.isDragging}]),onDragenter:n[3]||(n[3]=s=>e.isDragging=!0)},[t.createElementVNode("input",{ref:"fileInput",type:"file",multiple:"",accept:e.mimetypes.length?e.mimetypes.join(","):void 0,onDragleave:n[0]||(n[0]=s=>e.isDragging=!1),onChange:n[1]||(n[1]=(...s)=>e.onFilePicked&&e.onFilePicked(...s))},null,40,Ge),t.createTextVNode(" "+t.toDisplayString(e.uploadText||e.dragNDropLabel)+" ",1),t.createElementVNode("button",{class:"btn btn-default",type:"button",onClick:n[2]||(n[2]=s=>e.$refs.fileInput.click())},[Ae,t.createTextVNode(" "+t.toDisplayString(e.uploadButtonText||e.$t("uploader.add_file_label")),1)]),e.maxSize?(t.openBlock(),t.createElementBlock("span",We,t.toDisplayString(e.$t("uploader.max_size_label",{size:e.humanizedSize(e.maxSize)})),1)):t.createCommentVNode("",!0)],34)):t.createCommentVNode("",!0),e.fileList?(t.openBlock(),t.createElementBlock("ul",Qe,[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(e.fileList,(s,l)=>(t.openBlock(),t.createBlock(r,{key:l,file:s,"base-url":e.baseUrl,"max-size":e.maxSize,mimetypes:e.mimetypes,automatic:e.automaticUpload,onDelete:h=>{delete e.fileList[l],delete e.tokens[l]},onSetToken:h=>{e.tokens[l]=h,delete e.fileList[l]}},null,8,["file","base-url","max-size","mimetypes","automatic","onDelete","onSetToken"]))),128))])):t.createCommentVNode("",!0),!e.automaticUpload&&Object.values(e.fileList).length?(t.openBlock(),t.createElementBlock("div",Pe,[t.createElementVNode("button",{class:"btn btn-default",type:"button",onClick:n[4]||(n[4]=(...s)=>e.triggerUpload&&e.triggerUpload(...s))},t.toDisplayString(e.$t("uploader.trigger_upload")),1)])):t.createCommentVNode("",!0),t.createElementVNode("ul",Je,[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(e.filteredTokens,(s,l)=>(t.openBlock(),t.createBlock(d,{id:`${e.name}-${l}`,key:l,value:s,"base-url":e.baseUrl,editable:!0,"editable-filename":e.editableFilename,onDelete:h=>delete e.tokens[l],onUpdateToken:h=>e.tokens[l]=h},null,8,["id","value","base-url","editable-filename","onDelete","onUpdateToken"]))),128))]),(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(Object.values(e.cleanedTokens),(s,l)=>(t.openBlock(),t.createElementBlock("input",{key:`${e.name}_${l}`,type:"hidden",name:`${e.name}_${l}`,value:s},null,8,Ke))),128))],64)}const Ye=u(Me,[["render",Xe]]),Ze=t.defineComponent({name:"DocumentVisualizer",components:{ViewEntry:$},props:{baseUrl:{type:String,required:!0},values:{type:Array,required:!0}}}),ve={class:"media-list"};function xe(e,n,o,i,a,m){const r=t.resolveComponent("ViewEntry");return t.openBlock(),t.createElementBlock("ul",ve,[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(e.values,(d,s)=>(t.openBlock(),t.createBlock(r,{id:s.toString(),key:s,value:d,"base-url":e.baseUrl,"is-editable":!1},null,8,["id","value","base-url"]))),128))])}const et=u(Ze,[["render",xe]]);function k(){document.querySelectorAll(".osis-document-uploader:not([data-v-app])").forEach(e=>{const n={baseUrl:"",...e.dataset};typeof e.dataset.maxSize<"u"&&(n.maxSize=Number.parseInt(e.dataset.maxSize)),typeof e.dataset.minFiles<"u"&&(n.minFiles=Number.parseInt(e.dataset.minFiles)),typeof e.dataset.maxFiles<"u"&&(n.maxFiles=Number.parseInt(e.dataset.maxFiles)),typeof e.dataset.mimetypes<"u"&&(n.mimetypes=e.dataset.mimetypes.split(",")),typeof e.dataset.values<"u"&&(n.values=e.dataset.values.split(",")),typeof e.dataset.automaticUpload<"u"&&(n.automaticUpload=e.dataset.automaticUpload==="true"),typeof e.dataset.editableFilename<"u"&&(n.editableFilename=e.dataset.editableFilename==="true"),c.createApp(Ye,n).use(f).mount(e)}),document.querySelectorAll(".osis-document-visualizer:not([data-v-app])").forEach(e=>{const n={baseUrl:"",values:[],...e.dataset};typeof e.dataset.values<"u"&&(n.values=e.dataset.values.split(",")),c.createApp(et,n).use(f).mount(e)})}k(),new MutationObserver(k).observe(document,{childList:!0,subtree:!0})});
//# sourceMappingURL=osis-document.umd.min.js.map
